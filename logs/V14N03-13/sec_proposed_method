現状の対話システムを感情豊かな自然な会話の流れに対応させるためには，感情状態による発話の制御が必要となる．
人間の感情状態は，対話における相手との発話のやり取りで変化すると考えられる．
感情表出についての研究は，これまでに，コミュニケーションロボット「ifbot」[CITE]や擬人化エージェント[CITE]の研究でも行われてきた．
しかし，これらの研究においては，ロボットや擬人化エージェントが感情を表出することで，ユーザの感情を誘発することを目的としており，ユーザの感情状態を言語から認識することはほとんど考慮されていなかった．
ロボットや擬人化エージェントに応用するための，感情インターフェースにおける感情表出では，相手（ユーザ）の感情状態の認識により自己感情の状態を適切に変化させることが必要となる．
なぜなら，例えば，ユーザが怒っているのに楽しそうに話すロボットは人間らしい振る舞いをしているとはいえないからである．
相手感情を認識できてはじめて，人間らしく自然に自己感情を表出できるであろう．
したがって，感情インターフェースの実現のためには，発話内容，声の抑揚，顔表情などからの話者の感情状態の認識技術が必要不可欠となる．
感情を話者の言葉（発話内容）から認識するためには自然言語文から感情推定を行う必要がある．
自然言語文テキストからの感情の自動抽出や自動判定の研究として以下のようなものがある．
{A【感情語彙や感情表現の自動抽出】}
文に含まれる感情を抽出する研究として，大量のテキストデータからの感情表現や評価表現の自動抽出を目的とする[CITE]や，[CITE]，[CITE], [CITE], [CITE], [CITE], [CITE], [CITE], [CITE]などがある．
[CITE]では，感情表現の基本となる語をシードとして準備しておき，それらの語との係り受け関係から頻出の感情表現パターンを抽出する．
{B【語の好感度を用いた会話文からの感情推定】}
会話文から話者の感情を推定する試みとして，語に好感度（プラスかマイナスの評価）を与え，文毎の事象の望ましさを推定し，話者の感情の推定を行う手法[CITE],[CITE]が提案されている．
{C【ニュース記事の感情判定】}
単語と喜怒哀楽との対応関係を示す感情辞書の構築を行い，Webニュース記事から喜怒哀楽を自動判定する研究として[CITE]がある．
この手法では，読み手側の立場での感情推定を行う．
{D【人手により作成された学習データに基づく感情推定モデルの構築】}
テキスト中に含まれる要素と生起感情との因果関係を付与することで，大量の学習データを作成する試みとして，[CITE]らの研究がある．
この研究では，対話文コーパスに対し，人物の生起感情（感情クラス）以外に，感情生起要因や感情強度などのタグを付与した大規模コーパスを構築し，感情推定への応用を目標としている．
{E【結合価パターンへの感情生起の付与】}
[CITE]らは，文を構成する用言と格要素（名詞＋助詞）の意味的用法を体系化した結合価パターン（文型パターン）に対し，生起する感情の種類と，生起要因，生起主体などを記述した辞書の構築を行っている．
手法A，Cでは，いずれも文中に出現する単語が示す感情的な意味に着目し，文の感情判定や単語の感情極性判定に利用している．
[CITE], [CITE], [CITE]などは，単語にpositive, negativeの二極指標を与えることによって評価表現の判定を行っているが，我々人間は，会話において発話内容から快か不快かの単純な感情のみならず，「喜怒哀楽」に代表されるような複雑な感情を理解することができる．
したがって，より複雑な感情を推定するためには，語の感情的意味の範囲を快/不快からさらに広げて考慮すべきであると考える．
手法Bでは，文末の様相などの情報から，最終的には複数の感情を推定することが可能である．
また，手法Dや手法Eでは，文型や文脈を考慮することにより，多くの複雑な感情を推定することを目標としている．
これらの研究から，会話文には語の感情的意味のみからでは判定できないような文が多く，そのような文に対しては，文全体，複数の文からなるテキストが示す感情的意味からの感情推定手法が必要であることが分かる．
本研究では，感情を表す語や表現を収集・分類し，感情辞書を構築した．
さらに，感情表現の文型パターンを収集し，パターンごとに感情生起のルールを作成することで，話者が生起している感情を推定する手法を提案する．
文中の格要素や述語をfeatureとして機械学習によるポジティブまたはネガティブの推定を行う研究[CITE]，[CITE], [CITE]，[CITE]は多数あるが，文型ごとに感情を対応付けし，ポジティブ・ネガティブ以外の感情（例えば「喜び」や「悲しみ」）を推定する研究は少ない．
文型パターンへの感情生起に関する情報の付与は，[CITE]でも行われているが，情緒生起情報として感情の種類のほかに生起要因などの情報を付与している点や，格要素に当てはまる語に関わらず1つのパターンに対し1種類の感情生起を記述している点で，本研究とは異なる．
また，本手法においては，文型が登録されていない文でも，感情を表す語や表現を登録しておくことによって，「感情表出発話」としての感情推定を行うことができる．
本手法では，単体で感情を表現することが可能な単語を「感情語」と定義する．
また，感情を表現するような慣用句（イディオム）を「感情イディオム」と定義する．
感情語と感情イディオムの例を以下に示す．
感情語（名詞）「楽しさ」，「恐ろしさ」，「憤慨」，「涙雨」
感情語（形容詞）「あくどい」，「痛々しい」，「嬉しい」，「おぞましい」
感情語（副詞）「嫌でも」，「思いの外」，「折悪しく」，「心置きなく」
感情語（動詞）「喜ぶ」，「楽しむ」，「怒る」
感情イディオム「へそを曲げる」，「耳にたこができる」，「心がはずむ」
本研究で提案する感情推定の大まかな流れを図[REF_fig:flow]に示す．
まず，感情推定対象の発話テキスト（1発話ターン）が入力されると，前処理として文末などに含まれる不要な記号を削除し，文毎に分割を行う(Step1)．
この処理は，係り受け解析時に記号類が文末要素として判定されてしまうことを避けるために行う．
また，このとき，記号「？」や「！」は疑問文判定や感嘆文判定に用いるため，モダリティの要素として抽出しておく．
次に，前処理された文を係り受け解析する(Step2)．
係り受け解析には係り受け解析器の「南瓜」(CaboCha)，[CITE]を用いる．
その後，文節ごとに格助詞の検出を行い，文の表層格の決定を行う(Step3)．
このとき，表層格要素はすべて述語（文末要素）に係るものとする．
そして，抽出された格要素，修飾語，述語に感情語辞書を参照して感情属性を付与する(Step4)．
感情語辞書とは，感情語やイディオムを分類し，収録した辞書のことである．
また，感情属性とは主に感情の種類を示す言葉であり，本手法では22種類の基本的な感情属性を定義している（表[REF_tb:ema]参照）．
辞書中には，感情語ごとに感情属性が1つ以上付与されている．
次に，格要素や述語に係っている修飾語により，被修飾要素の感情属性の値の更新を行う(Step5)．
修飾語が感情属性を持たない場合は感情属性の値の更新は行わない．
その後，感情生起事象文型パターンとの照合を行い(Step6)，一致すれば，感情生起事象文とみなされ，感情生起ルールに基づいて感情属性値が与えられる．
モダリティ要素が存在すれば，モダリティによる感情属性更新ルールに基づき，文全体の感情属性値を更新する(Step7)．
最後に，感情パラメータの計算を行い(Step8)，感情推定結果として，複数の感情属性を候補として出力する．
出力された各感情属性は強度を持ち（感情属性の値），大きいほどその感情が強く表れているとする．
1つの発話に感情の種類が1つも付与されなかった場合は，感情推定結果として「無感情」が付与されたとする．
以下，3.1節で「感情語・感情イディオム」について記述する．
また，3.2節で「意味属性イメージ値」，3.3節で「感情生起事象文型パターン」について記述し，3.4節で「感情パラメータ」，3.5節で「修飾語とモダリティによる感情属性値の更新ルール」について記述する．
また，3.6節では，全体の処理の流れを具体例を用いて説明する．
本研究では，単体で感情を表すような単語（感情語）とイディオム（感情イディオム）をまとめた辞書を感情辞書として構築した．
この辞書を参照し，文中に含まれる感情語と感情イディオムに対して感情属性値（各感情属性の有無）を付与する．
感情語とその感情属性値の例を表[REF_tb:eword_ex]に示す．
感情語と感情イディオムに対して付与する感情属性として定義した22種類の感情属性とその定義を，表[REF_tb:ema]に示す．
ここで，この22種類を初期感情属性として定義した過程について述べる．
まず，感情の種類を定義するにあたって，Plutchik [CITE]の定義した基本8感情に，「尊敬」「楽しみ」「不安」「後悔」の4感情と「平静」を加えた13感情を基本13感情として定義した（表[REF_tb:13kind]参照）．
次に，日本語語彙大系の一般名詞属性体系中の感情に関する語彙を調べ，13感情に当てはまらず，新たな感情として定義可能であるものを分類し，抽出していったところ，全部で表[REF_tb:ema]に示す22種類となった．
また，感情語や感情イディオムの中には，この22種類の感情のどれにも当てはまらなかったり，他に適切な感情の種類が考えられる語（例．
語：「やけくそ」→感情：「自暴自棄」）もあり，これらを強制的に22種類中のどれかに分類することは好ましくないと考えたため，付与する際はこの22種類以外の感情属性も許容し，新たな感情属性定義の作成を行うこととした．
新たに追加された感情属性の一部を表[REF_tb:newema]に示す．
これらの感情属性は，ポジティブまたはネガティブに分類できるので，表[REF_tb:emotion_pn]に示すような定義を行った．
感情辞書の構築作業は，抽出対象である日本語語彙大系[CITE]，感情表現辞典[CITE]，分類語彙表[CITE]に含まれる単語（副詞，形容詞，名詞，感動詞，動詞など）と，イディオムから，「単独で感情を表現できる語，イディオムならば抽出」を抽出基準として，作業者1人により抽出した．
さらに，抽出された語とイディオムに対して感情属性（感情の種類）を付与する作業を作業者1人が人手により行った．
例えば，「怒り」を単独で表現可能な語として「憤慨」や「憤激」，イディオムでは「腹を立てる」のような表現を抽出する．
各単語，イディオムに付与する感情属性については作業者自身の判断に任せた．
具体的には，感情語（名詞，動詞）と感情イディオムは，主に日本語語彙大系，感情表現辞典，分類語彙表などの辞書からの抽出を行った．
日本語語彙大系から抽出した名詞は，一般名詞体系の「精神」以下に含まれる単独で感情を表現できる語である．
また，感情表現辞典からは，辞典中で定義されている10種類＋複合感情に分類されている全ての単語，イディオム（感情表現）を抽出した．
分類語彙表からは，【2.3000心】〜【2.3042欲望・期待・失望】に含まれる語から抽出した．
さらに，形容詞と副詞における感情語は，「現代形容詞用法辞典」[CITE]と「現代副詞用法辞典」[CITE]からの抽出を行った．
抽出基準としては，辞典中に感情的な暗示が記されている単語を抽出した．
具体的には，辞典中の解説文と用例を参照しながら，単語1つ1つに対し暗示されている感情などを初期定義の22種類の感情に当てはまるかどうかを判断しながら抽出を行った．
また，22種類の感情には当てはまらないが，その単語が感情を表す言葉であると判定できるものは抽出し，後に新たに感情属性の定義を行うこととした．
品詞ごとの感情語と感情イディオムの総数を表[REF_tb:eword]に示す．
また，1つの語，またはイディオムに複数の感情属性を付与しても良いこととした．
さらに，追加した感情属性については，全ての単語への感情属性付与作業が終了してから見直しを行い，単語への感情属性の追加・修正を行った．
日本語語彙大系における一般名詞に関して，意味属性に対するイメージ値として，正か負の値を付与した．
正，負のどちらのイメージも持たないような意味属性にはイメージ値として0を付与した．
意味属性のイメージ値の例を表[REF_tb:image_sem]に示す．
名詞は属している意味属性のイメージ値を持つことになる．
なお，1つの名詞が複数の意味属性に属する場合，イメージ値は0と判定する．
一般名詞の意味属性の総数は2715あり，そのうち162種類に正のイメージ値，273種類に負のイメージ値を付与した．
この方法によって感情辞書に含まれていない一般名詞に対してのイメージ値の付与を行う．
なお，感情辞書に含まれる一般名詞は，付与されている感情属性の種類（正感情属性または負感情属性）によってイメージ値が決まる．
イメージ値は，感情語や感情イディオムが含まれない場合（含まれている語から感情属性値が得られない場合）に，モダリティとの組み合わせにより感情の種類を判定するために用いる．
具体的には，負のイメージ値を持つ語と不確定（未確認）の様相を持つモダリティが共起している場合，「不安」という感情を生起させ，逆に正のイメージ値を持つ語に不確定の様相を持つモダリティが共起する場合には「期待」という感情を生起させるという処理を行う．
表[REF_tb:imvrule]に，意味属性イメージ値とモダリティの共起ルールを示す．
例えば，文末に「悪者でしょう」という表現が含まれる場合，意味属性「悪者」と不確定様相と判定される「〜でしょう」とが共起していると判定し，（負の意味属性に属する語）+（不確定様相）となり，「不安」を生起する．
本研究では，感情を生起すると考えられる感情動作や感情状態を記述した文を，感情生起事象文と定義する．
感情生起事象文に当てはまる文のパターンに，感情生起主体がどういった感情を生起しているかを付与したものを感情生起事象文型パターン辞書として構築する．
具体的には，感情生起事象文型として，日本語語彙大系[CITE]に収録されている用言意味属性から「感情動作」と「感情状態」に属する用言パターン1615種類（感情状態275，感情動作1340）を基本感情生起事象文型パターンとして抽出し，感情の種類と感情生起条件を付与した．
（各文型パターンには文中の格スロットに入る名詞の意味属性制約が設定されている．
）感情生起条件には，感情生起の主体を定義している．
例えば，「N1-がN2-に怯える」という感情生起事象ならば，事象の主体であるN1が「恐れ」という感情を生起していることを定義する．
また，格スロットに入る単語によって異なる感情が生起するような場合には，単語の意味制約（好感度やイメージ値，感情属性値など）による条件も付加した．
表[REF_tb:patterns]に，感情生起事象文型パターンと，生起感情，その生起主体の例を示す．
文中において感情生起主体が省略されている場合などは，話者を感情生起主体とみなして感情推定を行う．
しかし，話者以外の人物が感情生起主体の場合には，他者の感情生起に対する話者の感情生起を推定する必要がある．
この場合，話者と他者との関係（社会的地位や親密度）などの違いによって生起する感情が異なってくる．
そこで，本手法では，各感情生起事象文型パターン毎に感情生起主体の感情生起条件のみを記述し，入力文中の感情生起主体が話者であると判定したときのみ，感情生起事象として感情生起条件を適用し，話者の感情推定を行う．
入力文が感情生起事象文型パターンに当てはまるかどうかの判定条件として，述語の一致を用いる．
述語が入力文のものと一致する文型パターンを，その文の感情生起事象として採用する．
さらに，述語が一致する文型パターンが複数存在するとき，文中に含まれる単語の意味属性類似度を選択の基準とする．
具体的には，文における単語意味属性類似度の和の平均値が最大値をとる文型パターンを採用することにする．
単語意味属性類似度は各単語の，日本語語彙大系で定義されたシソーラスにおける意味属性により求めることができる．
単語意味属性の類似度を求める式を式[REF_eq:sim]に示す．
[MATH]は文中の格要素の単語の意味属性を表しており，[MATH]は，文型パターン中の格スロットに付与されている意味属性を示す．
式[REF_eq:conc]に，文における単語意味属性類似度の平均値([MATH])を求める式を示す．
式[REF_eq:conc]中の[MATH]は，文型パターン中の格スロット数を表す．
式[REF_eq:conc]中のそれぞれの格要素ごとの類似度[MATH]は，[CITE]らの格フレーム類似度の算出で用いられている方法と同様に，ある単語が複数の意味属性に属する場合には，単語意味属性類似度が最大の意味属性を採用することにする．
また，格スロットに具体的な単語が設定されている場合（「N1-が大志-を抱く」の「大志」など），その単語に一致すれば類似度を1，一致しない場合には類似度を0とする．
以下，述語が一致する場合の文型パターンの照合処理から感情生起条件適用までの流れについて述べる．
入力文中の，モダリティ要素などを取り除いた述語が一致する文型パターンを検索し，該当するものが複数ある場合は，式[REF_eq:conc]により値[MATH]を求め，最大値をとる文型パターンを採用する．
採用した文型パターンに付与されている感情生起条件を適用する．
各格要素の人物判定には話者ごとに自身または他者の呼び名を記述した人物辞書が必要であるが，文中で代名詞を用いている場合には，意味属性が「対称」なら対話相手，「自称」なら話者自身，その他ならば他の人物（あるいは物）であると判定する．
感情生起条件に一致すれば，その感情が感情生起主体に生起していると推定される．
以下，感情生起主体が話者の場合は(4)，それ以外の場合は(5)のように処理される．
感情生起主体が話者であれば，採用された文型パターンに付与されている感情生起条件に基づき，話者の感情を推定する．
このとき，推定された話者の感情は，3.4節で述べる感情パラメータ計算において述語の感情属性値ベクトルとして計算される．
感情生起主体が話者以外であれば話者以外の感情生起とみなし，これを保持し，3.5節で述べるモダリティの感情属性値更新ルール（動作主体が話者以外）に当てはまる場合に，話者の感情が推定される．
また，(4)と同様，推定された感情は述語の感情属性値ベクトルとして計算される．
述語が一致せず，感情生起事象として判定されない場合には感情表出発話文とみなし，次節で述べる感情パラメータを計算することによって話者の感情推定が行われる．
感情表出発話文には感情を表す単語やイディオムが含まれていることが多い．
そこで，本手法では，文に含まれる感情語や感情イディオムからその文における話者の感情表出の程度を計算する．
まず，文に含まれる各感情の強度を示す値として感情属性値を定義する．
また，文から計算される感情の値として感情パラメータを定義する．
感情パラメータとは，文中の格要素に付与された感情属性値を感情の種類ごとに合成したものを指す．
また，感情パラメータは，[MATH]の感情属性値ベクトルで表現する．
感情辞書で照合した語やイディオムに，複数の感情属性が付与されている場合には，その全ての種類が感情パラメータ計算式に代入されることになる．
各感情パラメータは，0か正の値をとる．
式[REF_eq:ea]は，文の感情パラメータ計算式であり，式[REF_eq:ea]における[MATH]は，感情属性値ベクトルを表し，[MATH]は，各格要素ごとの重みを表す．
また，[MATH]は述語の感情属性値ベクトルで，[MATH]は述語への重みを表す．
1発話中の感情パラメータは1文ごとに計算されるが，感情は記憶の一種であり，発話中において記憶と同じように忘却されていくであろうという考えに基づき，エビングハウスの提案した忘却曲線[CITE]の近似式を用いることにより，同一発話テキスト中の前の文から計算されたパラメータとの合成を行う．
感情パラメータ合成の計算式を式[REF_eq:ep]に示す．
式中の[MATH]は，観測中の文から得られた最新の感情属性値ベクトルを表し，[MATH]は，それまでに計算された感情属性値ベクトルを表す．
また，それぞれの感情パラメータを計算する際，感情属性値の値に掛ける重みは，格要素の種類ごとに異なる．
主体・客体に好感度またはイメージ値がある場合にはそれを考慮して重みが決定される．
心理学の分野では，人間はプラスイメージの対象を優先して評価する場合が多いことがS-V-Oポジティビティ[CITE]として知られている．
そこで，正のイメージ値，または感情属性を持つ要素ほど重みを大きくする，格要素ごとの重みを決定するルールを定義する．
表[REF_tb:svoBias]に示すように，主体への重みを[MATH]，客体への重みを[MATH]とし，その値を定義した．
また，述語への重み[MATH]は1.5とする．
本手法では，表層格決定処理時に深層格決定は行わないが，主体，客体は，表層格の種類（ガ／ハ格，ヲ格）と当てはまる語の意味属性（人物，事物）から判定を行う．
感情パラメータ計算により，述語が感情生起事象文型パターンに当てはまらない場合にも，感情語と感情イディオムを含んでいる文（感情表出発話文）からの感情推定を行うことが可能となる．
また，述語が感情生起事象文型パターンに当てはまり，話者の感情が推定されている場合には，その推定感情の種類と値を述語の感情属性値ベクトルとした上で，感情パラメータを計算する．
（この場合，感情属性付与処理において述語単体に付与された感情属性は考慮しない．
）
文中の格要素や述語を修飾する語が存在する場合，それらが被修飾要素の感情属性値の増減や変化に関わることをルールとして定義した（表[REF_tb:shushoku]）．
修飾語，または修飾句のタイプによって，被修飾要素の感情属性への変化の与え方が異なる．
本手法では，「直接修飾型」と「程度変化型」の修飾語を定義する．
修飾語が直接修飾型である場合，被修飾要素の感情属性の有無に関わらず，修飾語の感情属性に書き換えられることとする．
これは，直接修飾型に分類されるような形容詞や副詞などは，感情に大きく影響を与えるものと考えたためである．
例えば，「美しい」などの直接修飾型の形容詞によって「花子」という語が修飾されるとすると，被修飾要素「花子」に付与されている感情属性は打ち消され，修飾要素「美しい」の持つ感情属性「賞賛」に書き換えられることになる．
一方，被修飾要素の感情属性値の大きさに変化を与えるのが程度変化型の修飾語である．
表[REF_tb:shushoku]に示すように，程度の違いによって「強め」，「弱め」に分類した．
このタイプに分類される修飾語は主に副詞である．
これらの修飾語のタイプの判定のために，感情辞書とは別に，形容詞と副詞を上記の2タイプに分類した修飾語辞書を準備した．
この辞書には程度の値なども記述している．
また，修飾語には，上で述べた2つのタイプのものと，文のモダリティの変化に影響するものがある．
例として，「おそらく，雨が降るだろう」のように，「おそらく」という副詞には「未来」や「予測」という暗示があり，文末の「だろう」という予測の意味を持つ表現を伴うことが多い．
よって，副詞には文末の様相と同様のはたらきを持つものも存在するので，修飾語辞書にモダリティとしての属性（モダリティの種類）の登録も行っておく．
また，モダリティを文全体の感情属性値に影響させるルールを定義した．
基本ルールとして，不確定様相や過去様相なら，感情属性値を減少させる．
モダリティの種類ごとに不確定の度合い（やや弱い不確定=0.2，不確定=0.4，やや強い不確定=0.6）を不確定の程度値として定義する．
具体的には，文の感情属性値ベクトルに[MATH]を掛ける処理を行う．
この1.0という値は基準値であり，確定している事象であれば不確定の程度値が0.0ということであるから，文の感情属性値ベクトルは減少しないことになる．
一方，不確定の程度が高くなるほど文の感情属性値ベクトルが減少する．
不確定様相とは，述べられている事象がまだ未実施である場合や，未確認であるような場合に用いる表現を指す．
一方，過去様相（確認様相）は既に過去に確認済みの事象の場合に用いる表現を指す．
他に，モダリティの種類（「許可」，「禁止」，「依頼」など）ごとに，表[REF_tb:modality]に示すような感情属性値更新ルールを定義した．
表[REF_tb:modality]中の[MATH]は，動作主体を表す．
本研究では，モダリティの持つ属性として「確認／未確認(Asc)」，「時制(Time)」，「態度(Asp)」を定義する．
表[REF_tb:modality]中の[MATH]は，述語の感情属性が正感情属性か負感情属性かを判定する関数である．
式[REF_eq:emfunc]に関数の定義を示す．
[MATH]は符号関数を表す．
また，[MATH]は，述語動詞(V)の感情属性値を表し，関数[MATH]は感情属性ごとの正負を判定するものである．
ここで，(a)「私が優しい花子の言葉に感謝するだろう．
」という文（発話テキスト）から感情推定する例を各ステップごとに示しながら処理の流れを説明する．
\StepLabel{〈Step1〉}まず，入力された発話テキスト(a)を「．
」や「！」などの句点に基づき，文毎に分割を行う．
(a)は1文のみで構成される発話テキストなので，分割処理は行われない．
また，(a)には「？」（疑問符）や「！」（感嘆符）のような記号や，その他の記号は含まれないと判定される．
\StepLabel{〈Step2〉}次に，南瓜による係り受け解析を行う．
具体的には，〈Step1〉で分割された一文ごとに解析を行う．
\StepLabel{〈Step3〉}係り受け解析された結果に基づいて，表層格決定処理が行われる．
(a)では，ガ格は「私」，ニ格は「言葉」，述語は「感謝する」と決定される．
また，ニ格に係る修飾句として「優しい花子の」が抽出される．
ここで，述語に付属している文末表現は，モダリティ要素として抽出しておく．
\StepLabel{〈Step4〉}次は，文中の語と感情辞書との照合を行う．
具体的には，格要素ごとに感情属性が含まれるかどうかを判定する．
ここで，図[REF_fig:step5]に示すように，感情語として登録されている「優しい」に感情属性「賞賛」が付与される．
係り受け関係から，ニ格への修飾句「優しい花子」となり，これが感情属性「賞賛」を持つことになる．
また，修飾型は「優しい」のものをそのまま継承して「直接修飾型」となる．
\StepLabel{〈Step5〉}ここで，修飾語による感情属性値の更新ルールが適用される．
(a)の場合，修飾句「優しい花子」が「言葉」に係り，ニ格の感情属性値は上書きされ，「賞賛=1.0」となる．
\StepLabel{〈Step6〉}次に，文型パターンの照合処理が行われるが，(a)の場合，文型パターン「N1-がN2-に感謝する」に一致し，生起主体=「私」であり，(a)から推定される感情は話者の生起感情となる．
そして，文型パターンに付与されているルールに基づき，述語感情属性として「感謝=1.0」が付与される．
\StepLabel{〈Step7〉}文中にモダリティがあるかどうかの判定が行われる．
(a)に含まれる推定のモダリティ「だろう」により，文感情属性値の更新が行われる．
この「だろう」の不確定の度合いが「やや弱い不確定」であれば，不確定値は0.2となり，文感情属性値ベクトルに[MATH]を掛け合わせることで，結果として，｛[MATH]｝という感情属性値が得られる．
\StepLabel{〈Step8〉}最後に感情パラメータの計算が行われるが，発話テキスト中の文が1文のみなので，式[REF_eq:ea]により，
[MATH]
という計算が行われ，話者の生起感情として，｛感謝=1.2,賞賛=0.56｝という結果が出力される．
現状の対話システムを感情豊かな自然な会話の流れに対応させるためには，感情状態による発話の制御が必要となる．
人間の感情状態は，対話における相手との発話のやり取りで変化すると考えられる．
感情表出についての研究は，これまでに，コミュニケーションロボット「ifbot」[CITE]や擬人化エージェント[CITE]の研究でも行われてきた．
しかし，これらの研究においては，ロボットや擬人化エージェントが感情を表出することで，ユーザの感情を誘発することを目的としており，ユーザの感情状態を言語から認識することはほとんど考慮されていなかった．
ロボットや擬人化エージェントに応用するための，感情インターフェースにおける感情表出では，相手（ユーザ）の感情状態の認識により自己感情の状態を適切に変化させることが必要となる．
なぜなら，例えば，ユーザが怒っているのに楽しそうに話すロボットは人間らしい振る舞いをしているとはいえないからである．
相手感情を認識できてはじめて，人間らしく自然に自己感情を表出できるであろう．
したがって，感情インターフェースの実現のためには，発話内容，声の抑揚，顔表情などからの話者の感情状態の認識技術が必要不可欠となる．
感情を話者の言葉（発話内容）から認識するためには自然言語文から感情推定を行う必要がある．
自然言語文テキストからの感情の自動抽出や自動判定の研究として以下のようなものがある．
{A【感情語彙や感情表現の自動抽出】}
文に含まれる感情を抽出する研究として，大量のテキストデータからの感情表現や評価表現の自動抽出を目的とする[CITE]や，[CITE]，[CITE], [CITE], [CITE], [CITE], [CITE], [CITE], [CITE]などがある．
[CITE]では，感情表現の基本となる語をシードとして準備しておき，それらの語との係り受け関係から頻出の感情表現パターンを抽出する．
{B【語の好感度を用いた会話文からの感情推定】}
会話文から話者の感情を推定する試みとして，語に好感度（プラスかマイナスの評価）を与え，文毎の事象の望ましさを推定し，話者の感情の推定を行う手法[CITE],[CITE]が提案されている．
{C【ニュース記事の感情判定】}
単語と喜怒哀楽との対応関係を示す感情辞書の構築を行い，Webニュース記事から喜怒哀楽を自動判定する研究として[CITE]がある．
この手法では，読み手側の立場での感情推定を行う．
{D【人手により作成された学習データに基づく感情推定モデルの構築】}
テキスト中に含まれる要素と生起感情との因果関係を付与することで，大量の学習データを作成する試みとして，[CITE]らの研究がある．
この研究では，対話文コーパスに対し，人物の生起感情（感情クラス）以外に，感情生起要因や感情強度などのタグを付与した大規模コーパスを構築し，感情推定への応用を目標としている．
{E【結合価パターンへの感情生起の付与】}
[CITE]らは，文を構成する用言と格要素（名詞＋助詞）の意味的用法を体系化した結合価パターン（文型パターン）に対し，生起する感情の種類と，生起要因，生起主体などを記述した辞書の構築を行っている．
手法A，Cでは，いずれも文中に出現する単語が示す感情的な意味に着目し，文の感情判定や単語の感情極性判定に利用している．
[CITE], [CITE], [CITE]などは，単語にpositive, negativeの二極指標を与えることによって評価表現の判定を行っているが，我々人間は，会話において発話内容から快か不快かの単純な感情のみならず，「喜怒哀楽」に代表されるような複雑な感情を理解することができる．
したがって，より複雑な感情を推定するためには，語の感情的意味の範囲を快/不快からさらに広げて考慮すべきであると考える．
手法Bでは，文末の様相などの情報から，最終的には複数の感情を推定することが可能である．
また，手法Dや手法Eでは，文型や文脈を考慮することにより，多くの複雑な感情を推定することを目標としている．
これらの研究から，会話文には語の感情的意味のみからでは判定できないような文が多く，そのような文に対しては，文全体，複数の文からなるテキストが示す感情的意味からの感情推定手法が必要であることが分かる．
本研究では，感情を表す語や表現を収集・分類し，感情辞書を構築した．
さらに，感情表現の文型パターンを収集し，パターンごとに感情生起のルールを作成することで，話者が生起している感情を推定する手法を提案する．
文中の格要素や述語をfeatureとして機械学習によるポジティブまたはネガティブの推定を行う研究[CITE]，[CITE], [CITE]，[CITE]は多数あるが，文型ごとに感情を対応付けし，ポジティブ・ネガティブ以外の感情（例えば「喜び」や「悲しみ」）を推定する研究は少ない．
文型パターンへの感情生起に関する情報の付与は，[CITE]でも行われているが，情緒生起情報として感情の種類のほかに生起要因などの情報を付与している点や，格要素に当てはまる語に関わらず1つのパターンに対し1種類の感情生起を記述している点で，本研究とは異なる．
また，本手法においては，文型が登録されていない文でも，感情を表す語や表現を登録しておくことによって，「感情表出発話」としての感情推定を行うことができる．
本手法では，単体で感情を表現することが可能な単語を「感情語」と定義する．
また，感情を表現するような慣用句（イディオム）を「感情イディオム」と定義する．
感情語と感情イディオムの例を以下に示す．
感情語（名詞）「楽しさ」，「恐ろしさ」，「憤慨」，「涙雨」
感情語（形容詞）「あくどい」，「痛々しい」，「嬉しい」，「おぞましい」
感情語（副詞）「嫌でも」，「思いの外」，「折悪しく」，「心置きなく」
感情語（動詞）「喜ぶ」，「楽しむ」，「怒る」
感情イディオム「へそを曲げる」，「耳にたこができる」，「心がはずむ」
本研究で提案する感情推定の大まかな流れを図[REF_fig:flow]に示す．
まず，感情推定対象の発話テキスト（1発話ターン）が入力されると，前処理として文末などに含まれる不要な記号を削除し，文毎に分割を行う(Step1)．
この処理は，係り受け解析時に記号類が文末要素として判定されてしまうことを避けるために行う．
また，このとき，記号「？」や「！」は疑問文判定や感嘆文判定に用いるため，モダリティの要素として抽出しておく．
次に，前処理された文を係り受け解析する(Step2)．
係り受け解析には係り受け解析器の「南瓜」(CaboCha)，[CITE]を用いる．
その後，文節ごとに格助詞の検出を行い，文の表層格の決定を行う(Step3)．
このとき，表層格要素はすべて述語（文末要素）に係るものとする．
そして，抽出された格要素，修飾語，述語に感情語辞書を参照して感情属性を付与する(Step4)．
感情語辞書とは，感情語やイディオムを分類し，収録した辞書のことである．
また，感情属性とは主に感情の種類を示す言葉であり，本手法では22種類の基本的な感情属性を定義している（表[REF_tb:ema]参照）．
辞書中には，感情語ごとに感情属性が1つ以上付与されている．
次に，格要素や述語に係っている修飾語により，被修飾要素の感情属性の値の更新を行う(Step5)．
修飾語が感情属性を持たない場合は感情属性の値の更新は行わない．
その後，感情生起事象文型パターンとの照合を行い(Step6)，一致すれば，感情生起事象文とみなされ，感情生起ルールに基づいて感情属性値が与えられる．
モダリティ要素が存在すれば，モダリティによる感情属性更新ルールに基づき，文全体の感情属性値を更新する(Step7)．
最後に，感情パラメータの計算を行い(Step8)，感情推定結果として，複数の感情属性を候補として出力する．
出力された各感情属性は強度を持ち（感情属性の値），大きいほどその感情が強く表れているとする．
1つの発話に感情の種類が1つも付与されなかった場合は，感情推定結果として「無感情」が付与されたとする．
以下，3.1節で「感情語・感情イディオム」について記述する．
また，3.2節で「意味属性イメージ値」，3.3節で「感情生起事象文型パターン」について記述し，3.4節で「感情パラメータ」，3.5節で「修飾語とモダリティによる感情属性値の更新ルール」について記述する．
また，3.6節では，全体の処理の流れを具体例を用いて説明する．
本研究では，単体で感情を表すような単語（感情語）とイディオム（感情イディオム）をまとめた辞書を感情辞書として構築した．
この辞書を参照し，文中に含まれる感情語と感情イディオムに対して感情属性値（各感情属性の有無）を付与する．
感情語とその感情属性値の例を表[REF_tb:eword_ex]に示す．
感情語と感情イディオムに対して付与する感情属性として定義した22種類の感情属性とその定義を，表[REF_tb:ema]に示す．
ここで，この22種類を初期感情属性として定義した過程について述べる．
まず，感情の種類を定義するにあたって，Plutchik [CITE]の定義した基本8感情に，「尊敬」「楽しみ」「不安」「後悔」の4感情と「平静」を加えた13感情を基本13感情として定義した（表[REF_tb:13kind]参照）．
次に，日本語語彙大系の一般名詞属性体系中の感情に関する語彙を調べ，13感情に当てはまらず，新たな感情として定義可能であるものを分類し，抽出していったところ，全部で表[REF_tb:ema]に示す22種類となった．
また，感情語や感情イディオムの中には，この22種類の感情のどれにも当てはまらなかったり，他に適切な感情の種類が考えられる語（例．
語：「やけくそ」→感情：「自暴自棄」）もあり，これらを強制的に22種類中のどれかに分類することは好ましくないと考えたため，付与する際はこの22種類以外の感情属性も許容し，新たな感情属性定義の作成を行うこととした．
新たに追加された感情属性の一部を表[REF_tb:newema]に示す．
これらの感情属性は，ポジティブまたはネガティブに分類できるので，表[REF_tb:emotion_pn]に示すような定義を行った．
感情辞書の構築作業は，抽出対象である日本語語彙大系[CITE]，感情表現辞典[CITE]，分類語彙表[CITE]に含まれる単語（副詞，形容詞，名詞，感動詞，動詞など）と，イディオムから，「単独で感情を表現できる語，イディオムならば抽出」を抽出基準として，作業者1人により抽出した．
さらに，抽出された語とイディオムに対して感情属性（感情の種類）を付与する作業を作業者1人が人手により行った．
例えば，「怒り」を単独で表現可能な語として「憤慨」や「憤激」，イディオムでは「腹を立てる」のような表現を抽出する．
各単語，イディオムに付与する感情属性については作業者自身の判断に任せた．
具体的には，感情語（名詞，動詞）と感情イディオムは，主に日本語語彙大系，感情表現辞典，分類語彙表などの辞書からの抽出を行った．
日本語語彙大系から抽出した名詞は，一般名詞体系の「精神」以下に含まれる単独で感情を表現できる語である．
また，感情表現辞典からは，辞典中で定義されている10種類＋複合感情に分類されている全ての単語，イディオム（感情表現）を抽出した．
分類語彙表からは，【2.3000心】〜【2.3042欲望・期待・失望】に含まれる語から抽出した．
さらに，形容詞と副詞における感情語は，「現代形容詞用法辞典」[CITE]と「現代副詞用法辞典」[CITE]からの抽出を行った．
抽出基準としては，辞典中に感情的な暗示が記されている単語を抽出した．
具体的には，辞典中の解説文と用例を参照しながら，単語1つ1つに対し暗示されている感情などを初期定義の22種類の感情に当てはまるかどうかを判断しながら抽出を行った．
また，22種類の感情には当てはまらないが，その単語が感情を表す言葉であると判定できるものは抽出し，後に新たに感情属性の定義を行うこととした．
品詞ごとの感情語と感情イディオムの総数を表[REF_tb:eword]に示す．
また，1つの語，またはイディオムに複数の感情属性を付与しても良いこととした．
さらに，追加した感情属性については，全ての単語への感情属性付与作業が終了してから見直しを行い，単語への感情属性の追加・修正を行った．
日本語語彙大系における一般名詞に関して，意味属性に対するイメージ値として，正か負の値を付与した．
正，負のどちらのイメージも持たないような意味属性にはイメージ値として0を付与した．
意味属性のイメージ値の例を表[REF_tb:image_sem]に示す．
名詞は属している意味属性のイメージ値を持つことになる．
なお，1つの名詞が複数の意味属性に属する場合，イメージ値は0と判定する．
一般名詞の意味属性の総数は2715あり，そのうち162種類に正のイメージ値，273種類に負のイメージ値を付与した．
この方法によって感情辞書に含まれていない一般名詞に対してのイメージ値の付与を行う．
なお，感情辞書に含まれる一般名詞は，付与されている感情属性の種類（正感情属性または負感情属性）によってイメージ値が決まる．
イメージ値は，感情語や感情イディオムが含まれない場合（含まれている語から感情属性値が得られない場合）に，モダリティとの組み合わせにより感情の種類を判定するために用いる．
具体的には，負のイメージ値を持つ語と不確定（未確認）の様相を持つモダリティが共起している場合，「不安」という感情を生起させ，逆に正のイメージ値を持つ語に不確定の様相を持つモダリティが共起する場合には「期待」という感情を生起させるという処理を行う．
表[REF_tb:imvrule]に，意味属性イメージ値とモダリティの共起ルールを示す．
例えば，文末に「悪者でしょう」という表現が含まれる場合，意味属性「悪者」と不確定様相と判定される「〜でしょう」とが共起していると判定し，（負の意味属性に属する語）+（不確定様相）となり，「不安」を生起する．
本研究では，感情を生起すると考えられる感情動作や感情状態を記述した文を，感情生起事象文と定義する．
感情生起事象文に当てはまる文のパターンに，感情生起主体がどういった感情を生起しているかを付与したものを感情生起事象文型パターン辞書として構築する．
具体的には，感情生起事象文型として，日本語語彙大系[CITE]に収録されている用言意味属性から「感情動作」と「感情状態」に属する用言パターン1615種類（感情状態275，感情動作1340）を基本感情生起事象文型パターンとして抽出し，感情の種類と感情生起条件を付与した．
（各文型パターンには文中の格スロットに入る名詞の意味属性制約が設定されている．
）感情生起条件には，感情生起の主体を定義している．
例えば，「N1-がN2-に怯える」という感情生起事象ならば，事象の主体であるN1が「恐れ」という感情を生起していることを定義する．
また，格スロットに入る単語によって異なる感情が生起するような場合には，単語の意味制約（好感度やイメージ値，感情属性値など）による条件も付加した．
表[REF_tb:patterns]に，感情生起事象文型パターンと，生起感情，その生起主体の例を示す．
文中において感情生起主体が省略されている場合などは，話者を感情生起主体とみなして感情推定を行う．
しかし，話者以外の人物が感情生起主体の場合には，他者の感情生起に対する話者の感情生起を推定する必要がある．
この場合，話者と他者との関係（社会的地位や親密度）などの違いによって生起する感情が異なってくる．
そこで，本手法では，各感情生起事象文型パターン毎に感情生起主体の感情生起条件のみを記述し，入力文中の感情生起主体が話者であると判定したときのみ，感情生起事象として感情生起条件を適用し，話者の感情推定を行う．
入力文が感情生起事象文型パターンに当てはまるかどうかの判定条件として，述語の一致を用いる．
述語が入力文のものと一致する文型パターンを，その文の感情生起事象として採用する．
さらに，述語が一致する文型パターンが複数存在するとき，文中に含まれる単語の意味属性類似度を選択の基準とする．
具体的には，文における単語意味属性類似度の和の平均値が最大値をとる文型パターンを採用することにする．
単語意味属性類似度は各単語の，日本語語彙大系で定義されたシソーラスにおける意味属性により求めることができる．
単語意味属性の類似度を求める式を式[REF_eq:sim]に示す．
[MATH]は文中の格要素の単語の意味属性を表しており，[MATH]は，文型パターン中の格スロットに付与されている意味属性を示す．
式[REF_eq:conc]に，文における単語意味属性類似度の平均値([MATH])を求める式を示す．
式[REF_eq:conc]中の[MATH]は，文型パターン中の格スロット数を表す．
式[REF_eq:conc]中のそれぞれの格要素ごとの類似度[MATH]は，[CITE]らの格フレーム類似度の算出で用いられている方法と同様に，ある単語が複数の意味属性に属する場合には，単語意味属性類似度が最大の意味属性を採用することにする．
また，格スロットに具体的な単語が設定されている場合（「N1-が大志-を抱く」の「大志」など），その単語に一致すれば類似度を1，一致しない場合には類似度を0とする．
以下，述語が一致する場合の文型パターンの照合処理から感情生起条件適用までの流れについて述べる．
入力文中の，モダリティ要素などを取り除いた述語が一致する文型パターンを検索し，該当するものが複数ある場合は，式[REF_eq:conc]により値[MATH]を求め，最大値をとる文型パターンを採用する．
採用した文型パターンに付与されている感情生起条件を適用する．
各格要素の人物判定には話者ごとに自身または他者の呼び名を記述した人物辞書が必要であるが，文中で代名詞を用いている場合には，意味属性が「対称」なら対話相手，「自称」なら話者自身，その他ならば他の人物（あるいは物）であると判定する．
感情生起条件に一致すれば，その感情が感情生起主体に生起していると推定される．
以下，感情生起主体が話者の場合は(4)，それ以外の場合は(5)のように処理される．
感情生起主体が話者であれば，採用された文型パターンに付与されている感情生起条件に基づき，話者の感情を推定する．
このとき，推定された話者の感情は，3.4節で述べる感情パラメータ計算において述語の感情属性値ベクトルとして計算される．
感情生起主体が話者以外であれば話者以外の感情生起とみなし，これを保持し，3.5節で述べるモダリティの感情属性値更新ルール（動作主体が話者以外）に当てはまる場合に，話者の感情が推定される．
また，(4)と同様，推定された感情は述語の感情属性値ベクトルとして計算される．
述語が一致せず，感情生起事象として判定されない場合には感情表出発話文とみなし，次節で述べる感情パラメータを計算することによって話者の感情推定が行われる．
感情表出発話文には感情を表す単語やイディオムが含まれていることが多い．
そこで，本手法では，文に含まれる感情語や感情イディオムからその文における話者の感情表出の程度を計算する．
まず，文に含まれる各感情の強度を示す値として感情属性値を定義する．
また，文から計算される感情の値として感情パラメータを定義する．
感情パラメータとは，文中の格要素に付与された感情属性値を感情の種類ごとに合成したものを指す．
また，感情パラメータは，[MATH]の感情属性値ベクトルで表現する．
感情辞書で照合した語やイディオムに，複数の感情属性が付与されている場合には，その全ての種類が感情パラメータ計算式に代入されることになる．
各感情パラメータは，0か正の値をとる．
式[REF_eq:ea]は，文の感情パラメータ計算式であり，式[REF_eq:ea]における[MATH]は，感情属性値ベクトルを表し，[MATH]は，各格要素ごとの重みを表す．
また，[MATH]は述語の感情属性値ベクトルで，[MATH]は述語への重みを表す．
1発話中の感情パラメータは1文ごとに計算されるが，感情は記憶の一種であり，発話中において記憶と同じように忘却されていくであろうという考えに基づき，エビングハウスの提案した忘却曲線[CITE]の近似式を用いることにより，同一発話テキスト中の前の文から計算されたパラメータとの合成を行う．
感情パラメータ合成の計算式を式[REF_eq:ep]に示す．
式中の[MATH]は，観測中の文から得られた最新の感情属性値ベクトルを表し，[MATH]は，それまでに計算された感情属性値ベクトルを表す．
また，それぞれの感情パラメータを計算する際，感情属性値の値に掛ける重みは，格要素の種類ごとに異なる．
主体・客体に好感度またはイメージ値がある場合にはそれを考慮して重みが決定される．
心理学の分野では，人間はプラスイメージの対象を優先して評価する場合が多いことがS-V-Oポジティビティ[CITE]として知られている．
そこで，正のイメージ値，または感情属性を持つ要素ほど重みを大きくする，格要素ごとの重みを決定するルールを定義する．
表[REF_tb:svoBias]に示すように，主体への重みを[MATH]，客体への重みを[MATH]とし，その値を定義した．
また，述語への重み[MATH]は1.5とする．
本手法では，表層格決定処理時に深層格決定は行わないが，主体，客体は，表層格の種類（ガ／ハ格，ヲ格）と当てはまる語の意味属性（人物，事物）から判定を行う．
感情パラメータ計算により，述語が感情生起事象文型パターンに当てはまらない場合にも，感情語と感情イディオムを含んでいる文（感情表出発話文）からの感情推定を行うことが可能となる．
また，述語が感情生起事象文型パターンに当てはまり，話者の感情が推定されている場合には，その推定感情の種類と値を述語の感情属性値ベクトルとした上で，感情パラメータを計算する．
（この場合，感情属性付与処理において述語単体に付与された感情属性は考慮しない．
）
文中の格要素や述語を修飾する語が存在する場合，それらが被修飾要素の感情属性値の増減や変化に関わることをルールとして定義した（表[REF_tb:shushoku]）．
修飾語，または修飾句のタイプによって，被修飾要素の感情属性への変化の与え方が異なる．
本手法では，「直接修飾型」と「程度変化型」の修飾語を定義する．
修飾語が直接修飾型である場合，被修飾要素の感情属性の有無に関わらず，修飾語の感情属性に書き換えられることとする．
これは，直接修飾型に分類されるような形容詞や副詞などは，感情に大きく影響を与えるものと考えたためである．
例えば，「美しい」などの直接修飾型の形容詞によって「花子」という語が修飾されるとすると，被修飾要素「花子」に付与されている感情属性は打ち消され，修飾要素「美しい」の持つ感情属性「賞賛」に書き換えられることになる．
一方，被修飾要素の感情属性値の大きさに変化を与えるのが程度変化型の修飾語である．
表[REF_tb:shushoku]に示すように，程度の違いによって「強め」，「弱め」に分類した．
このタイプに分類される修飾語は主に副詞である．
これらの修飾語のタイプの判定のために，感情辞書とは別に，形容詞と副詞を上記の2タイプに分類した修飾語辞書を準備した．
この辞書には程度の値なども記述している．
また，修飾語には，上で述べた2つのタイプのものと，文のモダリティの変化に影響するものがある．
例として，「おそらく，雨が降るだろう」のように，「おそらく」という副詞には「未来」や「予測」という暗示があり，文末の「だろう」という予測の意味を持つ表現を伴うことが多い．
よって，副詞には文末の様相と同様のはたらきを持つものも存在するので，修飾語辞書にモダリティとしての属性（モダリティの種類）の登録も行っておく．
また，モダリティを文全体の感情属性値に影響させるルールを定義した．
基本ルールとして，不確定様相や過去様相なら，感情属性値を減少させる．
モダリティの種類ごとに不確定の度合い（やや弱い不確定=0.2，不確定=0.4，やや強い不確定=0.6）を不確定の程度値として定義する．
具体的には，文の感情属性値ベクトルに[MATH]を掛ける処理を行う．
この1.0という値は基準値であり，確定している事象であれば不確定の程度値が0.0ということであるから，文の感情属性値ベクトルは減少しないことになる．
一方，不確定の程度が高くなるほど文の感情属性値ベクトルが減少する．
不確定様相とは，述べられている事象がまだ未実施である場合や，未確認であるような場合に用いる表現を指す．
一方，過去様相（確認様相）は既に過去に確認済みの事象の場合に用いる表現を指す．
他に，モダリティの種類（「許可」，「禁止」，「依頼」など）ごとに，表[REF_tb:modality]に示すような感情属性値更新ルールを定義した．
表[REF_tb:modality]中の[MATH]は，動作主体を表す．
本研究では，モダリティの持つ属性として「確認／未確認(Asc)」，「時制(Time)」，「態度(Asp)」を定義する．
表[REF_tb:modality]中の[MATH]は，述語の感情属性が正感情属性か負感情属性かを判定する関数である．
式[REF_eq:emfunc]に関数の定義を示す．
[MATH]は符号関数を表す．
また，[MATH]は，述語動詞(V)の感情属性値を表し，関数[MATH]は感情属性ごとの正負を判定するものである．
ここで，(a)「私が優しい花子の言葉に感謝するだろう．
」という文（発話テキスト）から感情推定する例を各ステップごとに示しながら処理の流れを説明する．
\StepLabel{〈Step1〉}まず，入力された発話テキスト(a)を「．
」や「！」などの句点に基づき，文毎に分割を行う．
(a)は1文のみで構成される発話テキストなので，分割処理は行われない．
また，(a)には「？」（疑問符）や「！」（感嘆符）のような記号や，その他の記号は含まれないと判定される．
\StepLabel{〈Step2〉}次に，南瓜による係り受け解析を行う．
具体的には，〈Step1〉で分割された一文ごとに解析を行う．
\StepLabel{〈Step3〉}係り受け解析された結果に基づいて，表層格決定処理が行われる．
(a)では，ガ格は「私」，ニ格は「言葉」，述語は「感謝する」と決定される．
また，ニ格に係る修飾句として「優しい花子の」が抽出される．
ここで，述語に付属している文末表現は，モダリティ要素として抽出しておく．
\StepLabel{〈Step4〉}次は，文中の語と感情辞書との照合を行う．
具体的には，格要素ごとに感情属性が含まれるかどうかを判定する．
ここで，図[REF_fig:step5]に示すように，感情語として登録されている「優しい」に感情属性「賞賛」が付与される．
係り受け関係から，ニ格への修飾句「優しい花子」となり，これが感情属性「賞賛」を持つことになる．
また，修飾型は「優しい」のものをそのまま継承して「直接修飾型」となる．
\StepLabel{〈Step5〉}ここで，修飾語による感情属性値の更新ルールが適用される．
(a)の場合，修飾句「優しい花子」が「言葉」に係り，ニ格の感情属性値は上書きされ，「賞賛=1.0」となる．
\StepLabel{〈Step6〉}次に，文型パターンの照合処理が行われるが，(a)の場合，文型パターン「N1-がN2-に感謝する」に一致し，生起主体=「私」であり，(a)から推定される感情は話者の生起感情となる．
そして，文型パターンに付与されているルールに基づき，述語感情属性として「感謝=1.0」が付与される．
\StepLabel{〈Step7〉}文中にモダリティがあるかどうかの判定が行われる．
(a)に含まれる推定のモダリティ「だろう」により，文感情属性値の更新が行われる．
この「だろう」の不確定の度合いが「やや弱い不確定」であれば，不確定値は0.2となり，文感情属性値ベクトルに[MATH]を掛け合わせることで，結果として，｛[MATH]｝という感情属性値が得られる．
\StepLabel{〈Step8〉}最後に感情パラメータの計算が行われるが，発話テキスト中の文が1文のみなので，式[REF_eq:ea]により，
[MATH]
という計算が行われ，話者の生起感情として，｛感謝=1.2,賞賛=0.56｝という結果が出力される．
