提案手法では，シソーラスに沿って段階的に入力単語を抽象化し，それぞれの段階で動詞語義の尤度を計算する．
動詞語義の尤度は尤度パラメータ(確率変数)の値なので，シソーラスに沿った段階的な抽象化は，尤度パラメータの標本空間(定義域)を，シソーラスに沿って段階的に拡張することで実現する．
このように，提案手法では，尤度パラメータの標本空間は可変なのであるが，説明の順番としては，まず，固定された標本空間での多義性の解消法について述べたあとで，可変の標本空間での多義性の解消法について述べ，最後に，[CITE]の手法を変形した手法について述べる．
本章で述べる方法は，一つの係り受け関係において動詞語義を決定する方法である．
複数の係り受け関係がある場合には，関係ごとに尤度1位の語義と2位の語義との尤度差の信頼下限を得て，その値が最大の係り受け関係に従って動詞の語義を決める．
ただし，全ての関係において尤度差の信頼下限が閾値以下である場合には，語義は判定されない．
関係[MATH]にある単語[MATH]と動詞[MATH]とが与えられ，それぞれの語義集合が[MATH]，[MATH]であるとき，語義[MATH]の尤度パラメータ[MATH]の標本空間を定義する．
まず，語義[MATH]と[MATH]とが関係[MATH]で共起することを[MATH]で表し，その共起頻度を[MATH]とする．
このとき，単語[MATH]と語義[MATH]の共起頻度[MATH]に基づいて語義[MATH]の尤度を決める．
[MATH]は，標本空間が[MATH]である確率変数[MATH]の観測値である．
[MATH]の標本空間は[MATH]の標本空間でもある．
本稿では，この標本空間における共起頻度の分布が一般化超幾何分布に従うと仮定する．
つまり，標本空間を[MATH]としたとき，[MATH]と[MATH]との共起頻度を表す確率変数[MATH]の値には[MATH]という制限があり，[MATH]であるとする．
このとき，語義[MATH]の尤度パラメータ[MATH]を以下のように定義する．
ただし，[MATH]．
すると，[MATH]の期待値，分散，および，[MATH]と[MATH]の共分散は以下の通りである(付録A参照)．
ただし，[MATH]である．
動詞の語義を判定するかしないかは，[MATH]の信頼下限([MATH])に基づいて決める．
ここで，[MATH]，[MATH]である．
ただし，動詞の語義を適当に並べかえて，[MATH]ならば[MATH]であるようにする．
推定精度を左右する[MATH]と閾値[MATH]を適当に選んで，[MATH]である場合には[MATH]を語義とする．
そうでない場合には関係[MATH]においては語義を判定しない．
なお，[MATH]と[MATH]の値は[REF_sec:experiment]章で述べる．
複数の関係がある場合には，前述のように，最大の[MATH]である関係(信頼下限最大の関係)に基づいて語義の判定を行う．
これは，[REF_sec:variable]節と[REF_sec:dagan]節で述べる手法についても同様である．
なお，以後，特に断わらない限り，信頼下限とは，尤度1位の語義と2位の語義との尤度差([MATH])の信頼下限([MATH])のことである．
「初めて理由を聞いた」における「聞く」の多義性を解消する．
「聞く」の語義としては，「音を耳に感じとる(HEAR)」と「質問する(ASK)」とを考える．
なお，以下では，[MATH]という表記の代りに[MATH]や[MATH]という表記を用いる．
また，共起頻度はEDR日本語コーパス[CITE]の一部における共起頻度である．
「初めて理由を聞いた」には，「副詞(初めて，聞く)」と「を(理由，聞く)」という二つの係り受け関係があるので．
それぞれについて信頼下限を求めると以下のようになる．
まず，「初めて」は「聞く」との共起回数は1回で，HEARと共起している．
このとき，[MATH]とすると，([REF_D2])式から[MATH]，[MATH]である．
分散は([REF_D3])式から[MATH]であり，共分散は([REF_D4])式から[MATH]である．
以上より，[MATH]，かつ，[MATH]，[MATH]である．
よって，[MATH]である．
次に，「理由」は関係「を」では「聞く」との共起回数は5回で，HEARと0回，ASKと5回共起している．
よって，上と同様な計算により，[MATH]となる．
「聞く」の語義は，[MATH]とすると，以下のように決まる．
まず，「副詞(初めて，聞く)」では，[MATH]であるので，語義は判定されない．
一方，「を(理由，聞く)」では，[MATH]であるので，ASKが語義として選択される．
語義が判定された関係は「を」のみであるので，全体ではASKが語義として選択される．
この例では，信頼下限最大の係り受け関係に従って語義を判定した結果が成功している．
失敗する例については次節で述べる．
本節で述べた手法は，単語と動詞語義との共起頻度に基づいて動詞の多義性を解消する手法であるが，この手法は，容易にクラスベースの手法に拡張できる．
すなわち，あるクラスが与えられたときには，そのクラスと動詞語義との共起頻度に基づいて動詞の多義性を解消すればよい．
このとき，クラスと動詞語義との共起頻度を得るには，そのクラスに属する語義の全てについて動詞語義との共起頻度を得て，それらの和をとればよい．
これは，[REF_sec:dagan]節で述べる手法についても同様である．
前節で述べた手法は，標本空間[MATH]を縮小した標本空間[MATH]における共起頻度の分布についての手法である．
ここでは，標本空間をシソーラスに沿って拡張することを考える．
標本空間を段階的に拡張し，各段階において信頼下限を求め，信頼下限が閾値より大となった時点で語義を判定し，判定のプロセスを終える．
以下では，まず，標本空間の拡張の仕方について述べ，次に，信頼下限の求め方について述べる．
最後に例を示す．
ここで考える標本空間は[MATH]である．
[MATH]は，単語[MATH]の語義集合[MATH]を，シソーラスの構造に従って拡張したものである．
[MATH]は[MATH]の和集合として定義されるので，[MATH]を定義してから，[MATH]を定義する．
まず，[MATH]は，根から[MATH]までの道上の節点において，根からの距離が[MATH]にある節点が支配する葉の集合として定義される．
このとき，根から[MATH]までの距離を[MATH]とすると，
である．
なお，[MATH]のときには[MATH]である．
次に，[MATH]を以下のように定義する．
[MATH]のときには，([REF_U_0j])式と同様に，[MATH]が成立する．
このとき，標本空間は，[MATH]とすると，[MATH]から順に，[MATH]と拡張される．
たとえば，図[REF_fig:U_i]で[MATH]とすると，[MATH], [MATH], [MATH]である．
このとき，標本空間は，[MATH]の順に拡張される．
複数の親を持つ節点の場合には，根からの距離として複数の道の中で最長のものを選択すれば，[MATH]のときに[MATH]となる．
たとえば，根[MATH]から葉[MATH]までの二つの道が，[MATH]と[MATH]であるとき，それぞれの節点の根からの距離は，[MATH]，とする．
標本空間の拡張の仕方は他にも考えられるが，DAGを対象とする場合には，上述の方法が簡明であると考える．
関係[MATH]にある単語[MATH]と動詞[MATH]について，それぞれの語義集合を[MATH], [MATH]とする．
ここで考える標本空間は，[MATH]である．
語義[MATH]の尤度パラメータ[MATH]は，[MATH]とすると，次のように定義される．
[MATH]は，図[REF_fig:I]に示されるような標本空間の構造，すなわち，まず，動詞の語義を選び，次に，その語義のもとで単語の語義を選ぶという構造を反映している．
[MATH]の期待値は以下の通りである．
ただし，[MATH]と[MATH]とは確率的に独立であるとみなした．
なお，分散や共分散は付録Bで与える．
([REF_U1])式における[MATH]や[MATH]は，前と同じように一般化超幾何分布に従う確率変数であり，それらの期待値は以下の通りである．
ただし，[MATH]は関係[MATH]における共起頻度を表す．
分散や共分散も([REF_D3])，([REF_D4])式と同様に得られる．
([REF_U2a])式と([REF_U2b])式に使われる数値のなかで，まず，[MATH]は動詞の語義の数である．
また，[MATH]は標本空間の可変な部分の大きさを表わす数値である．
[MATH]はシソーラスの構造から決まるので，シソーラスの節点にあらかじめ記録しておくことにより，実行時の計算量を減らす．
たとえば，図[REF_fig:U_i]で[MATH]の値を求めるときには，二つの節点[MATH]と[MATH]に記録されている[MATH]と[MATH]の和をとる．
同様に，[MATH]の値も，各節点に，支配下の葉と[MATH]との共起頻度の和を記録しておき，それを利用して求める．
図[REF_fig:U_i]の例では，[MATH]について，[MATH]を求めるためには，[MATH]に記録されている[MATH]の値と[MATH]に記録されている[MATH]の値との和をとる．
また，([REF_U2a])式や([REF_U2b])式の値は，[MATH]ごとに計算され，[MATH]は最大でシソーラスの高さだけの数しかないので，これらの値を計算することは計算量の面で困難ではない．
動詞の語義を判定するかしないかは，[MATH]の信頼下限([MATH])に基づいて決める．
ただし，動詞の語義を適当に並べかえて，[MATH]であるようにする．
なお，[MATH]の期待値は[MATH]である．
また，分散[MATH]は付録Bで与える．
語義を判定するために，[MATH]と[MATH]を適当に選んで，[MATH]である場合には[MATH]を語義とし，語義判定のプロセスを終える．
そうでない場合には，[MATH]の段階では語義の判定をせずに，標本空間をシソーラスに沿って拡張した[MATH]で再び語義の判定をする．
[MATH]においても判定ができないときには関係[MATH]においては語義の判定を行わない．
なお，[MATH]と[MATH]の値は[REF_sec:experiment]章で述べる．
「私は関係者にいきさつを聞いた」における「聞く」の多義性を解消する．
「聞く」の語義としては，前節と同様に，ASKとHEARとを考える．
また，[MATH]とする．
なお，計算に必要なその他の詳細は省略する．
「私は関係者にいきさつを聞いた」には，「は(私，聞く)」「に(関係者，聞く)」「を(いきさつ，聞く)」という三つの係り受け関係があるので，それぞれについて信頼下限を計算し，語義を求める．
「私」は関係「は」では「聞く」との共起回数は6回で，HEARと5回，ASKと1回共起している．
そのため，標本空間を拡張するまでもなく[MATH]となった．
「関係者」は関係「に」では2回共起し，HEARと1回，ASKと1回共起している．
しかし，このHEARでの共起はタグ付けの誤りであり，ASKと共起すべきものであった．
とにかく，この段階ではHEARとASKとで尤度差はない．
しかし，シソーラス(分類語彙表)を2段階あがった時点([MATH])では，[MATH]全体でHEARとの共起は2回，ASKとの共起は9回である．
このとき，[MATH]であり，[MATH]となり，ASKが語義として選択される．
これは，タグ付けの誤りを回避した例である．
「いきさつ」は関係「を」では「聞く」との共起頻度は0である．
一段シソーラスを上ったときの標本空間全体ではASKと1回，HEARと0回共起する．
しかし，この段階では[MATH]であるので語義は判定されない．
そのまま標本空間を拡張していくと，[MATH]で頻度の分布が逆転し，HEARで171回，ASKで104回共起している．
しかし[MATH]と標本空間の大きさが大きいので信頼下限は閾値[MATH]を超えない．
結局，この係り受け関係では語義は判定されない．
これは，シソーラス上での最短距離の語義に従えば成功していた例である．
三つの係り受け関係のうちで「は(私，聞く)」が最も信頼下限[MATH]が大きい．
一般に，シソーラスを上ると標本空間の大きさは指数的に大きくなるので，尤度は指数的に小さくなる．
そのため，標本空間が小さいときの信頼下限は，それが大きいときに比べて大きい．
この例では，「は(私，聞く)」に従って語義を選択するので，HEARが語義に選ばれる．
これは失敗である．
なお，最大の信頼下限に基づく語義選択の妥当性は，[REF_sec:experiment]章で実験により確かめる．
多義性を解消するときに，語義の判定が可能なものだけを判定するという手法は，[CITE]でも採用されている．
[CITE]では，機械翻訳における訳語の選択を目的としているが，ここでは，その手法を，動詞語義の選択のために修正したものについて述べる．
以下では，この手法を単にDaganの手法と呼ぶ．
また，本節で用いられている記号のうちで，新たに定義されていない記号については，[REF_sec:solid]節と同じ意味で用いられている．
標本空間についていえば，Daganの手法は，[REF_sec:solid]節と同じ，固定された標本空間を使う．
ただし，[CITE]では共起頻度は多項分布をしていると仮定している．
動詞の語義を判定するかどうかは，[MATH]と[MATH]との対数比[MATH]に基づいて決める．
ただし，[MATH]は，[MATH]から最尤推定される[MATH]の確率であり，[MATH]，[MATH]である．
もし，[MATH]，[MATH]で[MATH]なるものがあれば，[MATH]の代りに[MATH]を用いる．
[MATH]と[MATH]を適当に選んで，[MATH]である場合には[MATH]を語義とする．
そうでない場合には関係[MATH]では語義は判定されない．
なお，[CITE]では[MATH], [MATH]が選ばれているので，[REF_sec:experiment]章の実験でもそれに従った．
Daganの手法と提案手法との基本的な違いは，標本空間が固定か可変かということである．
提案手法が，尤度の比較に差を用いたり，分布に一般化超幾何分布を仮定したりしているのは，可変の標本空間を上手く取扱うためである．
まず，尤度の比較に差を用いた場合には，標本空間を拡張するたびに尤度や尤度差が指数的に小さくなるので，標本空間の大きさを信頼下限に直接反映させることができる．
Daganの手法のように(対数)比を用いた場合には，第１位の語義の尤度と第２位の語義の尤度とはオーダとしては違わないため，標本空間の大きさは直接には反映されない．
次に，一般化超幾何分布を用いている理由は，標本空間の大きさを明示的に取扱うためである．
提案手法では，標本空間を拡張するたびに，尤度パラメータの期待値や分散が変化することが必要である．
一般化超幾何分布に従うと，([REF_U2b])式で示されるように，標本空間の可変な部分の大きさを[MATH]として明示的に取り扱える．
標本空間の大きさを信頼下限に反映させる理由は，標本空間が小さいときほど語義の判定結果が信頼できると考えているためである．
