\section{実験}
\label{節:実験}

本節では、学習された決定木による省略補完の有効性を検証する。まず、ガ格
(動)に対して検証を行ない、続いてガ格(形)、ヲ格、ニ格に対しての有効性を
議論する。さらに、学習量、決定木学習の話題依存性、使用属性による相違の
三点から検討を行なう。

本論文では、性能評価尺度としてF値(F-measure)を用いる。F値は、再現率
(recall)と適合率(precision)を一つの尺度として表現するために使用される
尺度で、$R$を再現率、$P$を適合率としたとき、以下の式で定義する。

\y{3}
\begin{equation}
F = \frac{(\beta^2 + 1) \times P \times R}{\beta^2 \times P + R}
\end{equation}
\y{3}

ここで、パラメータ$\beta$ は適合率の再現率に対する相対的な重要性である。
本論文ではこのパラメータを$\beta=1$とした。


\subsection{基本条件による実験}

まず、以下の条件により実験を行なった。

\begin{itemize}
\item 実験対象はガ格(動)の省略
\item 属性集合は表\ref{属性} に示した367属性
\item 学習文はコーパスから100対話を無作為に抽出した集合
\item テスト文は学習文と同一の話題の100対話
\end{itemize}

表\ref{標準} に、以上の条件による結果を示す。単位はF値である。表の「学
習文」の欄は、学習文とテスト文を同一にして行なったテスト(closed test)
の結果である。3種類の話題 $H_1$、$H$、$T$の中から各100対話を無作為に選
択して実験を行なった。「未知文」の欄は、未学習文に対するテスト(open
test)を意味する。学習文テスト$T$で用意した100対話と同一の集合をテスト
文にして、それに含まれない100対話をコーパスより無作為に抽出した集合で
決定木学習を行なった。また同表には比較対象として、補完内容を無作為に選
択した場合の精度を(比較A)に、補完内容をすべて最多事例の人称(<1sg>)に一
意に決定した場合の精度を(比較B)に示した。また表の最下段に、未知文テス
トにおける学習文およびテスト文の人称別省略事例数を示した。

また、未知文テストを行なうためにコーパス100対話から作成した決定木の一
部を付録の\ref{節:決定木} に示す。


\begin{table}
\begin{center}
\caption{基本条件による補完精度}
\label{標準}
\x{-10}
\begin{tabular}{cc|*{6}{r}|r}
\hline\hline
        &        &<1sg> &<1pl> &<2sg> &<2pl> & <g>  & <a>  & 全体 \\
\hline       
学習文  &$H_1$ & 99.7\% & 99.2\% &100.0\% &100.0\% &100.0\% &100.0\% & 99.8\%\\
        &$H$   & 99.9\% & 99.8\% &100.0\% &100.0\% &100.0\% & 99.6\% & 99.8\%\\
        &$T$   &100.0\% &100.0\% &100.0\% &100.0\% & 99.4\% & 99.4\% & 99.8\%\\
\hline       
未知文  &$T$   & 82.1\% & 59.5\% & 76.4\% & 15.8\% & 27.8\% & 77.0\% & 73.2\%\\
\hline       
(比較A) &      & 44.2\% & 10.0\% & 21.1\% &  3.7\% &  5.3\% & 15.7\% & 27.9\%\\
(比較B) &      & 61.3\% &  --- &  --- &  --- &  --- &  --- & 44.2\% \\
\hline\hline
(未知文)&学習  & 733  & 197  & 380  &  53  &  57  & 290  & 1710 \\
(未知文)&テスト& 745  & 168  & 356  &  62  &  89  & 265  & 1685 \\
\hline
\end{tabular}
\end{center}
\end{table}

決定木の再現性、弁別性を確認することを目的に行なった学習文テストでは、
決定木の枝刈りを行なっていないため、話題の広さに関係なくほぼ100\%の再
現性を示した。未知文に対するテストでは、(比較A)、(比較B)のいずれよりも
高い値を示し、本手法の有効性が確認された。なお、表はF値のみであるが、
再現率と適合率は共にF値とほぼ同一の値となっている。人称別では、ほぼ学
習事例の多い順に精度が良くなっていることがわかる。<1sg>、<2sg>、<a>に
関しては比較的良好な性能を得ることができたが、<1pl>、<2pl>、<g>につい
ては低い精度しか得ることができなかった。これは学習事例数の不足が一つの
原因と考えられる。

誤りの主な傾向を以下に分類する。

\begin{enumerate}
\item 複文の単文分割に関係する誤り
\item 照合範囲の誤り
\item 単複の弁別性に関係する誤り
\item 文脈省略に関係する誤り
\item タグ付与のゆれ
\end{enumerate}

これらのうち、単文分割に関係する誤りと照合範囲の誤りが最も多かった。前
述したように、本研究では接続助詞によって擬似的に単文分割しているが、例
えば以下の例文のような場合には、「行けば」だけに対して補完処理を行なっ
てしまい、提案手法が有効に機能しない(例文の下線は補完対象用言、`/'は形
態素区切り、`//'は設定した文区切りを示す)。

\begin{example}
\item どう/やっ/て//\underline{行け}/ば//いい/か/分から/ない/ん/です。
\end{example}

また単文であっても、以下の文で「予約」の補完を行なう場合のように、補完
対象の用言(「予約」)の補完に、これとは関係のない付属語(「いたす」「ま
す」)によって判断してしまい、その結果失敗する。

\begin{example}
\item 現在/ご/\underline{予約}/の/フライト日/と/便名/を/お/願い/いたし/ます 。
\end{example}

以上は本手法の問題点であるが、文分割と属性照合を共に厳密にすればよいの
で、今後十分に対処可能な課題である。

一方、単複の誤りと文脈省略に関係する誤りは本質的に難しい問題であり、現
在用意した属性のみによるこれ以上の精度向上は難しいと考えられる。より一
層の精度向上には別の情報が必要である。


\subsection{他手法との比較}
\label{節:比較}

日本語格要素の省略補完を行なう手法はこれまでにもいくつか提案されている。
ここでは、このうちのいくつかの手法と定性的な比較を行なう。

補完の手がかりとなる現象を人手で得点化した{}\cite{村田}では対話文章中
の省略のための規則も作成し、物語文を対象にした実験の結果、学習文(204文)
で86\%、未知文(184文)で76\%の省略が補完できたと報告している。同論文と
本論文との差異を以下に示す。

\begin{description}
\item[対象テキスト]
同論文では物語文中の対話文章のみを対象にしている。本論文では、これらを
含む対話テキストを対象としている。

\item[使用属性]
同論文では一人称と二人称に入りやすい用言として各3語を列挙している。ま
た命令表現と疑問表現は二人称に、ガ格の省略は一人称になりやすいと指
摘している。本論文では、命令や疑問以外の付属語や言語外情報も考慮にいれ
た補完手法を提案している。

\item[パラメータ調整]
同論文ではパラメータ(各規則に付与する得点)を人手で付与している。本論文
ではパラメータ(どの属性がどの順で使用されるか)を統計情報により自動的に
決定している。

\end{description}

Aone and Bennettは文献\cite{Aone}において、本論文と同様に機械学習による省略補完
処理を行なっている。ここでは、照応の先行詞補完の一部として省略補完処理
を行ない、合弁事業に関するテキストにおいて先行詞が組織名である省略の補
完実験を行なった結果、最高で再現率が40.8\%、適合率が73.0\%の補完精度が
得られたと報告している。同論文では先行詞の種類が所与(組織)で組織名を推
定することが目的であり、先行詞の種類(人称)補完を目的とする本論文とは問
題の性質が異なる。また対話文を対象にした補完処理ではないために文脈省略
の補完のみを考慮していることから、本論文と直接比較することはできない。

日本語対話文を対象に省略補完を行なっている研究として、文献\cite{工藤}
がある。工藤らの実験は本論文と同一のコーパスに対しても行なっており、補
完規則作成に使用した文に対する省略補完精度として93.2\%\footnote{複数の
対話コーパスに対する合計の精度。ATR旅行会話コーパスに対しては92.9\%と
報告している。}の補完精度が得られたと述べている。また文献
{}\cite{Nakaiwa}は日英機械翻訳システム評価用例文の175事例に対して
実験を行ない、情報抽出に使用した文に対してテストを行ない、100\%の精度
を得たと報告している。これら両論文はどちらも未知文に対しての報告がない。
これらを比べた時、本論文には以下の優位性があると考える。

\begin{description}
\item[規則作成の困難性]
例えば工藤らは14種類の動詞に対して人手で補完すべき値を分類しているが、
これを多くの動詞\footnote{例えば本実験で使用したコーパスには262種類の
動詞が出現した。}に対して作成するのは容易ではない。

\item[情報利用の局所性]
両論文では、ある文末表現の出現のみで、もしくは用言と文末表現の組み合わ
せのみで省略の多くを補完している。しかしながら、このような少数の要素の
みで正確に補完できるものばかりではないことが予想される。本提案手法では、
多数の属性の組み合わせを考慮できる枠組みとなっており、複雑な組み合わせ
による省略にも対応できる。

\end{description}


\subsection{表層格との関係}
\label{節:格}

ここでは、日本語の主たる表層格であるガ格、ヲ格、ニ格に対する補完精度の
比較を行なうことによって、格との関係を考察する。

本来ならば、補完に必要な属性は格によって異なると考えるのが自然である。
しかし本論文では、手法の有効性を議論し、格による差異を明確化することを
目的とするため、網羅的に属性を用意し、すべての格で学習時に同一の属性集
合を用意した。学習時に用意した属性集合は、これまでと同様、
表\ref{属性} の367属性である。

実験は、それぞれの格について300対話を学習対話とし、それらに含まれない
100対話をテスト対話として未知文テストを行なった。その結果を表\ref{格} に示す。
なお、表でガ格(動)として示した値は、表\ref{学習量} の`400(対話)'
の項と同一の実験である。


\begin{table}
\begin{center}
\caption{格による補完精度の比較}
\label{格}
\begin{tabular}{c|*{4}{c}}
\hline\hline
格        &<1sg>& <2sg> &<a> \hfill & 全体 \\
\hline
ガ格(形)&       58.3\% & 68.1\% & 85.9\% & 79.7\% \\
ヲ格    &       66.7\% & ---    & 97.7\% & 95.6\% \\
ニ格    &       95.2\% & 95.7\% & 81.9\% & 91.7\% \\
\hline
ガ格(動)&       84.7\% & 81.1\% & 82.0\% & 78.7\% \\
\hline
\end{tabular}
\end{center}
\end{table}

表からわかるように、ガ格(動)とガ格(形)との比較では全体としての補完精度
に大きな差異はないが、個別の人称に対する精度では両者に明確な差異が現れ
ている。表には現れていないが、ガ格(形)の補完人称に比較的多くの<a>が含
まれているため、<1sg>あるいは<2sg>に対する学習が十分に行なわれず、比較
的低い精度になったと推察される。

一方ヲ格については、90\%以上の省略が照応的(<a>)であり、外界省略がほと
んどないことから非常に高い数字となった。本手法によってヲ格の文脈省略の
認知は高精度で可能であるので、認知された文脈省略に対し従来から知られて
いる照応解決の諸手法を導入することによって解決できるものと考えられる。


ニ格に関しては十分な性能が得られた。このように高い性能が得られた背景に
は、二者対話を対象にしたテキストであること、話題が旅行対話に限定されて
いるために使用される述語がある程度限定されることなどが考えられる。ニ格
の多くは間接目的語で外界省略が多かった\footnote{表\ref{調査} に示すよう
に、実験で使用したコーパスではニ格の省略の約9割が外界省略で、文脈省略
<a>は1割前後であった。}ため、少数候補からの択一問題に有効な本手法が有
利に機能したものと考えられる。




\subsection{学習量との関係}
\label{節:学習量}

学習量との関係を見るために以下の実験を行なった。学習量として、25、50、
100、200、400対話の5種類の集合を作成した。ここで、これらの集合は包含関
係となるように作成した。テスト集合はこれらのいずれにも含まれない100対
話(ガ格(動)の省略数:1685)を用意した。また、学習属性は表\ref{属性} のも
のを使用した。主な人称に対する実験の結果をF値で表\ref{学習量} に示す。
なお、表の「100 (対話)」の欄は表\ref{標準} の「未知文」の欄と同一である。


\begin{table}
\caption{学習量と補完精度}
\label{学習量}
\begin{center}
\begin{tabular}{rr|*{4}{r}}
\hline\hline
対話 & 事例& <1sg>& <2sg>& <a>& 全省略 \\
\hline
 25 &  463 & 71.0\% & 55.6\% & 66.2\% & 59.0\% \\
 50 &  863 & 76.4\% & 69.7\% & 71.5\% & 67.2\% \\
100 & 1710 & 82.1\% & 76.4\% & 77.0\% & 73.2\% \\
200 & 3448 & 85.1\% & 79.8\% & 79.7\% & 76.7\% \\
400 & 6906 & 84.7\% & 81.1\% & 82.0\% & 78.7\% \\
\hline
\end{tabular}
\end{center}
\end{table}

表\ref{学習量} によれば、ほぼすべての人称に関して学習量の増加と共に性能
が単調に向上している。また、表には示されていないが、再現率、適合率共に
単調増加の傾向を示している。ただし、その増加の割合は徐々に鈍化し、
<1sg>に関しては400対話で精度がわずかに減少していることがわかる。

補完内容と学習量の差をグラフにしたものを片対数グラフで図\ref{図:学習量} に示す。
グラフが示すように、比較的学習事例数の少なかった<2pl>や<g>
が、学習量増加に伴い大きく精度が向上していることがわかる。その様子から、
<1pl>を含めたこれらの人称に関しては学習量の増加によって一層の精度向上
が予想される。

一方、その他の人称並びに全体的な精度に関しては、全体として400対話(6806
事例)でほぼ横ばいになっていることから、$10^4 \sim 10^5$事例の学習量で
十分であると言える。またグラフより、人称に関わらずほぼ一定の精度を示し
ていることから、この時の補完精度(本手法による補完精度の上限)は$80\%
\sim 85\%$となると予想する。


\begin{figure}
\vspace{-6mm}
\begin{center}
\epsfile{file=19.eps,height=88mm}
\caption{学習量と補完性能}
\label{図:学習量}
\end{center}
\end{figure}



\subsection{話題依存性}
\label{節:話題依存性}

ここでは、実験の結果と共に、決定木学習の話題依存性を議論する。学習用の
テキストとして、四つの話題$H_1$、$H_2$、$R$、$T$に属する対話を50対話無
作為に抽出し、これによって決定木学習を行なった。テスト用の対話は前節と
同一の未学習100対話を使用し、未知文テストを行なった。このとき、属性は
表\ref{属性} の367属性を使用した。表\ref{話題依存性} に、テスト対話(＝コー
パス全体)の話題別構成比、並びに話題依存性を示す。表の縦は学習対話の話
題、横はテスト対話の話題を示し、値はF値で表現した。

\begin{table}
\begin{center}
\caption{決定木の話題依存性}
\label{話題依存性}
\begin{tabular}{c|*{4}{r}|r}
\hline\hline
学習/テスト & /$H_1$ \hfil & /$H_2$ \hfil & /$H_R$ \hfil & /$R$ \hfil & 合計 \\
構成比 & 20.1\% & 27.7\% & 11.2\% & 40.9\% & 100.0\% \\
\hline
$H_1$/ & 78.1\% & 55.9\% & 65.3\% & 61.6\% & 63.7\% \\
$H_2$/ & 71.3\% & 67.0\% & 62.6\% & 62.6\% & 65.6\% \\
$R$/   & 75.1\% & 61.7\% & 61.1\% & 75.4\% & 69.9\% \\
$T$/   & 73.4\% & 62.5\% & 62.6\% & 66.2\% & 66.2\% \\
\hline
$T-H_R$/&73.7\% & 61.9\% & 59.5\% & 63.9\% & 64.8\% \\
\hline
\end{tabular}
\end{center}
\end{table}

表に示すように、学習対話とテスト対話が一致している時に、$H_2$を除いて
最も良好な性能となった。また$H_2$においてもかなり高い性能を示した。こ
の傾向は話題に関係なく言えることから、あらかじめテスト対話の話題がある
程度限定される、もしくは予測できる問題に対しては、できるだけ同一の話題
のみによって学習することが望ましく、その際にテスト対話以外の話題を含め
て学習しないことが重要であると考えられる。

学習文の話題別性能では、話題$R$が最も高い性能を示した。この理由は、話
題$R$が何か特殊な情報を持っているためではなく、話題$R$の構成比が最も高
かったためである。

また表によると、広範な話題で学習を行なった場合($T/$)に、全体としても平
均以上の補完精度を示した。学習文とテスト文の話題が同一の場合を除くと、
$T/$はすべての話題に対して良好な性能を示していることが観察される。この
ことから、テスト文の話題が未知の場合は、広範な話題に対して学習を行なう
ことが最も有効であることが示唆される。ただし表\ref{話題依存性} の最下段
に示すように、全く未知の話題($H_R$)に対しては若干精度が低下する。たと
え少量の学習であっても、未学習よりはかなり優位であることがわかる。



\subsection{属性との関係}

本節では、格要素の省略補完の問題解決にどの程度使用属性が関係するかを議
論する。これまでに述べてきた諸実験は、比較のため、すべて同一の属性集合
を使用して行なってきた。ここではこの使用属性を変化させることによって補
完精度がどうなるかを観察する。

ここでは、以下に示す4種類の属性集合を用意した。これらはいずれも表\ref
{属性} に示した属性の部分集合である。

\begin{enumerate}
\item 言語情報のみ(366属性)
\item 機能語のみ(166属性)
\item 内容語のみ(200属性)
\item 用言情報のみ(100属性)
\end{enumerate}

実験は100対話の学習、未学習100対話のテストにより行なった。この対話集合
はどちらも、表\ref{標準} の未知文テスト、あるいは表\ref{学習量} の`100'
の実験と同一である。実験結果を表\ref{結果:属性} に示す。比較対象として、
全属性に実験の結果を表の「全属性」欄に示す。


\begin{table}
\begin{center}
\caption{属性と補完率との関係}
\label{結果:属性}
\begin{tabular}{c|*{4}{c}}
\hline\hline
                &<1sg>  & <2sg> &<a> \hfill & 全省略 \\
\hline
全属性          &       82.1\%& 76.4\%& 77.0\%&  73.2\%\\
\hline
言語情報のみ&   81.9\%& 76.9\%& 77.4\%&  73.2\%\\
機能語のみ  &   75.4\%& 68.0\%& 67.2\%&  65.3\%\\
内容語のみ  &   75.1\%& 58.1\%& 74.5\%&  65.0\%\\
用言情報のみ&   72.3\%& 55.6\%& 71.1\%&  61.9\%\\
\hline
\end{tabular}
\end{center}
\end{table}


表より、言語情報のみを使用した学習では、言語外情報を加えた場合とほとん
ど同程度の精度が得られた。これは、言語外情報(特に実験で用意した話者情
報)がそれほど省略補完に重要でないことを示す。この結果は我々の予想に反
するが、おそらく旅行対話という限られた分野での実験であったため、用言の
情報が話者情報を包含するような関係になったことが理由として考えられる。
つまり用言によって話者が推測できたため、話者情報の必要性が低下した可能
性がある。これらを確認するには、両者が対等な関係にある状況での対話、例
えば自由対話に対して省略補完実験を行なうことが必要であろう。

機能語のみで決定木学習を行なった場合、全体で8\%程度の精度低下が観察さ
れた。この結果は、話題に依存しない機能語のみで決定木学習した場合に、そ
の精度に限界があることを示している。また、機能語のみの結果は文脈省略
(<a>)認知に対して大きな精度低下が見られることから、内容語は比較的照応
関係の維持に寄与していることが予想される。

内容語のみの場合はさらに低い精度となった。日本語対話文においては、内容
語よりも一部の機能語の存在によって省略が可能となる場合が多いということ
をこの結果は示している。さらに用言情報のみを使用した場合は最も悪い精度
を示したが、これは対話文の省略補完が書き言葉のそれと異なる大きな特徴の
一つと考えられる。すなわち、用言情報などの内容語は対話文での省略補完に
おいては相対的に重要性は低いが、文脈省略の先行詞補完など、照応処理に関
しては逆に重要性が増すと予想する。



