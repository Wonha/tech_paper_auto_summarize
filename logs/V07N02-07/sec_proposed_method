本研究での情報検索の問題設定は，日本で開催された情報検索コンテストIREX[CITE]のものと全く同じである．
本研究で検索の対象とするデータは，IREXで用いられた毎日新聞94年95年の二年分の新聞記事データである．
このデータに対して日本語文で記述された検索要求を満足する文書を検索する．
日本語文で記述された検索要求の例を以下に示す(IREXの予備試験の課題より)．
<TOPIC> <TOPIC-ID>1001</TOPIC-ID> <DESCRIPTION>企業合併</DESCRIPTION> <NARRATIVE>記事には企業合併成立の発表が述べられており、その合併に参加する企業の名前が認定できる事。
また、合併企業の分野、目的など具体的内容のいずれかが認定できる事。
企業合併は企業併合、企業統合、企業買収も含む。
</NARRATIVE> </TOPIC>
ここでTOPIC-IDで囲まれた数字は設問番号を意味し，DESCRIPTIONが検索課題を端的に示すフレーズ，NARRATIVEが検索要求を厳密に規定する説明文となっている．
これをシステムがうけとり，例えば以下のような記事を検索対象としてかえせばよい．
<DOCNO>950217091</DOCNO> <SECTION>経済</SECTION> <AE>無</AE> <WORDS>288</WORDS> <HEADLINE>キグナス石油精製を東燃が１００％子会社化</HEADLINE> <TEXT>東燃は十六日、系列のキグナス石油精製（資本金十億円、本社・川崎市、森利英社長）を一〇〇％子会社化すると発表した。
同社は東燃が七割、ニチモウが三割出資しており、東燃はニチモウが所有する全株式六十万株を百二十五億円で買収する。
東燃は石油精製専業大手で、設備シェアは一九九三年度末で八％。
キグナス石油精製を加えると九・四％にシェアがアップする。
ニチモウは山口県の工場閉鎖などに伴う経費ねん出のため株式譲渡を決断した。
石油業界は来年春の特定石油製品輸入暫定措置法（特石法）廃止をにらみ、コスト削減と効率化を進めており、グループ企業統合を含む再編の動きがいよいよ本格化してきた。
</TEXT> </DOC>
この記事のようにSECTIONには経済面などの新聞の誌面情報が，HEADLINEには記事のタイトルが，TEXTには記事の本文がある．
IREXでは，各設問に対し300個の記事を順位つきで提出することになっており，各設問おおよそ50個程度ある正解を上位にたくさん含むような結果を提出すれば，よりよい精度が得られるようになっている．
情報検索の精度の評価には，TRECのtrec_evalというツール[CITE]を利用し，コンテストの評価ではtrec_evalで得られる評価値のうちR-Precisionという評価値(正解記事数分だけ検索した時に正解の記事が含まれている割合)が用いられている．
先に述べたとおり，われわれの情報検索の方法では基本的に，確率型手法の一つのRobertsonの2-ポアソンモデル[CITE]を用いる．
Robertsonらの方法とは，各記事毎に以下の式で与えられるScoreを算出し，Scoreの上位のものを検索結果として出力する方法である．
(以下のScore(d)は記事dのScore．
)
ただし，ここでのキーワードとは検索要求に出現していたキーワードである．
[MATH]はキーワードtの記事dでの出現回数である．
[MATH]は全データベースでのキーワードtが出現している記事の数である．
[MATH]は全データベースに存在する記事の数．
[MATH]は記事dの長さ(文字列単位)である．
[MATH]は全データベースでの記事の長さの平均である．
また，この式の{[MATH]}をTFに関する項としてTF項，[MATH]をIDF(DFの逆数)に関する項としてIDF項と呼ぶことにする．
この式のTFの項が一般のベクトル空間法で重みの一部として用いられるTFと異なり，[MATH]のようになっている．
Scoreをキーワードによる加点として扱うとき，TFの影響が大きい場合だと一つでもTFの値が大きいキーワードがあれば，他のキーワードがほとんど存在していないという関連性が低いときでも十分大きな得点を取ってしまう．
この式はこのことを防ぐのに役に立っている．
この式ではTFが無限になってもたかだか1の値を持つにすぎない．
このため全キーワードがまんべんなく評価されることになる．
さらに，[MATH]という複雑な部分があるが，これは長い記事ほどTFの値が大きくなるのでそれを補正するための項である．
われわれの方法は，この式([REF_eqn:robertson])にいくつかの補強項をつけたものであり，以下の式で表現される．
この式のTF項IDF項は，式([REF_eqn:robertson])と同じである．
この式の[MATH] [MATH]は記事長が長いほど値が大きくなる項で，他の情報がまったく同じならば記事長が長ければ長いほど検索要求を含みやすいと考えて作ったものである．
[MATH]，[MATH]，[MATH]は精度向上のために追加した補強項である．
[MATH]は新聞の紙面情報(分野情報)を利用する項で，[MATH]は記事中でのキーワードの位置で重みを変更するものである．
タイトルにあれば大きい値とし，記事中での位置が最初のものを加点し，後ろのものを減点するということをしている．
[MATH]は，さらに詳細な項でキーワードが固有名詞ならば加点したり，キーワードが「事」「認定」「記事」「言及」などの不要な単語の場合減点したりする項である．
次節ではこれらの補強項の詳細な説明を行なう．
式([REF_eqn:score])のようにわれわれは補強項として[MATH]，[MATH]，[MATH]の三つを用いている．
ここではこれらを詳細に説明する．
位置情報の利用([MATH])
特に新聞記事でいわれることだが，タイトルや記事の最初の文はその記事のおおまかな内容を示すことが多い．
このため，そのような位置に現れるキーワードを重視することで情報検索の精度を向上させることができる[CITE]．
この[MATH]はそのためのもので，記事中でそのキーワードが初めて出現している位置で重みを変更するものである．
タイトルにあれば大きい値とし，記事中での位置も最初のものを加点し，後ろのものを減点するということをする．
この項は以下の式で表される．
この式でlength(d)は記事dの長さでP(d,t)はキーワードtの記事dでの位置を意味する．
[MATH]，[MATH]は実験で定める定数である．
一記事中に同じキーワードが複数出現する場合は最も初めに出現したもののみを用いる．
分野情報(紙面情報)の利用([MATH])
[MATH]は新聞の紙面情報(分野情報)を利用する項である．
これは，関連性フィードバック[CITE]のようなことをするもので，一度この項を1として検索を行ない，その検索結果における上位100個において紙面情報の統計をとり，その統計結果に基づき上位に出現しやすい面を特定し，それと同じ面に書いてある記事の得点を増加させることでScoreを再計算するものである．
例えば，一回目の検索で上位100個には経済面が集中していたとすると，経済面の記事には加点し，そうでない記事は減点するといったことを行なう．
この項([MATH])は以下の式で表される．
だだし，[MATH]は一回目の検索結果の上位100個における記事dが該当する面の割合で，[MATH]は全記事での記事dが該当する面の割合を意味する．
この式の値は，[MATH]が大きく(該当記事の面が一回目の検索結果でよく出現していて)，[MATH]が小さい(該当記事の面が全記事ではそれほど出現していない)場合に大きくなるようになっている．
[MATH]は実験で定める値である．
その他の情報の利用([MATH])
[MATH]は，さらに詳細な項でキーワードが固有名詞ならば加点したり，キーワードが「事」「認定」「記事」「言及」などの不要な単語の場合減点したりするもので，以下の式によって表される．
(本節では表記の簡単化のため，記事，キーワード用の変数d,tを省略して記述している．
)
この式の各項の説明を以下に記述する．
[MATH]
該当するキーワードが検索要求のタイトルDESCRIPTIONから得られたものの場合は[MATH]の値とし，そうでない場合1とする．
この項は検索要求のタイトルDESCRIPTIONから得られたキーワードを重要と考えて加点するためのものである．
[MATH]
該当するキーワードが固有名詞の場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードが固有名詞ならば，そのキーワードを重要と考えて加点する．
[MATH]
該当するキーワードが検索要求において「など」の直前にあった場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードが検索要求において「など」の直前にあった場合，特殊化されたキーワードであると考えて固有名詞と同様に加点する．
[MATH]
該当するキーワードが数字だけで構成されている場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードが数字だけで構成されている場合は情報量が少なくあてにならないキーワードであると考えて減点する．
[MATH]
該当するキーワードがひらがなだけで構成されている場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードがひらがなだけで構成されている場合は情報量が少なくあてにならないキーワードであると考えて減点する．
[MATH]
該当するキーワードがNEGのタグで囲まれた部分からのみ抽出されている場合，[MATH]の値とし，そうでない場合1とする．
検索要求の中には下記のように「〜は除く」という表現にはNEGのタグがふられている．
<TOPIC> <TOPIC-ID>1003</TOPIC-ID> <DESCRIPTION>国連軍の派遣</DESCRIPTION> <NARRATIVE>平和維持活動など国連の活動における国連軍の派遣について述べられている記事。
派遣の目的または対象地域が記事から明示的に分る事。
<NEG>日本の自衛隊を国連に派遣するかどうかという問題のみに関する記事は除く。
</NEG></NARRATIVE> </TOPIC>
[MATH]は，NEGのタグで囲われている部分のみから抽出されたキーワードは逆に不要な記事を取ってくる可能性が高いと考えて減点する．
本論文での実験では[MATH]の値として0を用いている．
これは，NEGのタグで囲われた部分のキーワードの得点は加算も減点もしないという，その部分の情報は全く利用しないという状態を意味する．
[MATH]
該当するキーワードが検索要求において「事,認定,記事,言及,対象,場合,具体的内容」の場合を[MATH]とし，そうでなく「分野,目的,具体的,具体,的,内容,いずれ,結果,問題,場合,影響,可能性,可能,性,指摘,対策」の場合を[MATH]とし，それらでない場合1とする．
「事,認定,記事,言及」といった今回の検索要求固有の表現で検索内容に関わらない表現は不要なキーワードとし，減点するためのものである．
この不要語のリストはIREXの予備試験のときに作成した．
ここで，[MATH]などの各定数は，実験で定めるものとする．
本節では検索要求文からのキーワードの抽出方法について述べる．
キーワードの抽出方法については，いくつかの異なる方法を考えている．
これらについて以下で説明する．
最も短いキーワードのみを利用する方法
これは最も単純な方法である．
検索要求文を単語列に分割し，その単語列のそれぞれの単語をキーワードとする方法である．
われわれのシステムではJUMAN[CITE]でまず形態素列に分割し，さらに得られた形態素を辞書を用いて細分割するということを行なっている．
これは，JUMANでは形態素解析の精度向上のために，複合語のような長い形態素が登録されておりそれが単一の形態素として出力されるためである．
例えば，「国連軍」という語をJUMANに入力しても「国連軍(名詞)」と出力されるだけで細分割を行なわない．
これでは「国連」や「軍」がキーワードとならず情報検索では検索洩れの大きな原因となる．
そこでわれわれのシステムではJUMANの結果をさらに辞書を参照して細分割するようにしている．
いまのところ，簡単のため，二分割を繰り返すアルゴリズムを利用しており，「国連軍」だと「国連」「軍」が辞書にあれば分割するということを行なっている．
辞書としてはEDRの単語辞書[CITE]を利用している．
例として以下の検索要求からキーワードを取り出すこととする．
<TOPIC> <TOPIC-ID>1001</TOPIC-ID> <DESCRIPTION>企業合併</DESCRIPTION> <NARRATIVE>記事には企業合併成立の発表が述べられており、その合併に参加する企業の名前が認定できる事。
また、合併企業の分野、目的など具体的内容のいずれかが認定できる事。
企業合併は企業併合、企業統合、企業買収も含む。
</NARRATIVE> </TOPIC>
まず，DESCRIPTIONから「企業」「合併」というキーワードが得られる．
また，NARRATIVEからは「記事,企業,合併,成立,発表,合併,参加,企業,名前,認定,事,合併,企業,分野,目的,具体的,内容,いずれ,認定,事,企業,合併,企業,併合,企業,統合,企業,買収」というキーワードが得られる．
このとき，助詞の「に」「は」など名詞・未定義語以外の単語はキーワードとしては不適切としてすべて省き，接尾辞の形態素は直前の形態素に接合させるなどの処理をしている．
「最も短いキーワードのみを利用する方法」とは以上の単語をキーワードとして利用するものである．
あらゆるパターンのキーワードを利用する方法
「最も短いキーワードのみを利用する方法」では，細分割されすぎていて例えば，「企業合併」というキーワードは用いず，「企業」「合併」と分離したキーワードしか用いないようになっている．
それよりは，「企業合併」というものもキーワードとして用いた方がよいと考え，短いものも長いものもすべてキーワードとすることを考える．
これを「あらゆるパターンのキーワードを利用する方法」と呼ぶことにする．
例えば，「企業合併成立」が入力されると，「企業」「合併」「成立」という短いものから「企業合併」「合併成立」という中くらいのものと「企業合併成立」という一番長いものまですべてキーワードとして扱う方法である．
この方法ならば，あらゆる長さのキーワードを利用しておりよいのではないかと考えた．
しかし，「企業の合併が成立」からは「企業」「合併」「成立」の三つしか得られないのに対し，「企業合併成立」という表現からは六つのキーワードが得られ，若干不公平ではないかと考えた．
これを正規化するために種々の方法を考えたが，予備試験でのデータでの実験では[MATH]で各キーワードの重みを割ると精度が良かったのでそのように正規化することにした．
ただし，nは連続している単語の数を示す．
例えば「企業合併成立」の例だとn=3となる．
ラティスを利用する方法
「あらゆるパターンのキーワードを利用する方法」は，あらゆるパターンのキーワードを利用するという発想はよいが理由をつけづらい[MATH]というアドホックな式で正規化する必要がある．
そこで，なるべくあらゆるパターンのキーワードを利用しつつなおかつ整合性が保てるように，キーワードへの分割の曖昧性をラティス構造に保存し，先に示した検索で用いる式([REF_eqn:score])のScoreの値が最も大きくなるようなパスでキーワードを分割してキーワードを抽出する方法を考えた．
(この方法は，小澤らの論文[CITE]の3.1節の「類似度を最大とする単語分割」とほぼ同じ考え方である．
違いは検索方法の基本式が異なることや，分割に形態素解析システムを用いていないことで，評価関数の値が最も大きくなるように分割するという意味では全く同じである．
)
例えば，「企業合併成立」の場合だと図[REF_fig:lattice]のラティス構造を得る．
図のように4種類の経路があるので分割の曖昧性として4種類ある．
この4種類の分割を行ないそれぞれ式([REF_eqn:score])のScoreを求め，最も値の大きい経路に分割する．
ある記事では「企業」「合併」「成立」と分割されたものしかなく，分割して計算した方がScoreが大きかったり，またある記事では「企業合併」というものが出現しておりTF項×IDF項の値が「企業合併」の方が極端に大きく「企業合併」「成立」と分割した方がScoreが大きくなりそのように分割するといったことになる．
また，「企業合併」というものが出現していても「企業合併」のTF項×IDF項の値がそれほど大きくなく「企業」と「合併」のTF項×IDF項の和の方が大きい場合は，「企業」と「合併」と分割したものをキーワードとするといったことにもなり，そのときそのときの状況に応じたキーワード分割が可能となる．
この方法ならば，「あらゆるパターンのキーワードを利用する方法」のようなアドホックな正規化を行なう必要がない．
down-weighting[CITE]を利用する方法
この方法はIREXのコンテストで他のチームが提案していた方法で，コンテストの終了後，利用を検討したものである．
この方法は，「あらゆるパターンのキーワードを利用する方法」において，最も短いキーワードはそのままの重みで用い，それよりも長いキーワードは重みが小さくなるように重みづけして用いる方法である．
本研究では，あるキーワードが短いキーワードx個から構成されるとき，そのキーワードに[MATH]の重みをかけることにした．
ただし，[MATH]は実験で定める定数である．
この方法は基本的には最も短いキーワードを用いるが，それよりも長いキーワードについての影響も少々考慮するといったものとなっている．
キーワードの抽出方法として以上の四つを示したが，さらにこれらを式([REF_eqn:score])で使う際にいくつかの選択肢が残されている．
例えば，先ほどの「企業合併」の例のNARRATIVEからは「記事,企業,合併,成立,発表,合併,参加,企業,名前,認定,事,合併,企業,分野,目的,具体的,内容,いずれ,認定,事,企業,合併,企業,併合,企業,統合,企業,買収」というキーワードが得られるが，ここでは「企業」という表現が数多く出現する．
式([REF_eqn:robertson])の説明でTFの影響が強い場合の弊害を説明したが，この場合検索要求文側でのTFの影響が強いという弊害が出る恐れがある．
このために，このキーワード列をそれぞれ同じ種類のものはまとめ，それぞれの種類ごとに一回ずつしか出現していなかったというようにすることも可能である．
Robertsonらはこの場合のことも考え，以下のような評価式も利用している．
(ここでは検索要求文qにおけるScore(d)をScore(d,q)と表記している．
)
ただし，TFq(q,t)は検索要求文qでのキーワードtの出現頻度である．
kqは実験で定める定数である．
kqが0のとき，キーワードをすべてそれぞれの種類ごとに一回ずつしか出現していないかのように扱うことと等価で，kqが∞のとき，キーワードをそのまま出現した個数で扱うことと等価となる\footnote{ kqを∞にする際，kqは定数のため式([REF_eqn:robertson2])に掛けてもScoreの順序関係は変わらないので，式([REF_eqn:robertson2])にkqをかけてからkqを∞にする．
そうすると，式([REF_eqn:robertson2])の最終項は以下のように計算される．
つまり，TFq(q,t)となり，キーワードをそのまま出現した個数で扱うことと等価となる．
}．
さらに，検索要求文においてもIDF項を考慮することが可能で，以下のような式も考えられる．
ただし，Nqは検索要求の個数でDFq(t)はキーワードtがいくつの検索要求に出現しているかの個数を意味する．
多くの検索要求に出現するキーワードほど，「記事」「認識」などの不要語である可能性があり，この項を利用することによりこれらの不要語を減点する効果がある．
本研究での情報検索の問題設定は，日本で開催された情報検索コンテストIREX[CITE]のものと全く同じである．
本研究で検索の対象とするデータは，IREXで用いられた毎日新聞94年95年の二年分の新聞記事データである．
このデータに対して日本語文で記述された検索要求を満足する文書を検索する．
日本語文で記述された検索要求の例を以下に示す(IREXの予備試験の課題より)．
<TOPIC> <TOPIC-ID>1001</TOPIC-ID> <DESCRIPTION>企業合併</DESCRIPTION> <NARRATIVE>記事には企業合併成立の発表が述べられており、その合併に参加する企業の名前が認定できる事。
また、合併企業の分野、目的など具体的内容のいずれかが認定できる事。
企業合併は企業併合、企業統合、企業買収も含む。
</NARRATIVE> </TOPIC>
ここでTOPIC-IDで囲まれた数字は設問番号を意味し，DESCRIPTIONが検索課題を端的に示すフレーズ，NARRATIVEが検索要求を厳密に規定する説明文となっている．
これをシステムがうけとり，例えば以下のような記事を検索対象としてかえせばよい．
<DOCNO>950217091</DOCNO> <SECTION>経済</SECTION> <AE>無</AE> <WORDS>288</WORDS> <HEADLINE>キグナス石油精製を東燃が１００％子会社化</HEADLINE> <TEXT>東燃は十六日、系列のキグナス石油精製（資本金十億円、本社・川崎市、森利英社長）を一〇〇％子会社化すると発表した。
同社は東燃が七割、ニチモウが三割出資しており、東燃はニチモウが所有する全株式六十万株を百二十五億円で買収する。
東燃は石油精製専業大手で、設備シェアは一九九三年度末で八％。
キグナス石油精製を加えると九・四％にシェアがアップする。
ニチモウは山口県の工場閉鎖などに伴う経費ねん出のため株式譲渡を決断した。
石油業界は来年春の特定石油製品輸入暫定措置法（特石法）廃止をにらみ、コスト削減と効率化を進めており、グループ企業統合を含む再編の動きがいよいよ本格化してきた。
</TEXT> </DOC>
この記事のようにSECTIONには経済面などの新聞の誌面情報が，HEADLINEには記事のタイトルが，TEXTには記事の本文がある．
IREXでは，各設問に対し300個の記事を順位つきで提出することになっており，各設問おおよそ50個程度ある正解を上位にたくさん含むような結果を提出すれば，よりよい精度が得られるようになっている．
情報検索の精度の評価には，TRECのtrec_evalというツール[CITE]を利用し，コンテストの評価ではtrec_evalで得られる評価値のうちR-Precisionという評価値(正解記事数分だけ検索した時に正解の記事が含まれている割合)が用いられている．
先に述べたとおり，われわれの情報検索の方法では基本的に，確率型手法の一つのRobertsonの2-ポアソンモデル[CITE]を用いる．
Robertsonらの方法とは，各記事毎に以下の式で与えられるScoreを算出し，Scoreの上位のものを検索結果として出力する方法である．
(以下のScore(d)は記事dのScore．
)
ただし，ここでのキーワードとは検索要求に出現していたキーワードである．
[MATH]はキーワードtの記事dでの出現回数である．
[MATH]は全データベースでのキーワードtが出現している記事の数である．
[MATH]は全データベースに存在する記事の数．
[MATH]は記事dの長さ(文字列単位)である．
[MATH]は全データベースでの記事の長さの平均である．
また，この式の{[MATH]}をTFに関する項としてTF項，[MATH]をIDF(DFの逆数)に関する項としてIDF項と呼ぶことにする．
この式のTFの項が一般のベクトル空間法で重みの一部として用いられるTFと異なり，[MATH]のようになっている．
Scoreをキーワードによる加点として扱うとき，TFの影響が大きい場合だと一つでもTFの値が大きいキーワードがあれば，他のキーワードがほとんど存在していないという関連性が低いときでも十分大きな得点を取ってしまう．
この式はこのことを防ぐのに役に立っている．
この式ではTFが無限になってもたかだか1の値を持つにすぎない．
このため全キーワードがまんべんなく評価されることになる．
さらに，[MATH]という複雑な部分があるが，これは長い記事ほどTFの値が大きくなるのでそれを補正するための項である．
われわれの方法は，この式([REF_eqn:robertson])にいくつかの補強項をつけたものであり，以下の式で表現される．
この式のTF項IDF項は，式([REF_eqn:robertson])と同じである．
この式の[MATH] [MATH]は記事長が長いほど値が大きくなる項で，他の情報がまったく同じならば記事長が長ければ長いほど検索要求を含みやすいと考えて作ったものである．
[MATH]，[MATH]，[MATH]は精度向上のために追加した補強項である．
[MATH]は新聞の紙面情報(分野情報)を利用する項で，[MATH]は記事中でのキーワードの位置で重みを変更するものである．
タイトルにあれば大きい値とし，記事中での位置が最初のものを加点し，後ろのものを減点するということをしている．
[MATH]は，さらに詳細な項でキーワードが固有名詞ならば加点したり，キーワードが「事」「認定」「記事」「言及」などの不要な単語の場合減点したりする項である．
次節ではこれらの補強項の詳細な説明を行なう．
式([REF_eqn:score])のようにわれわれは補強項として[MATH]，[MATH]，[MATH]の三つを用いている．
ここではこれらを詳細に説明する．
位置情報の利用([MATH])
特に新聞記事でいわれることだが，タイトルや記事の最初の文はその記事のおおまかな内容を示すことが多い．
このため，そのような位置に現れるキーワードを重視することで情報検索の精度を向上させることができる[CITE]．
この[MATH]はそのためのもので，記事中でそのキーワードが初めて出現している位置で重みを変更するものである．
タイトルにあれば大きい値とし，記事中での位置も最初のものを加点し，後ろのものを減点するということをする．
この項は以下の式で表される．
この式でlength(d)は記事dの長さでP(d,t)はキーワードtの記事dでの位置を意味する．
[MATH]，[MATH]は実験で定める定数である．
一記事中に同じキーワードが複数出現する場合は最も初めに出現したもののみを用いる．
分野情報(紙面情報)の利用([MATH])
[MATH]は新聞の紙面情報(分野情報)を利用する項である．
これは，関連性フィードバック[CITE]のようなことをするもので，一度この項を1として検索を行ない，その検索結果における上位100個において紙面情報の統計をとり，その統計結果に基づき上位に出現しやすい面を特定し，それと同じ面に書いてある記事の得点を増加させることでScoreを再計算するものである．
例えば，一回目の検索で上位100個には経済面が集中していたとすると，経済面の記事には加点し，そうでない記事は減点するといったことを行なう．
この項([MATH])は以下の式で表される．
だだし，[MATH]は一回目の検索結果の上位100個における記事dが該当する面の割合で，[MATH]は全記事での記事dが該当する面の割合を意味する．
この式の値は，[MATH]が大きく(該当記事の面が一回目の検索結果でよく出現していて)，[MATH]が小さい(該当記事の面が全記事ではそれほど出現していない)場合に大きくなるようになっている．
[MATH]は実験で定める値である．
その他の情報の利用([MATH])
[MATH]は，さらに詳細な項でキーワードが固有名詞ならば加点したり，キーワードが「事」「認定」「記事」「言及」などの不要な単語の場合減点したりするもので，以下の式によって表される．
(本節では表記の簡単化のため，記事，キーワード用の変数d,tを省略して記述している．
)
この式の各項の説明を以下に記述する．
[MATH]
該当するキーワードが検索要求のタイトルDESCRIPTIONから得られたものの場合は[MATH]の値とし，そうでない場合1とする．
この項は検索要求のタイトルDESCRIPTIONから得られたキーワードを重要と考えて加点するためのものである．
[MATH]
該当するキーワードが固有名詞の場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードが固有名詞ならば，そのキーワードを重要と考えて加点する．
[MATH]
該当するキーワードが検索要求において「など」の直前にあった場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードが検索要求において「など」の直前にあった場合，特殊化されたキーワードであると考えて固有名詞と同様に加点する．
[MATH]
該当するキーワードが数字だけで構成されている場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードが数字だけで構成されている場合は情報量が少なくあてにならないキーワードであると考えて減点する．
[MATH]
該当するキーワードがひらがなだけで構成されている場合，[MATH]の値とし，そうでない場合1とする．
検索要求から得られたキーワードがひらがなだけで構成されている場合は情報量が少なくあてにならないキーワードであると考えて減点する．
[MATH]
該当するキーワードがNEGのタグで囲まれた部分からのみ抽出されている場合，[MATH]の値とし，そうでない場合1とする．
検索要求の中には下記のように「〜は除く」という表現にはNEGのタグがふられている．
<TOPIC> <TOPIC-ID>1003</TOPIC-ID> <DESCRIPTION>国連軍の派遣</DESCRIPTION> <NARRATIVE>平和維持活動など国連の活動における国連軍の派遣について述べられている記事。
派遣の目的または対象地域が記事から明示的に分る事。
<NEG>日本の自衛隊を国連に派遣するかどうかという問題のみに関する記事は除く。
</NEG></NARRATIVE> </TOPIC>
[MATH]は，NEGのタグで囲われている部分のみから抽出されたキーワードは逆に不要な記事を取ってくる可能性が高いと考えて減点する．
本論文での実験では[MATH]の値として0を用いている．
これは，NEGのタグで囲われた部分のキーワードの得点は加算も減点もしないという，その部分の情報は全く利用しないという状態を意味する．
[MATH]
該当するキーワードが検索要求において「事,認定,記事,言及,対象,場合,具体的内容」の場合を[MATH]とし，そうでなく「分野,目的,具体的,具体,的,内容,いずれ,結果,問題,場合,影響,可能性,可能,性,指摘,対策」の場合を[MATH]とし，それらでない場合1とする．
「事,認定,記事,言及」といった今回の検索要求固有の表現で検索内容に関わらない表現は不要なキーワードとし，減点するためのものである．
この不要語のリストはIREXの予備試験のときに作成した．
ここで，[MATH]などの各定数は，実験で定めるものとする．
本節では検索要求文からのキーワードの抽出方法について述べる．
キーワードの抽出方法については，いくつかの異なる方法を考えている．
これらについて以下で説明する．
最も短いキーワードのみを利用する方法
これは最も単純な方法である．
検索要求文を単語列に分割し，その単語列のそれぞれの単語をキーワードとする方法である．
われわれのシステムではJUMAN[CITE]でまず形態素列に分割し，さらに得られた形態素を辞書を用いて細分割するということを行なっている．
これは，JUMANでは形態素解析の精度向上のために，複合語のような長い形態素が登録されておりそれが単一の形態素として出力されるためである．
例えば，「国連軍」という語をJUMANに入力しても「国連軍(名詞)」と出力されるだけで細分割を行なわない．
これでは「国連」や「軍」がキーワードとならず情報検索では検索洩れの大きな原因となる．
そこでわれわれのシステムではJUMANの結果をさらに辞書を参照して細分割するようにしている．
いまのところ，簡単のため，二分割を繰り返すアルゴリズムを利用しており，「国連軍」だと「国連」「軍」が辞書にあれば分割するということを行なっている．
辞書としてはEDRの単語辞書[CITE]を利用している．
例として以下の検索要求からキーワードを取り出すこととする．
<TOPIC> <TOPIC-ID>1001</TOPIC-ID> <DESCRIPTION>企業合併</DESCRIPTION> <NARRATIVE>記事には企業合併成立の発表が述べられており、その合併に参加する企業の名前が認定できる事。
また、合併企業の分野、目的など具体的内容のいずれかが認定できる事。
企業合併は企業併合、企業統合、企業買収も含む。
</NARRATIVE> </TOPIC>
まず，DESCRIPTIONから「企業」「合併」というキーワードが得られる．
また，NARRATIVEからは「記事,企業,合併,成立,発表,合併,参加,企業,名前,認定,事,合併,企業,分野,目的,具体的,内容,いずれ,認定,事,企業,合併,企業,併合,企業,統合,企業,買収」というキーワードが得られる．
このとき，助詞の「に」「は」など名詞・未定義語以外の単語はキーワードとしては不適切としてすべて省き，接尾辞の形態素は直前の形態素に接合させるなどの処理をしている．
「最も短いキーワードのみを利用する方法」とは以上の単語をキーワードとして利用するものである．
あらゆるパターンのキーワードを利用する方法
「最も短いキーワードのみを利用する方法」では，細分割されすぎていて例えば，「企業合併」というキーワードは用いず，「企業」「合併」と分離したキーワードしか用いないようになっている．
それよりは，「企業合併」というものもキーワードとして用いた方がよいと考え，短いものも長いものもすべてキーワードとすることを考える．
これを「あらゆるパターンのキーワードを利用する方法」と呼ぶことにする．
例えば，「企業合併成立」が入力されると，「企業」「合併」「成立」という短いものから「企業合併」「合併成立」という中くらいのものと「企業合併成立」という一番長いものまですべてキーワードとして扱う方法である．
この方法ならば，あらゆる長さのキーワードを利用しておりよいのではないかと考えた．
しかし，「企業の合併が成立」からは「企業」「合併」「成立」の三つしか得られないのに対し，「企業合併成立」という表現からは六つのキーワードが得られ，若干不公平ではないかと考えた．
これを正規化するために種々の方法を考えたが，予備試験でのデータでの実験では[MATH]で各キーワードの重みを割ると精度が良かったのでそのように正規化することにした．
ただし，nは連続している単語の数を示す．
例えば「企業合併成立」の例だとn=3となる．
ラティスを利用する方法
「あらゆるパターンのキーワードを利用する方法」は，あらゆるパターンのキーワードを利用するという発想はよいが理由をつけづらい[MATH]というアドホックな式で正規化する必要がある．
そこで，なるべくあらゆるパターンのキーワードを利用しつつなおかつ整合性が保てるように，キーワードへの分割の曖昧性をラティス構造に保存し，先に示した検索で用いる式([REF_eqn:score])のScoreの値が最も大きくなるようなパスでキーワードを分割してキーワードを抽出する方法を考えた．
(この方法は，小澤らの論文[CITE]の3.1節の「類似度を最大とする単語分割」とほぼ同じ考え方である．
違いは検索方法の基本式が異なることや，分割に形態素解析システムを用いていないことで，評価関数の値が最も大きくなるように分割するという意味では全く同じである．
)
例えば，「企業合併成立」の場合だと図[REF_fig:lattice]のラティス構造を得る．
図のように4種類の経路があるので分割の曖昧性として4種類ある．
この4種類の分割を行ないそれぞれ式([REF_eqn:score])のScoreを求め，最も値の大きい経路に分割する．
ある記事では「企業」「合併」「成立」と分割されたものしかなく，分割して計算した方がScoreが大きかったり，またある記事では「企業合併」というものが出現しておりTF項×IDF項の値が「企業合併」の方が極端に大きく「企業合併」「成立」と分割した方がScoreが大きくなりそのように分割するといったことになる．
また，「企業合併」というものが出現していても「企業合併」のTF項×IDF項の値がそれほど大きくなく「企業」と「合併」のTF項×IDF項の和の方が大きい場合は，「企業」と「合併」と分割したものをキーワードとするといったことにもなり，そのときそのときの状況に応じたキーワード分割が可能となる．
この方法ならば，「あらゆるパターンのキーワードを利用する方法」のようなアドホックな正規化を行なう必要がない．
down-weighting[CITE]を利用する方法
この方法はIREXのコンテストで他のチームが提案していた方法で，コンテストの終了後，利用を検討したものである．
この方法は，「あらゆるパターンのキーワードを利用する方法」において，最も短いキーワードはそのままの重みで用い，それよりも長いキーワードは重みが小さくなるように重みづけして用いる方法である．
本研究では，あるキーワードが短いキーワードx個から構成されるとき，そのキーワードに[MATH]の重みをかけることにした．
ただし，[MATH]は実験で定める定数である．
この方法は基本的には最も短いキーワードを用いるが，それよりも長いキーワードについての影響も少々考慮するといったものとなっている．
キーワードの抽出方法として以上の四つを示したが，さらにこれらを式([REF_eqn:score])で使う際にいくつかの選択肢が残されている．
例えば，先ほどの「企業合併」の例のNARRATIVEからは「記事,企業,合併,成立,発表,合併,参加,企業,名前,認定,事,合併,企業,分野,目的,具体的,内容,いずれ,認定,事,企業,合併,企業,併合,企業,統合,企業,買収」というキーワードが得られるが，ここでは「企業」という表現が数多く出現する．
式([REF_eqn:robertson])の説明でTFの影響が強い場合の弊害を説明したが，この場合検索要求文側でのTFの影響が強いという弊害が出る恐れがある．
このために，このキーワード列をそれぞれ同じ種類のものはまとめ，それぞれの種類ごとに一回ずつしか出現していなかったというようにすることも可能である．
Robertsonらはこの場合のことも考え，以下のような評価式も利用している．
(ここでは検索要求文qにおけるScore(d)をScore(d,q)と表記している．
)
ただし，TFq(q,t)は検索要求文qでのキーワードtの出現頻度である．
kqは実験で定める定数である．
kqが0のとき，キーワードをすべてそれぞれの種類ごとに一回ずつしか出現していないかのように扱うことと等価で，kqが∞のとき，キーワードをそのまま出現した個数で扱うことと等価となる\footnote{ kqを∞にする際，kqは定数のため式([REF_eqn:robertson2])に掛けてもScoreの順序関係は変わらないので，式([REF_eqn:robertson2])にkqをかけてからkqを∞にする．
そうすると，式([REF_eqn:robertson2])の最終項は以下のように計算される．
つまり，TFq(q,t)となり，キーワードをそのまま出現した個数で扱うことと等価となる．
}．
さらに，検索要求文においてもIDF項を考慮することが可能で，以下のような式も考えられる．
ただし，Nqは検索要求の個数でDFq(t)はキーワードtがいくつの検索要求に出現しているかの個数を意味する．
多くの検索要求に出現するキーワードほど，「記事」「認識」などの不要語である可能性があり，この項を利用することによりこれらの不要語を減点する効果がある．
