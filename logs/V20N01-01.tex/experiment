評価実験
\label{sec:experiment}

\subsection{実験条件}

実験には，代表的な宿泊施設予約サイトのひとつである楽天
トラベル\footnote{\url{http://travel.rakuten.co.jp/}}
に書き込まれた
\pagebreak
レビューを用いた．楽天トラベルに登録され
ている宿泊施設のうち，都内近辺に立地している11施設を対
象とし，各施設ごとに100レビューを実験に使用した．
また，上記レビュー群から人手で評価視点を抽出して実験の
入力データとして用いることにし，さらにそこから特徴的評
価視点を人手で選び出し，評価用データとして用いた．この
作業によって得られた評価視点は施設あたり平均101個であり，
得られた特徴的評価視点は施設あたり平均12.1個である．
データの信頼性を検証するために 2 名の作業者（$A$と$B$）
によってデータ作成をおこない，特徴的評価視点と判定する
際の一致度を以下の計算式で求めた．
\begin{equation}
 \mathit{agreement}(X,Y) = 
   \frac{\text{$X$ と $Y$ が共に特徴的であると判定した評価視点の数}}{\text{$X$ が特徴的であると判定した評価視点の数}}
\end{equation}
判定の一致度は，$\mathit{agreement}(A,B)=0.72$と
$\mathit{agreement}(B,A)=0.77$となり，この結果から，作業者間の判
定はある程度一致していることが確認できる．
また，事例分析から，以下のような事例において判定が一致
しない傾向があることが確認できた．
\begin{itemize}
\item 
評価視点に異表記がある場合：作業者が共に特徴的であると
判定した評価視点に異表記がある場合，作業者による異表記
の認定不足から，一部の評価視点が特徴的であると判定され
ない．
\item 
連続量を伴う評価視点の場合：例えば「駅前で良かった」や
「駅に近く良かった」のような最寄り駅からの近さについて
の言及があった場合，どの程度の距離であれば特徴的な評価
視点であると判定するかについては作業者の主観に拠る部分
が多い．
\end{itemize}
なお，一致度の測定に$\kappa$値を用いることも考えられる．
しかし，次の理由から今回は実態を把握するのに適していな
いと考え，$\kappa$値の採用を見送った．
すなわち，本実験で用いたデータは，特徴的でない評価視点
が全体の 9 割程度を占めているが，$\kappa$値ではこれらに
対して作業者が共に特徴的でないと判定した場合も一致度に
反映されるためである．

シソーラスに基づく類似度を計算するためのシソーラスには，
分類語彙表\cite{bunrui}を用いた．
また，文脈情報に基づく類似度では，予備実験の結果から経
験的に窓枠を 5 と定め，対象の前後 5 単語を文脈情報として
利用した．ただし，単語情報はMeCabによって文脈を形態素解
析することで獲得し，その際，品詞が「助詞」，「助動詞」，
「記号」である場合は窓枠のカウント対象から除外した．

実験において，スコア関数として対数尤度比を実際に計算す
る際は，ラプラススムージング\cite{map}を適用した．


スコア関数のベースラインとして，\textit{TF} および \textit{TF-IDF}\cite{map}に基づく関数を用いた．
一般に，\textit{TF}, \textit{TF-IDF}は，文書ごとに単語へ重み付
けする際に利用される．しかし，ここでは文書ごとの差異で
はなく施設ごとの差異に注目したいため，次式のように，あ
る施設に対する全レビューをひとつの文書として扱う．


\subsubsection{TF法}

\vspace{-1\abovedisplayskip}
\begin{equation}
\mathit{TF}(o_k, u_j) = \text{施設 $o_k$ の全レビューにおける評価視点}
u_j の出現頻度
\label{eq:tf}
\end{equation}
これは，言い換えると，\tab{kankei} の$a$のみをスコア関
数として考慮することに等しい．


\subsubsection{TF-IDF法}

\vspace{-1\abovedisplayskip}
\begin{equation}
\mathit{TF-IDF}(o_k, u_j) = \mathit{TF}(o_k,u_j) × \log ( \frac{|D|}{DF(u_j)} + 1 ) 
\label{eq:tfidf}
\end{equation}
$|D|$は一般的な定義では文書数であるが，上記で述べたよう
に今回は施設数に等しい．$DF(u_j)$はレビューに評価視点
$u_j$が現れた施設数である．

評価尺度には，情報検索のランキング課題の評価によく利用
される \textit{Mean Average Precision} (\textit{MAP}) を用いた．
\textit{MAP} は次式で定義される\cite{map}．
\begin{equation}
 \mathit{MAP} = \frac{1}{|\mathcal{O}|}\sum_{o_k \in \mathcal{O}}\frac{1}{|\mathcal{A}_k|}\sum_{\hat{u}_j \in \mathcal{A}_k}
	\mathit{Precision}(\mathit{rank}(o_k, \hat{u}_j))
\label{eq:map}
\end{equation}
ここで，$\mathcal{O}$は評価対象の集合であり，
$\mathcal{A}_k$は評価対象$o_k$のレビューから人手によっ
て得られた特徴的評価視点の集合である．$\mathit{rank}(o_k, \hat{u}_j)$
は$o_k$中のある特徴的評価視点$\hat{u}_j$が，何らかのランキン
グ手法によって与えられた順位を示しており，
$\mathit{Precision}(\mathit{rank}(o_k, \hat{u}_j))$は，その順位までの出力結果に
おける適合率である．
つまり，ここでは，ひとつの評価対象が情報検索におけるひ
とつの検索課題に相当するものと見なされて評価される．



\subsection{実験結果}
\label{sec:experiment1}

\begin{table}[b]
 \caption{実験結果（異表記を考慮しない場合）}
 \label{tab:ranking_result}
\input{01table02.txt}
\end{table}

まず，異表記問題への対応を考慮しない場合の結果について
述べる．この結果を\tab{ranking_result}に示す．
\tab{ranking_result}から提案手法 \textit{LLR} がベースライン手法
    （\textit{TF}および\textit{TF-IDF}）よりも性能が向上するこ
    とが確認できた．
\textit{TF} では，\eq{tf}からもわかるように，比較すべき他施設の
評価視点に関する情報を全く考慮していない．そのため，もっとも
低い性能になったと考えられる．
次に，\textit{TF-IDF}では，$\mathit{DF}(u_j)$によって他施設の情
報をある程度考慮することができるが，その情報は出現の有
無のみである．
一方の \textit{LLR} では，評価視点の他施設での出現頻度に関する情
報も反映できており，この差が\tab{ranking_result}の結果
に繋がったと考えられる．

\tab{ranking_result}の結果に対して，「手法間の
\textit{Average Precision} に差がない」という帰無仮説を立て，
対応のある両側$t$検定を実施した．その結果，\textit{LLR} 法と
\textit{TF} 法，および \textit{LLR} 法と \textit{TF-IDF} 法のどちらとの間
でも，有意水準$1\%$で統計的有意差が確認できた．

\begin{table}[b]
 \caption{評価視点ランキングの結果例（異表記を考慮しない場合）}
 \label{tab:ranking_top}
\input{01table03.txt}
\end{table}

\tab{ranking_top}に，実験データ中の 3 つの宿泊施設におけ
るランキング結果の例を示す．下線にボールド体の評価視点
が正しい特徴的評価視点をあらわす．また，括弧内は出現頻
度（\textit{TF}値）である．
評価視点の右に``＊''印があるものについては，その評価視
点が含まれていた文脈（の一部）を例として
\tab{ranking_top_example}に示す．
\tab{ranking_top}の事例の観察から，
\textit{TF} では「部屋」や「立地」，「対応」など一般的で出現頻
度が高くなりやすい語が上位を占めており，それらの一部が
誤りとなっていた．その一方で，\textit{LLR} では「武道館」などの
出現頻度は決して高くないが対象施設に固有な評価視点の順
位がベースラインよりも上がっており，提案手法では他施設
との比較がうまく機能していたことがわかる．
しかし，\tab{ranking_top}の観察によると，「パン」と「朝
  食のパン」のように，宿泊者から見れば同一の事物と考え
られるものが異なる順位として現れており，また，
\tab{ranking_top}から外れた下位の評価視点に目を向けると，
12位に「クロワッサン」，50位には「焼き立てパン」などが
含まれており，異表記が生じていることも同時に確認できた．

\begin{table}[t]
 \caption{評価視点を含む文脈の例}
 \label{tab:ranking_top_example}
\input{01table04.txt}
\end{table}

そこで次に，\sec{cl}で述べた補正手法によって異表記問題
に対応した場合の結果について述べる．
3 つのランキング手法（\textit{TF}，\textit{TF-IDF}，および，
\textit{LLR}）に対して補正手法を適用した実験をおこなったが，
\textit{TF}，\textit{TF-IDF} が \textit{LLR} を上回ることがなかったため，
以下では，\textit{LLR} に対して補正手法を適用する場合の結果を中
心に述べる．

補正手法を適用した結果を\fig{ranking_result_be}と
\fig{ranking_result_af}に示す．\fig{ranking_result_be}
が事前処理法の結果であり，\fig{ranking_result_af}が事後
処理法の結果である．
各図において，縦軸は \textit{MAP} を示し，横軸は以下で述べる類似
度への閾値を示している．凝集型クラスタリングでは，デン
ドログラムと呼ばれるクラスタをノードとする木を生成する
が，各クラスタにはその子ノードの情報から計算される類似
度が付随している．本実験では，この類似度に閾値を設け，
類似度が閾値以下になったときに併合を停止させてクラスタ
リング結果を得ることにし，閾値を変化させながら，それぞ
れの \textit{MAP} を計測した．
今回の場合，類似度の値が$1.0$ となる事例が存在していな
かったため，横軸左端の結果は，クラスタリングを行わない
場合の結果（\tab{ranking_result}の$0.574$）と同一となっ
ている．

\begin{figure}[t]
 \begin{center}
 \includegraphics{20-1ia960f2.eps}
 \end{center}
 \caption{実験結果（異表記を考慮する場合：事前処理法）}
 \label{fig:ranking_result_be}
\end{figure}
\begin{figure}[t]
 \begin{center}
 \includegraphics{20-1ia960f3.eps}
 \end{center}
 \caption{実験結果（異表記を考慮する場合：事後処理法）}
 \label{fig:ranking_result_af}
\end{figure}

\fig{ranking_result_be}，\fig{ranking_result_af}共に，
全体的な傾向として，類似度の閾値を$1.0$から下げるに従い
\textit{MAP}が上昇していくことから，クラスタリングを施すことに
一定の効果があることが確認できるが，ある類似度を契機に
下降に転ずることがわかる．
このような結果は次の理由によると考えられる．すなわち，
もともと全ての評価視点において異表記が存在するわけでは
ないため，クラスタリングすべき評価視点も部分的となる．
今回のようにボトムアップにクラスタリングを進めた時，あ
る点でクラスタリングすべき評価視点のまとめ上げが終了し，
この時点が最適なクラスタ数となり最良の \textit{MAP} 値を得る．し
かし，それ以降は本来クラスタリングすべき評価視点に対す
るまとめ上げではなくなるため本来の目的とは逆に過併合が
生じることになり，性能が悪化すると考えられる．

\textit{MAP} 値が下降するタイミングがクラスタリング手法によって
大幅に異なるが，この違いはクラスタリング手法に起因して
必然的に生じる結果であると考えられる．すなわち，単連結
法（\eq{single}）は類似度の最大値に基いて併合を進めるた
め，ノードに付随する類似度が 3 手法の中で最も速く大きく
なり，\textit{MAP}値も最も速く下降していく．完全連結法
（\eq{complete}）は，逆に，類似度の最小値に基いているた
め，\textit{MAP} 値の下降が最も遅い．また，類似度の平均値に基づ
く群平均法（\eq{group}）は，上記両者の中間に位置してい
ると言える．


\begin{table}[b]
\caption{評価視点ランキングの結果例（異表記を考慮した場合）}
\label{tab:ranking_top2}
\input{01table05.txt}
\end{table}

クラスタリングを施した場合のランキング結果の例を
\tab{ranking_top2}に示す．例示している宿泊施設は
\tab{ranking_top}と同じであり，\tab{ranking_top2}におい
て，下線にボールド体の評価視点が正しい特徴的評価視点を
あらわす．また，各表の右列がクラスタ情報である．
表の観察から，クラスタリングによって異表記がまとめ上げ
られていることが確認できる．また，
宿泊施設Aのように，クラスタリング前は「パン」，「朝食の
  パン」という情報しかわからなかった状態において，「ク
  ロワッサン」のように，詳細な情報を補う効果も事例によっ
て期待できることがわかった．
同様の観点で\tab{ranking_top2}以外の事例を観察してみる
と，クラスタリング前は「野菜」という評価視点のみが上位
にランクされていたが，クラスタリングによって野菜が「春
  野菜」であることが補えたり，クラスタリング前は「壁」
のみであったものが，クラスタリングによって「防音」の壁
であることが補える例が存在していた．


\begin{figure}[b]
 \begin{center}
 \includegraphics{20-1ia960f4.eps}
 \end{center}
 \caption{類似度尺度ごとの性能}
 \label{fig:ranking_sim}
\end{figure}
\begin{table}[b]
 \caption{クラスタリングによって構成された評価視点の異表記クラスタの例}
 \label{tab:cluster}
\input{01table06.txt}
\end{table}

最後に，3 種類の類似度を統合した効果を確認する．
\fig{ranking_sim}に 3 種類の類似度尺度を単独で用いた場合
の結果および類似度を統合した場合の結果を示す．類似度尺
度以外の実験設定は先程の結果で最良の$MAP$値となった設定，
すなわち，群平均法でクラスタリングし，事後処理法でラン
キングを補正する手法を適用した．
また，
クラスタリングによって構成されたクラスタの例を
\tab{cluster}に示す．表の各行において，そのクラスタを構
成した類似度尺度に「◯」印を付けている．また，2 つ以上
の類似度尺度で同じクラスタが構成されていた場合は類似度
の値が最も高い類似度尺度に「◯」印を付けている．
\fig{ranking_sim}から，どの類似度尺度も統合結果の最良値
を上回ることはなく，このことから，類似度を統合すること
の効果が確認できた．ただし，
今回使用したデータに対して人手でクラスタリングを施した
結果を用いてランキングを補正したところ，\textit{MAP} 値は
$0.713$まで向上した．つまり，クラスタリング手法および統
合手法に対する改善の余地が残されていることが示唆される．



