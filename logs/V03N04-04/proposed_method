主語補完の方法 \label{sec:主語補完の方法}

\subsection{基本的考え方} \label{subsec:基本的考え方}
言語を用いた人と人とのコミュニケーションにおいては，「言わなくとも分かること」は言わないのが普通であり，ゼロ主語の場合もこれに相当する．このような言われなかったことが実際に何を表すかは，広い意味での文脈から推定される．人間の場合は，生まれて以来修得した，あるいは生まれる前から持っている各種の知識が文脈として利用できるが，現在の計算機では，このようなことは不可能である．そこで，計算機で取り扱えるより狭い文脈を利用せざるをえない．つまりゼロ主語のまわりのテキスト自体を文脈として利用することになる
\footnote{「テキストが実世界とどのような関係にあるのか」という意味での文脈を context，「テキストのある部分が，そのテキスト全体とどのような関係にあるのか」という意味での文脈を discourse として区別することもあるが，ここでは両者ともに文脈と呼ぶ．}．
以下その方法を説明する．具体例については\ref{sec:補完実験} 章で述べる．ま
ず，主語補完が必要となる述語のまわりの文脈から，主語となりうる名詞句を候
補として取り出す．そして，これらの主語候補名詞句に関する様々な情報を特徴
パラメータとして，やはり文脈から抽出する．その結果，主語候補名詞句は特徴
パラメータの数の次元を持つ空間内の点として表現される．この空間を特徴パラ
メータ空間と呼ぶ．


実際の主語補完は，学習フェーズと補完フェーズの２つのフェーズに分けられる．前者は，学習データ（標本）を用いて，確率分布を推定するフェーズであり，補完フェーズに先だって行われる．後者は，実際の主語補完を行うフェーズである．

学習フェーズでは，学習データを使って，特徴パラメータ空間上で主語になる名詞句の分布と主語にならない名詞句（非主語）の分布を求める．具体的には，主語補完が必要な述語に対して，主語候補名詞句を抽出し，それらの名詞句の中でどれが真の主語であるかを人手で判断したデータを学習データとして用意する．そして，これらの学習データを用いて，特徴パラメータ空間上の確率分布を推定する．確率分布は，離散型の場合，確率関数で与えられ，連続型の場合は，確率密度関数で与えられる．このようにして学習（推定）された，主語の確率（密度）関数を$p$，非主語の確率（密度）関数を$q$ と書く．

補完フェーズでは，主語補完が必要な述語に対して，主語候補の名詞句$\{n_{1},n_{2},\cdots ,n_{k}\}$とそれらの特徴パラメータの値を文脈から抽出する．そして，これらの名詞句の中から，$p$と$q$ の比が最大となるもの
\begin{equation}
 n = \arg\max_{i=1, \cdots ,k} \frac{p(n_{i})}{q(n_{i})}
                                             \label{eq:尤度比}
\end{equation}
を主語として補完する．

\subsection{主語候補の範囲} \label{subsec:主語候補の範囲}
まず，文脈として考慮しているゼロ主語の付近，つまり，主語のない補完対象述語の付近のテキストの中から，補完されるべき主語候補を抽出する範囲を決めなければならない．本稿では，自動短文分割の後処理としての主語補完を考えているので，以下の範囲の名詞句に主語候補を制限した．
\begin{enumerate}
\item 主語候補は補完対象述語の左側にある．つまり，前方照応のみを考えている．
\item 主語候補は分割対象文内にある．分割前の複数文内の照応は考慮していない．
\item 主語候補は「は，が，では，を，で，も，に，の，としては，には」のいずれかの助詞（助詞相当表現を含む）を持つ名詞句である．ただし，「の」は動詞に連接する場合のみ（「太郎の書いた本」など）を対象とする
\footnote{ここで対象としてる格助詞は，原文での格を表わす助詞であり，補完
  された主語の格を表わすものではない．格助詞「を」を持つ名詞句が，正解候
  補である例は，\ref{subsec:誤りデータの分析}節の第１の例にある．}．
\end{enumerate}
これらの条件を満足する名詞句を主語候補として抽出する．

\subsection{特徴パラメータの設定} \label{subsec:特徴パラメータの設定}
次にこれらの主語候補や文脈が持っている種々の性質から主語補完に有効である性質を特徴パラメータとして取り出す．このような性質として，ここでは８種のものを選定した．この選定は，データの事前分析による経験的なものである．これらの特徴パラメータは以下に示すように，文法的性質，意味的性質および当該名詞句と補完対象述語の間の各種の距離に関する性質に分けられる．以下各特徴パラメータについて説明する．

\paragraph{（１）助詞の種類}
候補名詞句に付属する助詞の種類は主語補完に利用できる．この情報は従来の「談話分析」に基づく主語補完でも利用されている．考察する助詞の種類は，候補名詞句の範囲に含まれるものである．予備実験の結果，最も主語となる可能性が高い助詞から順に並べて，その順番に数値を小さい方から割り当てた．その結果，「は，では，が，の，としては，に，で，を，も，には」が０から９に対応した．間隔は１である．

\paragraph{（２）文字数}
主語が補完対象述語からどの程度離れているのかは，主語認定のもう一つの手掛かりになる．一般的に遠く離れているほど主語になれる可能性は低くなる．ここではその離れている度合，即ち距離を計る基準として，候補名詞句と補完対象述語との間の文字数を用いた．ただし，離散分布のときはスパースになりすぎるので文字数を１０で割って，少数点以下を切り捨てた値を特徴パラメータとした．距離に関するその他の基準としては，（５）から（８）までがある．

\paragraph{（３）意味的整合性}
主語候補と補完対象述語間の意味的結合の整合度は，格助詞「が」を中心とした語と語の係り受けデータ\cite{田中89}と分類語彙表\cite{国語研64}を利用して計算する．まず，あらかじめ係り受けデータを分類語彙表を用いて，係り元の分類番号（３桁）と係り先の語形の間の係り受けデータに変換しておく．次に，実行時には，主語候補の分類番号を求め，その番号と補完対象述語の語形との間に係り受け関係があるかどうかを係り受けデータの中で検索する．そして，検索に成功したものを整合するとして，以下の数値を用いる．
\begin{itemize}
 \item 整合する場合：2.0　
 \item 整合しない場合：0.0
 \item 主語候補の分類番号が得られなかった場合：1.0
\end{itemize}

\paragraph{（４）連体節との関係}
連体節に含まれる名詞句の係り受け範囲はその連体節に制限される場合が多いので，主語候補が連体節に含まれているかいないかは主語認定の手掛かりになる．連体節に含まれている場合は「１」，いない場合は「０」に数量化した．

\paragraph{（５）「は」の数}
一般的に係助詞「は」はある主題を表すので，同一文内で他の「は」によって主題の切り替えを行なった際，前者が後者を越えて係る場合はあまり見られない．即ち，同一文内の「は」助詞は相互に影響を受ける．本パラメータは，候補名詞句と補完対象述語との間の係助詞「は」の数である．

\paragraph{（６）「が」の数}
同じく，格助詞「が」の数である．「が」も「は」のように相互に影響を受けるため，他の「が」の存在は主語補完に有効な情報である．

\paragraph{（７）「は」「が」以外の格文節の数}
同じく，「は」と「が」以外の格文節の数である．通常，主語候補の内，述語により近いものが主語として認定される可能性が高いのでこの格文節の数が少ないほど主語として認定されやすい．ただし，ここでは補完対象述語自身は数えない．

\paragraph{（８）動詞の数}
主語候補と述語の間に存在する動詞の数を示す．一般的に，文末に係る主語を除
いて，この数値が大きいほど主語になれる可能性は低い．ただし，連体形の動詞
は数えない．

\bigskip\bigskip
以上の特徴パラメータの値は，形態素解析，文節認定およびグルーピングと呼ば
れる部分的な構文解析によって得られる\cite{金94}．また，
\ref{subsec:主語候補の範囲} 節で述べた主語候補の抽出もこれらのプログラム
によって行うことができる．

\subsection{確率モデルの範囲と主語補完の方法} \label{subsec:確率モデルの範囲と主語補完の方法}

\ref{subsec:特徴パラメータの設定} 節で述べた特徴パラメータの個数は$8$であ
るので，特徴パラメータ空間の次元は$8$となる．従来法では，この特徴パラメ
ータの空間を，実ベクトル空間として，多次元正規分布モデルによる主語補完を
行っていた\cite{金94}．しかし，特徴パラメータは，本来，離散的なものであ
る．そこで，本稿では，連続モデルと離散モデルの双方について考察する．本稿
で対象としている確率モデルは

\begin{quote} \vspace*{2mm}
\begin{tabular}{ll}
連続分布 & 正規分布 \\
         & 疑似正規分布 \\
離散分布 & １次対数線形分布 \\
         & ２次対数線形分布 \\
\end{tabular}
\vspace*{2mm} \end{quote}
である．このモデルの詳細は章を改めて述べる．学習フェーズでは，これらのモ
デルに対して，その母数\footnote{確率分布のパラメータのことであるが，特徴
  パラメータと混同しないために母数という用語を用いる．}を学習データから推
定する．補完フェーズでは，主語と非主語の確率（密度）関数の値，$p$と$q$ 
を求め，式(\ref{eq:尤度比})に従って主語を補完する．

確率モデル \label{sec:確率モデル}

\subsection{連続分布} \label{subsec:連続分布}
連続分布としては，多次元正規分布と正規分布に基づくGram-Charlier展開\cite[pp.228-229]{Stuart94}を多次元に拡張した分布（疑似正規分布と呼ぶ）について考察した．連続分布の場合は，$p,q$ として，確率密度関数を用いる．それらを，正規分布の場合は，$p_{G},q_{G}$と書き，疑似正規分布の場合は，$p_{H},q_{H}$と書く．

\paragraph{正規分布}
正規分布は連続分布として広く用いられる分布であり，まず正規分布から出発するのは自然である．正規分布の密度関数は，特徴パラメータ空間の次元を$k$（今の場合$k=8$）とするとき，以下のようになる．主語の分布に対して，平均値ベクトルを$\mu_{p}$，共分散行列を$\Sigma_{p}$とし，特徴パラメータ空間における主語候補の点の位置を${\bf x}$とするとき，
\begin{equation}
 p_{G}({\bf x})=(\frac{1}{\sqrt{2\pi}})^{k}
       \frac{1}{\sqrt{\det{\Sigma_{p}}}}
       \exp{-\frac{1}{2}({\bf x}-\mu_{p})^{t}\Sigma_{p}^{-1}
        ({\bf x}-\mu_{p})}
\end{equation}
と書ける．非主語の分布に対する$q_{G}$についても同様である．分布の母数の数は平均値ベクトルで$k$個，共分散行列で$k(k+1)/2$個である．

\paragraph{疑似正規分布}
正規分布は対称であるが，後述する実験から，$p,q$は非対称であることが観察される．そこで，非対称性を扱える分布として，疑似正規分布を考える．この場合は，密度関数が
\begin{equation}
 p_{H}({\bf x})=[\sum_{(i_{1},i_{2},\cdots,i_{k})\in I}
       a_{i_{1}i_{2} \cdots i_{k}}
       H^{1}_{i_{1}}({\bf x}) H^{2}_{i_{2}}({\bf x}) \cdots
       H^{k}_{i_{k}}({\bf x})] p_{G}({\bf x})
       \label{eq:hermite}
\end{equation}
と表される．ここで，$I$ はインデックスの集合であり，$p_{G}({\bf x})$は正規分布の密度関数である．$H^{j}_{i_{j}}$は$i_{j}$次のHermite多項式から計算される．式 (\ref{eq:hermite})の導出は付録\ref{app:疑似正規分布}で詳述する．非主語に対する$q_{H}$の場合も同様である．疑似正規分布の母数は，平均値ベクトル，共分散行列に加えて，係数$a_{i_{1}i_{2}\cdots i_{k}} ((i_{1},i_{2},\cdots ,i_{k})\in I)$がある．係数$a_{i_{1}i_{2}\cdots i_{k}}$の次数を$m=i_{1}+i_{2}+\cdots +i_{k}$とすると，$m$次の係数の総数は$(k+m-1)!/m!(k-1)!$となる．$0$次の係数は$1$であり，$1$次と$2$次の係数はすべて$0$である．今回の考察では，$3$次以下の係数のみを用いている．そこで，$a_{i_{1}i_{2}\cdots i_{k}} ((i_{1},i_{2},\cdots ,i_{k})\in I)$の総数は$k(k+1)(k+2)/6$個である（$0$次を除く）．なお，疑似正規分布では，分布の裾の方で値が$0$以下になってしまう場合が起こり得る．このような場合には，$p_{H}$や$q_{H}$の代わりに$p_{G}$や$q_{G}$を用いた．

\subsection{離散分布} \label{subsec:離散分布} 
前節で述べたように，特徴パラメータは離散的であり，離散分布を適用するのが本来である．離散分布は特徴パラメータに対する同時分布の確率関数$p(i_{1},i_{2}, \cdots ,i_{k})$で表現される．この意味は，$j$番目$(j=1,\cdots,k)$の特徴パラメータが$i_{j}$という値を取る事象の確率である．$j$番目のパラメータが取る値の範囲を$i_{j}=1,2,\cdots,I_{j}$とすると，単純に離散モデルを適用した場合，母数の数は$I_{1} \times I_{2} \times \cdots \times I_{k}$となってしまう．このように多くの母数に対して，その値を精度良く推定するためには，極めて大きい標本が必要となり，現実的でない．そこで，母数の数を少なくするために対数線形分布を用いる．この分布は，確率関数$p$の対数が
\begin{eqnarray}
 \lefteqn{
  \log{p(i_{1},i_{2}, \cdots ,i_{k})}
 } \nonumber \\
 &=& \log{h^{(0)}}+ \sum_{j=1}^{k} \log{h^{(1)}_{j}(i_{j})}
   +\sum_{j=1}^{k-1} \sum_{l=j+1}^{k} \log{h^{(2)}_{j,l}(i_{j},i_{l})}
   \nonumber \\
 & & +\sum_{j=1}^{k-2} \sum_{l=j+1}^{k-1} \sum_{m=l+1}^{k} 
   \log{h^{(3)}_{j,l,m}(i_{j},i_{l},i_{m})}+ \cdots
\end{eqnarray}
のように書ける分布である．ここで，関数$h^{(i)}_{j_{1},j_{2}, \cdots ,j_{i}}$の値は$j_{1},j_{2}, \cdots ,j_{i}$番目の特徴パラメータの値のみの関数であり，それらの特徴パラメータに対する周辺分布から計算される．本稿では，$h^{(1)}_{j}$のみを用いる１次対数線形分布および$h^{(2)}_{j,l}$のみを用いる２次対数線形分布を考える．前者に対する確率関数$p$，$q$を$p_{1}$，$q_{1}$と書き，後者に対しては，$p_{2}$，$q_{2}$と書く．ただし，両分布とも，$p$の値が$0$となる場合には，主語に対する学習データの総数$N_{p}$を用いて，$ p=\frac{1}{N_{p}} $とフロアリングした．$q$の値が$0$となる場合には，非主語に対する学習データの総数$N_{q}$を用いて，$ q=\frac{1}{N_{q}} $とした．

\newpage
\paragraph{１次対数線形分布} 
１次対数線形分布は
\begin{equation}
 p_{1}(i_{1},i_{2}, \cdots ,i_{k})=
  \prod_{j=1}^{k} h^{(1)}_{j}(i_{j})
\end{equation}
と表される．$h^{(1)}_{j}(i_{j}) (j=1,\cdots,k)$は$j$番目の特徴パラメータの値$i_{j}$のみの関数であり，$p^{(1)}_{j}$をパラメータ$j$ に対する１次の周辺分布とするとき，
\begin{equation}
 p^{(1)}_{j}(i_{j})=
  \sum_{i_{1}=1}^{I_{1}} \cdots \sum_{i_{j-1}=1}^{I_{j-1}}
  \sum_{i_{j+1}=1}^{I_{j+1}} \cdots \sum_{i_{k}=1}^{I_{k}}
  \prod_{j^{'}=1}^{k} h^{(1)}_{j^{'}}(i_{j^{'}})
\end{equation}
を満足するように定められる．このような$h^{(1)}_{j}$は実は$p^{(1)}_{j}$そのものである．つまり，
\begin{equation}
  p_{1}(i_{1},i_{2}, \cdots ,i_{k})=
    \prod_{j=1}^{k} p^{(1)}_{j}(i_{j})
\end{equation}
となる．これは特徴パラメータが互いに独立であると仮定した分布に他ならない．この場合の母数は$p^{(1)}_{j}(i_{j}) (j=1, \cdots ,k; i_{j}=1, \cdots ,I_{j})$であり，その総数は$I_{1}+I_{2}+ \cdots +I_{k}$となる．非主語に対する１次対数線形分布$q_{1}$についても同様に定義される．

\paragraph{２次対数線形分布} 
２次対数線形分布は
\begin{equation}
  p_{2}(i_{1},i_{2}, \cdots ,i_{k})= 
   \prod_{j=1}^{k-1} \prod_{l=j+1}^{k}
   h^{(2)}_{j,l}(i_{j},i_{l})
\end{equation}
と表される．$h^{(2)}_{j,l}(i_{j},i_{l}) (j=1,\cdots,k-1, l=j+1,\cdots,k)$は$j$番目の特徴パラメータの値$i_{j}$および$l$番目の特徴パラメータの値$i_{l}$のみの関数であり，$p^{(2)}_{j,l}(i_{j},i_{l})$をパラメータ$j,l$に対する２次の周辺分布とするとき，
\begin{eqnarray}
 \lefteqn{
  p^{(2)}_{j,l}(i_{j},i_{l})
 }  \nonumber \\
 &=& \sum_{i_{1}=1}^{I_{1}} \cdots \sum_{i_{j-1}=1}^{I_{j-1}}
  \sum_{i_{j+1}=1}^{I_{j+1}} \cdots \sum_{i_{l-1}=1}^{I_{l-1}}
  \sum_{i_{l+1}=1}^{I_{l+1}} \cdots \sum_{i_{k}=1}^{I_{k}}
  \prod_{j^{'}=1}^{k-1} \prod_{l^{'}=j^{'}+1}^{k}
    h^{(2)}_{j^{'},l^{'}}(i_{j^{'}},i_{l^{'}})
    \label{eq:制約式２}
\end{eqnarray}
を満足するように定められる．このような$h^{(2)}_{j,l}(i_{j},i_{l})$は２次の周辺分布から，比例反復法\cite[pp.235-238]{廣津82}に基づいて求めることができる．その方法を付録\ref{app:比例反復法}に示す．この場合の母数は$h^{(2)}_{j,l}(i_{j},i_{l}) (j=1,2, \cdots ,k-1; i_{j}=1,2, \cdots ,I_{j}; l=j,j+1, \cdots ,k; i_{l}=1,2, \cdots ,I_{l})$であり，その総数は，
\begin{equation}
  \sum_{j=1}^{k-1} \sum_{l=j+1}^{k} I_{j} \cdot I_{l}
\end{equation}
となる．非主語に対する２次対数線形分布$q_{2}$についても同様に定義される．

疑似正規分布の導出と母数の推定 \label{app:疑似正規分布}

$k$次元の実数空間に値をとる確率変数${\bf X}=(X_{1},X_{2},\cdots,X_{k})^{t}$の$(i_{1},i_{2},\cdots,i_{k})$次のモーメント$\mu_{i_{1}i_{2}\cdots i_{k}}$は$E$を期待値をとる作用素として，
\begin{equation}
 \mu_{i_{1}i_{2}\cdots i_{k}}=
   E[X_{1}^{i_{1}}X_{2}^{i_{2}} \cdots X_{k}^{i_{k}}]
\end{equation}
である．これらを用いて，まず，平均値ベクトル$\mu$と共分散行列$\Sigma$が以下のように求められる．$\mu$の要素を$\mu_{1},\mu_{2},\cdots,\mu_{k}$とすると，
\begin{equation}
 \begin{array}{ll}
 \mu_{1} = \mu_{100 \cdots 0}, \\
 \mu_{2} = \mu_{010 \cdots 0}, \\
 　　　\cdots  \\
 \mu_{k} = \mu_{00 \cdots 01}
 \end{array}
\end{equation}
である．また，$\Sigma$の$(i,j)$要素$(i,j=1, \cdots ,k)$を$\Sigma_{ij}$とすると
\begin{equation}
 \begin{array}{ll}
 \Sigma_{11} = \mu_{20 \cdots 0} - \mu_{1} \mu_{1},  \\
 \Sigma_{12} = \mu_{110 \cdots 0} - \mu_{1} \mu_{2},  \\
 　　　\cdots  \\
 \Sigma_{ij} = \mu_{0 \cdots 0 \breve{1} 0 \cdots 0 \breve{1} 0 
   \cdots 0}^{\; \; \; \; \; \; \; i \; \; \; \; \; \; \; j } 
    - \mu_{i} \mu_{j}
 \end{array}
\end{equation}
などと求められる．

$\Sigma$の Cholesky 分解$(\Sigma=CC^{t})$が正則であるとして，
\begin{equation}
 {\bf Y} = C^{-1}( {\bf X} - \mu)
\end{equation}
と変数変換を行い，$\mu$のまわりの $(i_{1},i_{2}, \cdots ,i_{k})$次の正規化モーメント$\alpha_{i_{1}i_{2} \cdots i_{k}}$が
\begin{equation}
 \alpha_{i_{1}i_{2} \cdots i_{k}}=
   E[Y_{1}^{i_{1}}Y_{2}^{i_{2}} \cdots Y_{k}^{i_{k}}]
\end{equation}
と求められる．

さらに，式(\ref{eq:hermite})の係数を求める．式(\ref{eq:hermite})の$H^{j}_{i_{j}}({\bf X})$は$i_{j}$次のHermite多項式$\tilde{H}_{i_{j}}$を用いて
\begin{equation}
 H^{j}_{i_{j}}({\bf X})=\tilde{H}_{i_{j}}(Y_{j})
\end{equation}
である．係数$a_{i_{1}i_{2} \cdots i_{k}}$はHermite多項式の直交性を利用して，以下のように求められる．
\begin{eqnarray}
 \lefteqn{
  \int_{-\infty}^{\infty} \cdots \int_{-\infty}^{\infty}
  H^{1}_{i_{1}}({\bf X}) \cdots H^{k}_{i_{k}}({\bf X})
  p_{H}({\bf X})d{\bf X}
 } \nonumber \\
 &=&\!\!\int_{-\infty}^{\infty} \cdots \int_{-\infty}^{\infty}
  H^{1}_{i_{1}}({\bf X}) \cdots H^{k}_{i_{k}}({\bf X})
  [\sum_{(j_{1},j_{2},\cdots,j_{k})\in I}a_{j_{1}j_{2} \cdots j_{k}}
   H^{1}_{j_{1}}({\bf X}) \cdots H^{k}_{j_{k}}({\bf X})]
   p_{G}({\bf X})d{\bf X} \nonumber \\
 &=&\!\!\int_{-\infty}^{\infty} \cdots \int_{-\infty}^{\infty}
  \tilde{H}_{i_{1}}(Y_{1}) \cdots \tilde{H}_{i_{k}}(Y_{k}) \nonumber
  [\sum_{(j_{1},j_{2},\cdots,j_{k})\in I} a_{j_{1}j_{2} \cdots j_{k}}
  \tilde{H}_{j_{1}}(Y_{1}) \cdots \tilde{H}_{j_{k}}(Y_{k})] \nonumber \\
 & &\!\!\frac{1}{\sqrt{2\pi}}\exp{-\frac{Y_{1}^{2}}{2}} \cdots
  \frac{1}{\sqrt{2\pi}}\exp{-\frac{Y_{k}^{2}}{2}}
  dY_{1} \cdots dY_{k} \nonumber \\
 &=&\!\!a_{i_{1}\cdots i_{k}}i_{1}! \cdots i_{k}!
\end{eqnarray}
そこで
\begin{equation}
 c_{ir}=(-1)^{r}(2r-1)!! \frac{i!}{2r!(i-2r)!}
\end{equation}
とおくと，
\begin{equation}
 a_{i_{1}i_{2} \cdots i_{k}}
 =\frac{1}{i_{1}!i_{2}! \cdots i_{k}!}
  \sum_{r_{1}=0}^{[\frac{i_{1}}{2}]}
  \sum_{r_{2}=0}^{[\frac{i_{2}}{2}]} \cdots
  \sum_{r_{k}=0}^{[\frac{i_{k}}{2}]}
  c_{i_{1}r_{1}}c_{i_{2}r_{2}} \cdots c_{i_{k}r_{k}}
  \alpha_{(i_{1}-2r_{1})(i_{2}-2r_{2}) \cdots (i_{k}-2r_{k})}
\end{equation}
となる．ここで，$[n]$は$n$を越えない最大の整数である．

以上の式を用いて，学習データ（標本）からモーメントおよび正規化モーメントの推定値を計算すれば，全ての母数，$\mu$，$\Sigma$および$a_{i_{1}i_{2}\cdots i_{k}}$の推定値が得られる．

比例反復法による２次対数線形分布の母数の推定 \label{app:比例反復法}

２次対数線形分布の母数である$h^{(2)}_{j,l}(i_{j},i_{l}) (j=1,2, \cdots ,k-1;　i_{j}=1,2, \cdots ,I_{j};　l=j,j+1, \cdots ,k;　i_{l}=1,2, \cdots ,I_{l})$は以下の比例反復法によって求めることができる．２次対数線形分布の制約式である
\begin{equation}
p^{(2)}_{j,l}(i_{j},i_{l})=
  \sum_{i_{1}=1}^{I_{1}} \cdots \sum_{i_{j-1}=1}^{I_{j-1}}
  \sum_{i_{j+1}=1}^{I_{j+1}} \cdots \sum_{i_{l-1}=1}^{I_{l-1}}
  \sum_{i_{l+1}=1}^{I_{l+1}} \cdots \sum_{i_{k}=1}^{I_{k}}
  \prod_{j^{'}=1}^{k-1} \prod_{l^{'}=j^{'}+1}^{k}
  h^{(2)}_{j^{'},l^{'}}(i_{j^{'}},i_{l^{'}})
 \label{eq:２次周辺分布}
\end{equation}
を変形すると，
\begin{eqnarray}
 \lefteqn{
    p^{(2)}_{j,l}(i_{j},i_{l})
 }  \nonumber \\
  &=& h^{(2)}_{j,l}(i_{j},i_{l}) \nonumber \\
  & & \times 
  \sum_{i_{1}=1}^{I_{1}} \cdots \sum_{i_{j-1}=1}^{I_{j-1}}
  \sum_{i_{j+1}=1}^{I_{j+1}} \cdots \sum_{i_{l-1}=1}^{I_{l-1}}
  \sum_{i_{l+1}=1}^{I_{l+1}} \cdots \sum_{i_{k}=1}^{I_{k}}
  \prod_{j^{'}=1}^{k-1} 
  \prod_{l^{'}=j^{'}+1,(j^{'},l^{'})\neq (j,l)}^{k} 
   h^{(2)}_{j^{'},l^{'}}(i_{j^{'}},i_{l^{'}}) \nonumber \\
\end{eqnarray}
と書くことができる．そこで，$h^{(2)}_{j,l}(i_{j},i_{l})$の$r$回目の推定値を$h^{(2),(r)}_{j,l}(i_{j},i_{l})$とし，式(\ref{eq:２次周辺分布})の右辺に$h^{(2),(r)}_{j,l}(i_{j},i_{l})$を代入して求めた２次周辺分布を$p^{(2),(r)}_{j,l}(i_{j},i_{l})$とするとき，$r+1$回目の推定値を
\begin{equation}
    h^{(2),(r+1)}_{j,l}(i_{j},i_{l})
  = \frac{p^{(2)}_{j,l}(i_{j},i_{l})}
  {p^{(2),(r)}_{j,l}(i_{j},i_{l})}
  h^{(2),(r)}_{j,l}(i_{j},i_{l})
\end{equation}
のようにして求める．この反復を，推定値が収束するまで繰り返し行う．なお，初期値は以下のように設定した．
\begin{eqnarray}
 h^{(2),(0)}_{j,l}(i_{j},i_{l})=
  \left\{
  \begin{array}{ll}
   1, & \mbox{$p^{(2)}_{j,l}(i_{j},i_{l})\neq 0$} \\
   0, & \mbox{else}
  \end{array}
  \right.
\end{eqnarray}




\bibliographystyle{jnlpbbl}
\bibliography{nlp}


\begin{biography}
\biotitle{略歴}
\bioauthor{江原 暉将}{
1967年早稲田大学理工学部電気通信学科卒業．
同年，日本放送協会に入局．1970年より放送技術研究所に勤務．現在，先端制作技術研究部主任研究員．
かな漢字変換，機械翻訳などの研究に従事．
電子情報通信学会，情報処理学会，ＡＣＬ，機械翻訳協会 各会員．
}
\bioauthor{金 淵培}{1958年生．1983年 University of S$\tilde{a}$o Paulo 大学工学部化学工学科卒業．1984年（株）ブラビス・インターナショナル入社．1991年ＮＨＫ入局．現在，放送技術研究所・先端制作技術研究部においてニュース用日英機械翻訳，自然言語処理等の研究に従事．情報処理学会，ＡＡＡＩ 各会員．
}

\bioreceived{受付}
\biorevised{再受付}
\bioaccepted{採録}

\end{biography}

