本システムは,日本語の形態素に関する,構成規則,連接規則および連接確率表をもって日本語の入力テキストの解析を行い,形態素とその属性を自動的に抽出する.
抽出した情報は, 2種類の辞書に分けて管理する.
完全情報辞書:信頼できる情報として確定した形態素を保管する.
予め,確定したものとしての形態素が登録してあってもよい.
それぞれの形態素とその形態素属性(品詞,活用種類,活用形)の各項目が記録してある.
完全情報辞書は,入力テキストの解析においても利用する.
不完全情報辞書:抽出した形態素の候補を保管する.
完全情報辞書と同様の項目に加えて,その信頼性を示す評価値が記録してある.
システムは,大きく辞書情報推定処理と辞書再構成処理とからなり,入力テキストの文ごとに解析を行う.
辞書情報推定処理は,組み込みの規則・表と完全情報辞書を用いて文を形態素(候補)に分割した上で,未知(完全情報辞書にない)の形態素候補に対してその形態素属性を推定する.
このとき,その推定の信頼性についての評価値も計算する.
辞書再構成処理は,得られた未知の形態素についての情報と評価値を不完全情報辞書に付加する.
すでに登録されている候補については,登録されている評価値を改訂する.
この結果,評価値が基準値以上となった形態素は,不完全情報辞書から完全情報辞書に移動する.
図[REF_fig:overview]に処理の概要を示す.
本システムにおいては,形態素に関してつぎの体系を採用した.
字種構成:形態素は,ひらがな,カタカナ,漢字,漢字＋ひらがな,英字,数字,記号のいずれかの字種だけで構成される.
品詞分類:形態素の品詞は,動詞,形容詞,形容動詞,助動詞(活用する品詞)と,名詞,副詞,連体詞,接続詞,感動詞,助詞,接辞,特殊(活用しない品詞)に分類する.
助詞は,さらに格助詞,接続助詞,副助詞,引用助詞,連用助詞,終助詞に分類する.
活用種類:動詞の活用種類は,五段活用,上一段活用,下一段活用,カ行変格活用,サ行変格活用のいずれかとする.
前3者には,活用行の別が伴う.
活用形:活用形は,未然形,連用形,終止形,連体形,仮定形,命令形(ただし,形容詞と形容動詞は命令形をとらない.
)の６種類とする.
この体系で日本語の形態素すべてが扱えるわけではない.
たとえば,字種構成の規則からは「は握」などの混ぜ書き語が扱えない.
これは,完全情報辞書にごく少数の登録しかない状態から始めて自動的に形態素情報を抽出させるという目的から,体系の完全性を期すよりも,入力テキストの解析が有効に行え,実質的に多くの形態素とその属性が自動抽出できることの方を優先させたことによる.
また,形態素について,ここに示した品詞,活用に関する属性以外の属性は考えない.
たとえば,名詞を固有名詞,一般名詞などに分類することはしない.
同じ形態素が複数の活用形に対応することがある.
{行く}は、終止形にも連体形にも対応する.
さらに同じ形態素が複数の活用種類(活用行)に対応することもある.
{行っ}は、{行く}(か行五段)にも{行う}(わ行五段)にも対応する.
そこで,本システムでは,形態素の品詞が活用するものであるときは,その活用に関する属性を集合として取り扱うことにした.
辞書についても,活用に関する属性は一般に集合として登録しておく.
上で述べた形態素の体系は,形態素どうしの連接についての規則も包含する.
活用形はその直後に来る形態素の品詞をある程度限定するし,助動詞や助詞はその直前に来る品詞や活用形を限定する.
とくに助動詞・助詞による限定は,個々の助動詞・助詞に強く依存する.
さらに助動詞の活用形は,個々の助動詞によって異なる.
そこで本システムでは,初期の完全情報辞書には少なくともすべての助動詞・助詞を登録しておくことを前提とした.
これに加えて,助動詞についてはその活用形と直前に来る品詞や活用形の制限を,助詞についてはその分類ごとに直前に来る活用形の制限を,プログラムに組み込んだ.
また,他の活用語についても活用形による直後に来る品詞の部分的な制限をプログラムに組み込んだ.
これらの規則の組込みだけでは尽くせない連接がある.
たとえば,名詞どうしが連接しうるし,副詞と名詞が連接しうる.
本システムでは,形態素レベルでの連接関係だけで辞書情報を得ることを目的とする.
そこで,これらの連接関係については,日本語についての統計知識を連接確率表の形で組み込むこととした.
形態素についての統計知識は,字種構成に関するものと,連接関係に関するものを,つぎのような確率表の形にしてシステムに組み込んだ.
形態素の字種カテゴリーからみた品詞の確率表(表[REF_tab:char_type_matrix]),
後方の助詞からみた前方品詞の連接確率表(表[REF_tab:particle_connect_matrix]),
後方の品詞からみた前方品詞の連接確率表(表[REF_tab:connect_matrix]),
前方の品詞からみた後方品詞の連接確率表(表[REF_tab:connect_before_matrix])
前3者は属性の推定に用い,最後のものは推定結果の信頼性評価に用いる.
\tiny
これらの統計知識は,入手可能であった朝日新聞の91年1月から6月までの社説 (総文字数884,696,総形態数241,573)を日本語総体とみなして我々自らで算出したものである.
これは,日本語全般にわたるこれらの統計知識として確立したものを入手することができなかったことによる,止むを得ない処置であった.
(確立した統計知識が得られないこともあって,先に述べたような,簡略化した形態素体系を採用することにもなった.
)なお,文頭の形態素には先行する形態素がない,文末の形態素には後続する形態素がないという特殊性から,表[REF_tab:connect_matrix]と表[REF_tab:connect_before_matrix]は,たんなる転置行列にはなっていない.
この統計知識の算出にあたっては,極力人手を省くため,公開されているJUMAN を利用した.
ただし, JUMANが採用している形態素体系は,本システムで想定したものとは若干異なるので,その差異を自動的に変換するプログラムを用意して算出を行った.
JUMANは,また,その辞書にない形態素を未定義語と分類してしまう.
そこで, JUMANの解析結果を人手によって調べ,未定義語となったものについてそれぞれその辞書に追加登録を行い,改めて統計をとった上で算出を行った.
(同時に,その辞書について発見した誤りについても,訂正を行った.
)
文を形態素に分割する処理では,辞書引きに依存するのがふつうである.
しかし,本システムは,辞書がほとんど整備されていなくても使えることを目的としているから,字種によって,まず文の1次分割を行う.
1次分割では,文を左から右へと走査する.
得られた分割それぞれについて,辞書引きを援用しながら右から左へと走査しながら2次分割を行う.
これは,辞書に助詞・助動詞が少なくとも入っているという前提を活かすためである.
文の形態素(候補)への分割は,つぎの手順による.
1次分割：字種が変化する位置だけに着目して,文を左から右へ走査し, 2度目の変化点ごとに分割していく.
ただし,記号の前後では.
これにかかわらず必ず分割する.
また, 2度目の変化点で,漢字からひらがなへと変化する場合は,その次の変化点で分割する.
2次分割：1次分割で得た区分ごとに処理を行う.
区分内を右から左に走査しながら,つぎの条件を満たす最長の部分ごとに分割していく.
完全情報辞書に一致する形態素があれば,その最長のもの
なければ,字種構成の規則( [REF_morpheme_taikei]節参照)で許される最長のもの
例として,「アジア外交の変革を求めた」に本アルゴリズムを適用してみる.
ここでは,助詞・助動詞だけが完全情報辞書に入っていると仮定しておく.
まず, 1次分割によって,つぎのように分割される.
区分「アジア外交の」に対する2次分割は,つぎのようになる.
まず末尾からの部分列
に対して辞書引きを行う.
ここでは,助詞{の}が完全情報辞書にあるので,これを切り離す.
次に
に対して辞書引きを行うが,いずれも辞書にない.
字種構成の規則(カタカナ＋漢字の構成を認めていない)から最長の{外交}を切り離す.
残った部分列{アジア}に対しても,同様に走査するが,途中での切離しは生じない.
こうして,
という,形態素(候補)への分割が終わる.
同様に,「変革[MATH]を」(助詞{を}が辞書にある),「求め[MATH]た」(助動詞{た}が辞書にある)という分割を得る.
こうして,
の計7個の形態素(候補)が得られる.
1次分割で得られる区分の末尾にはひらがなが並ぶことが多い.
その部分での2次分割が円滑に行えるように助動詞・助詞の辞書登録を必須の条件にした.
また,手近な例文で試行錯誤を行い,接続詞,連体詞などの,かな書きされ, 1次分割結果の区分の先頭に現れやすい活用しない単語約100語を選定して,これらも完全情報辞書に最初から登録しておくこととした.
分割アルゴリズムによって得た形態素(候補)のうち,つぎのものだけに確定マークをつけておく.
完全情報辞書から直接に得たもの
字種が,カタカナ,漢字,英字,数字,記号のいずれか1つだけで構成されるもの
確定マークは,辞書再構成処理で不完全情報辞書から形態素候補を取り除く際に補助情報として利用する.
確定マークがつかないのは,ひらがな,漢字＋ひらがなの字種構成になっているものに限られる.
「アジア[MATH]外交[MATH]の[MATH]変革[MATH]を[MATH]求め[MATH]た」の例では, {求め}だけに確定マークがつかず,他のものにはすべて確定マークがつく.
形態素への分割によって得られた形態素のうち,未知の(完全情報辞書になかった)ものの形態素属性を,既知の(完全情報辞書にあった)形態素の属性などから推定する.
属性推定は,品詞の推定を主とし,活用に関する属性はその補助として行う.
未知の形態素に対して推定される形態素情報は,ふつう何種類にも及ぶ.
推定が終わると,得られた形態素情報に対して,それぞれ評価値を計算する.
図[REF_fig:pers_fig]にその流れを示す.
文の分割で得られた形態素(候補)列について,文末から文頭への方向に属性推定作業を進める.
推定は,既知の形態素から始めて次の既知の形態素に至るまでの,未知形態素の列ごとに行う.
必要なら,文末に既知の形態素としての句点(品詞は特殊)を仮定する.
推定は,つぎの手順による.
形態素の字種がカタカナ,英字,数字で構成されていれば,品詞を名詞として推定を終える.
記号で構成されていれば,品詞を特殊として推定を終える.
その他の字種構成の場合は,表[REF_tab:char_type_matrix]から確率[MATH]でない品詞(助詞・助動詞は除く)だけを候補とする.
その上で,直後の形態素が助詞であれば,表[REF_tab:particle_connect_matrix]を調べて確率が[MATH]の品詞を候補から除外する.
品詞候補として活用するものがある場合には,形態素の語尾を調べ,活用種類・活用形を推定する.
この結果と両立しえない品詞候補は除外する.
それぞれの品詞候補と直後の形態素の品詞との連接を調べ,規則から許されないものは除外する.
このとき,活用する品詞候補については,前段で得た活用種類・活用形も含めて調べる.
とくに直後の形態素が助詞・助動詞であればその個々の規則を適用する.
残った品詞候補について,候補3選規則([REF_narrowing]節参照)を適用して高々3つに絞り込む.
最後の2段階は,直後の形態素が未知のものであれば,そこで推定された品詞ごとに施す.
それらの結果すべてを一括して推定結果とする.
したがって,推定結果が4つ以上になることもありえる.
それまでに得られた複数の品詞候補の中から,直後の形態素の品詞との連接確率(表[REF_tab:connect_matrix])を利用して,高々3つに候補を絞り込むためのつぎの規則を候補3選規則とよぶ.
候補3選規則:表[REF_tab:connect_matrix]での値が高いものから順に2つを選ぶ.
第3位のものの確率が[MATH]以上であれば,これも選ぶ.
確率が[MATH]のものは,対象外とする.
したがって,候補3選規則を適用した結果,残る候補が1つになることもある.
「事[MATH]は[MATH]少し[MATH]動き[MATH]そうだ」を例に,属性推定の様子を示す.
ここで, {は}と{そうだ}は,それぞれ助詞,助動詞として既知である.
推定作業は,「少し[MATH]動き」と「事」についてそれぞれ起きる.
{動き}についての推定から始める.
直後の形態素が助詞でないから,その字種構成から名詞,動詞,形容詞,形容動詞などが品詞候補となる.
語尾{き}からか行五段(連用)・か行上一段(未然,連用)・か行変格(連用)の動詞,または形容詞・形容動詞の語幹と推定できる.
そこで,直後の形態素{そうだ}との連接を調べる.
助動詞{そうだ}は,終止形,連用形,語幹にだけ連接するから,品詞候補は動詞(連用形),形容詞(語幹),形容動詞(語幹)だけになる.
候補3選規則を適用して,動詞(連用形),形容詞(語幹)と推定する.
{少し}について推定する.
字種構成,語尾から候補は,名詞,動詞(さ行五段(連用)・さ行変格(連用)),形容詞(語幹),形容動詞(語幹)などとなる.
直後の形態素{動き}を動詞とすれば,語幹には連接しないから形容詞,形容動詞は除外でき,さらに候補3選規則を適用して名詞,動詞と推定する.
同様に{動き}を形容詞とすれば,副詞,動詞と推定することになる.
一括して,名詞,動詞(連用),副詞と推定する.
{事}について推定する.
直後の形態素が格助詞{は}であることから,名詞,動詞,形容詞が候補となり,字種構成からも除外はおきない.
語尾からは,動詞が除外され,形容詞(語幹)と推定できる.
{は}は形容詞語幹に接続しないことから,形容詞が除外される.
候補3選規則を適用して(するまでもないが) ,名詞と推定する.
この例からもわかるように,活用に関する推定は,
形態素自身の形(語尾)からの推定
それに対する連接による限定
の2段階からなる.
後者はその出現位置に依存する情報であり,前者は依存しない情報である.
そこで,システム内では,前者で得た情報をそのまま保持し,その特定出現位置について除外されたものにはその旨を示す除外マークをつけておくという記録方式をとった.
推定された形態素属性については,それぞれの品詞ごとにその推定の信頼性を示す評価値を算出する.
切り出された形態素の字種構成が,カタカナ,英字,数字,記号の場合には,その評価値を1.0とする.
残る字種構成の形態素に対する評価値の算出に当たっては,品詞[MATH]の直後に品詞[MATH]が現れる確率[MATH]を与えた表[REF_tab:connect_before_matrix]を利用する.
いま,切り出された形態素[MATH]に対して推定された品詞が[MATH]の[MATH]種類あったとする.
また, [MATH]の後ろに一番近く位置する,完全情報辞書に登録されている形態素が[MATH]であり,その品詞が[MATH]であったとする.
このとき,各品詞[MATH]に対する評価値[MATH]をつぎのようにして求める.
[MATH]が[MATH]の直前にある場合
[MATH]を正規化した値を,評価値[MATH]とする.
[MATH]が他の形態素[MATH]の直前にある場合
ここで, [MATH]は完全情報辞書にない形態素である.
[MATH]に対して推定された品詞が[MATH]であり,その評価値が[MATH]としてすでに計算できているとしよう.
このとき, [MATH]の各品詞[MATH]に対して,つぎの一時値[MATH]を計算する.
この一時値[MATH]を正規化したものを評価値[MATH]とする.
上の計算方法は,帰納的に与えてあることに注意する.
これから, [MATH]と[MATH]の間に,複数の未知の形態素[MATH]が並んでいる場合にも,それぞれの推定された品詞に対する評価値を計算することができる.
しかしながら,形態素候補の切り出し方からして,複数が並ぶ例には,ほどんど出会わない.
「少し[MATH]動き[MATH] そうだ」を例にとって,評価値の計算を示す.
{そうだ}は助動詞であり,そこからの形態素情報推定によって, {動き}は動詞,形容詞, {少し}は名詞,動詞,副詞と品詞が推定されている.
すると, {動き}についての評価値は,表[REF_tab:connect_before_matrix]からつぎのようになる.
動詞: [MATH]
形容詞: [MATH]
{少し}については,まず一時値がつぎのようになる.
名詞: [MATH]
動詞: [MATH]
副詞: [MATH]
これから,評価値は,つぎのように求められる.
名詞: [MATH]
動詞: [MATH]
副詞: [MATH]
形態素情報推定で得られた,形態素とその形態素情報,およびその評価値は,不完全情報辞書に追加登録する(形態素に対する確定マーク,活用に対する除外マークは,無視する.
).
このとき,同じ形態素と形態素情報がすでに登録されているなら,評価値の改定を行う.
その上で,登録された評価値を調べ,十分に高い評価値をもつ形態素と形態素情報は,完全情報辞書に移動する.
逆に,あまりに低い評価値しかもたないものは,不完全情報辞書から削除する.
推定された形態素とその形態素情報が,すでに不完全辞書に登録されている場合には,登録されている評価値[MATH]を,推定から得た評価値[MATH]を用いて計算したつぎの値[MATH]に改定する.
[MATH]
ここで, [MATH]であり,しかも[MATH]かつ[MATH]となることに注意されたい.
実際,
[MATH]
であり, [MATH], [MATH]がそれぞれの評価での「不確かさ」を示す.
したがって,改定した評価値[MATH]での「不確かさ」[MATH]は,その両者の「不確かさ」の積に減少する.
不完全情報辞書に登録された,形態素とその形態素情報に対する評価値が,一定の基準値[MATH]に達した場合には,その形態素と形態素情報の組を完全情報辞書に移動する.
このとき,同じ形態素で,異なる形態素情報と組になったものが不完全情報辞書の中にあれば,それらをすべて削除する.
本システムでは, [MATH]とした.
この値は,少量のデータについて予備実験を行い,システム全体での形態素獲得の成功率がもっとも高くなるように選んだものである.
一方で,システムの辞書保守の効率を高めるためには,評価値が一定の基準値[MATH]に満たない形態素と形態素情報の組を不完全情報辞書から削除したい.
しかしながら,その字種構成などから形態素そのものは確実だと思われるものは残したい.
そこで,形態素切り出しが確定マークをもたないものを追加登録した際に,なお改定評価値が[MATH]に満たない,形態素と形態素属性の組は,不完全情報辞書から削除することにした.
本システムでは, [MATH]とした.
この値は,少量のデータについて予備実験を行い,システム全体での辞書保守の手間が実用的な範囲に収まり,しかも形態素獲得の成功率が高くなるように選定したものである.
