実験方法と評価方法\label{sec:4}
\subsection{実験方法}
図\ref{fig:exp}\,に今回行なった実験の流れを示す．

実験の順序は，実験1→実験2→実験3の順にそれぞれの結果を受けて進める．実験1では，初期質問文と質問の要約文のマッチングを行ない，一致した初期質問文と一致しなかった初期質問文に分け，実験2及び実験3へ振り分ける．「一致」，「不一致」の定義は\ref{sec:4.2}\,項で詳述する．

\begin{figure}[ht]
 \begin{center}
  \epsfile{file=figure/fig3.eps,scale=0.45}
 \end{center}
 \caption{実験の流れ（実験1→実験2→実験3の順）}
 \label{fig:exp}
\end{figure}

実験2では，実験1で一致した初期質問文の成功要因を分析するために，キータームとする条件の変更や文節に含まれるキータームの削除を行なって，再度，質問の要約文とのマッチングを行なう．その結果，実験1では一致していたものが，あるタームを削除することによって不一致となる場合は，削除したタームがマッチングに重要な要素であると考え，マッチングに適切なタームを補うためのルール化を行なう．この方式は，マッチングに成功した要因を分析してルール化を行なうため，サクセスファクタ分析方式と呼び，実験3において検証する． 

実験3では，実験1で不一致となった初期質問文に対して，実験2から得られたタームの補いのルールと，質問の要約文を統計的に分析して得られたルールを用いてタームを補ってマッチングを行ない，実験1で得られるベースライン及び，単純に質問の要約文の先頭語を補ってマッチングを行なった結果と比較する．


\subsection{評価方法} \label{sec:4.2}
質問と応答の要約文へのナビゲーションは，ユーザが満足する結果に導かれれば，そこで問題が解決されるため，一般的な検索で用いる再現率と適合率は評価の尺度として適さない．そこで，初期質問文から作成した検索式を入力として，検索エンジンを用いて質問の要約文とマッチングさせ，元々の質問の要約文(初期質問文を作成する際の元になった質問）が第一位にランキングされたものを「一致」，第二位以下にランキングされたものを「不一致」とした．なお，ランキングは，以下の重み付けを用いた．

\[
 R_i = \sum_{j=1}^{k} \left( \log tf_{ij} \times \log \frac{N}{df_j} \right)
\]

ここで，全$N$件中，$i$番目($1 \leq i \leq N$)の文書の関連度$R_i$は，$k$個の単語の$tf \times idf$の総和で表す．$tf_{ij}$は，$j$番目($1 \leq j \leq k$)のタームの$i$番目の文書内出現回数であり，$df_j$は，$j$番目の単語の全質問の要約文中で出現する質問の要約文の数である．$idf_j$は$N / df_j$で計算している．$tf_{ij}$および$df_j$の$\log$を取っているのは，突出して出現するタームの影響を減らすためである．

また，キータームを補ったり，削ったりすることでマッチングの結果が変わるが，その指標を影響度$I$で表す．

\[
 I = \frac{U}{U+M}
\]

ここで$U$はマッチングの結果，一致から不一致へ，または不一致から一致へ変化した初期質問文の数で，$M$はマッチングの結果が変わらなかった初期質問文の数を表す．


実験と考察\label{sec:5}
まず，実験に用いるツールとデータの規模について述べる．初期質問文を質問の要約文とマッチングさせる検索エンジンは，我々の開発した全文検索エンジン~\cite{matui}を用いた．初期質問文は，JUMAN~\cite{juman}を用いて品詞付きの形態素解析結果を得て，検索に用いるキータームを選定した．キータームとして選定する品詞，及び実験に用いた初期質問文と質問の要約文は，以下の通りである．

\begin{tabular}[t]{ll}
 \\
 \multicolumn{2}{l}{[キータームとすべき品詞]}\\
 ~ & 名詞 未定義語 形容詞 動詞 助動詞(ない) \\
 \\
 \multicolumn{2}{l}{[実験に用いた初期質問文と質問の要約文]}\\
 ~ & 対象とした質問の要約文の種類：無作為に抽出した300種類 \\
 ~ & 初期質問文の数：499個（一つの質問の要約文に複数の初期質問文がある）\\
 ~ & 検索対象となる質問の要約文の数：34,736 個 \\
\end{tabular}

\subsection{実験1：ベースラインの設定}
実験1では，初期質問文と質問の要約文のマッチングを行ない，これをベースラインとする．この実験結果を表\ref{tab:match}\,に示す．初期質問文は元々情報量が少ないので，元の質問の要約文と一致する可能性は低い．この状態が，ユーザが普通に質問文を入力した時にシステムが応答する状態である．一致した初期質問文は，問題が解決したものとし，一致／不一致の数を実験2，実験3の結果と比較する．

\begin{table}[hb]
 \caption{初期質問文と質問の要約文のマッチング結果}
 \label{tab:match}
 \begin{center}
  \begin{tabular}{|l|r|r|} \hline
    & \multicolumn{1}{|c|}{数} & \multicolumn{1}{|c|}{割合} \\ \hline \hline
   一致 & 239 & 47.9\,\% \\ \hline
   不一致 & 260 & 52.1\,\% \\ \hline
   合計 & 499 & 100.0\,\% \\ \hline
  \end{tabular}
 \end{center}
\end{table}


\subsection{実験2：重要タームの要因分析}
実験2では，実験1において質問の要約文とのマッチングで一致した初期質問文に対して，第一にキータームを削除する条件の変更，第二に文節に含まれるキータームの削除を行なって，再度，質問の要約文とのマッチングを行なう．その結果，不一致となるものを調べ，その要因分析（サクセスファクタ分析）を行なう．

第一に，初期質問中のキータームの構文的役割の違いの影響を調べるために，以下の条件でキータームを削除する．この時，削除するキータームの数は同数とする．また，助詞「の」や名詞連続によるタームの比較を行なうため，ここでは，「の」を文節の区切りとしない．名詞と未定義語を併せて名詞類と呼び，文節の最後の名詞類を主辞と呼ぶ．

\begin{tabular}{ll}
\\
\multicolumn{2}{l}{［キータームを削除する条件の変更］}\\
~ & ベースライン：キータームとすべき品詞の形態素すべて（削除するキータームはなし）\\
~ & 修飾語削除（主辞選択）：各文節の主辞以外のキータームを削除し，主辞を選択する．\\
~ & \begin{tabular}{@{}l@{\hspace{0.3zw}}p{0.63\textwidth}@{}}
     主辞削除（修飾語選択）：& 主辞を助詞「の」または名詞連続によって修飾する名詞類があれば主辞を削除し，その代わりに修飾語を選択する．\\
    \end{tabular} \\
 \\
\end{tabular}

例~\ref{ex:keyterm}\,に，初期質問文の形態素解析結果と各条件で削除して残ったキータームの例を示す．

\begin{example}[ht]
 \begin{center}
  \fbox{\small
  \begin{tabular}{ll}
   \multicolumn{2}{l}{[例文] 留守番電話で相手の番号を通知させる方法がわからない．}\\
   \multicolumn{2}{l}{[形態素解析結果]}\\
   ~ & [留守番/電話/で][相手/の/番号/を][通知させ/る/方法/が][わか/ら/ない]．\\
   \multicolumn{2}{l}{[キーターム例]}\\
   ~ & ベースライン： 留守番，電話，相手，番号，通知させ，方法，わか，ない\\
   ~ & 修飾語削除（主辞選択） ： 電話，番号，方法 \\
   ~ & 主辞削除（修飾語選択） ： 留守番，相手，方法 \\
  \end{tabular}
  }
 \end{center}
 \caption{形態素解析結果とキータームの例}
 \label{ex:keyterm}
\end{example}

このように，キータームの種類を変更してマッチングを行なった結果を表~\ref{tab:keymatch}\,に示す．ここで，マイナスの影響度とは，実験1でマッチングが一致していたものがキータームの選択によって不一致となった割合を示す．

\begin{table}[ht]
 \caption{キータームを削除する条件の変更によるマッチング結果}
 \label{tab:keymatch}
 \begin{center}
  \begin{tabular}{|l|r|r|r|} \hline
   & \multicolumn{1}{|c|}{\mrow{ベースライン}} & \multicolumn{1}{|c|}{修飾語削除} & \multicolumn{1}{|c|}{主辞削除} \\
   & & \multicolumn{1}{|c|}{（主辞選択）} & \multicolumn{1}{|c|}{（修飾語選択）} \\ \hline \hline
   一致 → 一致 & 239 & 80 & 112 \\ \hline
   一致 → 不一致 & 0 & 159 & 127 \\ \hline \hline
   合計 & 239 & 239 & 239 \\ \hline
   マイナスの影響度 & & 66.5\,\% & 53.1\,\% \\ \hline
  \end{tabular}
 \end{center}
\end{table}

キータームの数を減らすことにより，不一致となる数が増えるが，修飾語削除は，主辞削除に比べ，マイナスの影響度は13.4\,\%も大きくなり，修飾語はマッチングの精度に重要なキータームであることを示している．

第二に，キータームが存在する文節の種類によってどのような影響があるかを調べるために，代表的な格助詞及び係助詞で終わる文節中のキータームを削除して残ったキータームによってマッチングを行なう．削除する文節は，初期質問文中に30個以上出現するものを選び，以下の通りとする．

\begin{tabular}{ll}
 \\
 \multicolumn{2}{l}{［削除する文節］} \\
 ~ & 「が文節」，「を文節」，「で文節」，「は文節」，「に文節」\\
 \\
\end{tabular}

例\ref{ex:delkey}\,では，各文節を削除した場合の残ったキータームの例を示す．

\begin{example}[ht]
 \begin{center}
  \fbox{\small
  \begin{tabular}{ll}
   \multicolumn{2}{l}{[例文] 留守番電話で相手の番号を通知させる方法がわからない．} \\
   \multicolumn{2}{l}{[形態素解析結果]}\\
   ~ & [留守番/電話/で][相手/の/番号/を][通知させ/る/方法/が][わか/ら/ない]．\\
   \multicolumn{2}{l}{[キーターム例]}\\
   ~ & 「が文節」を除く：留守番，電話，相手，番号，わか，ない \\
   ~ & 「を文節」を除く：留守番，電話，通知させ，方法，わか，ない \\
   ~ & 「で文節」を除く：相手，番号，通知させ，方法，わか，ない \\
   \end{tabular}
  }
 \end{center}
 \caption{文節を削除したキータームの例}
 \label{ex:delkey}
\end{example}


このように，各文節中を削除して残ったキータームによってマッチングを行なった結果を表\ref{tab:delsets}\,に示す．

\begin{table}[ht]
 \caption{文節を削除した影響度}
 \label{tab:delsets}
 \begin{center}
  \begin{tabular}{|l|r|r|r|r|r|r|} \hline
   & ベースライン & が文節 & を文節 & で文節 & に文節 & は文節 \\ \hline \hline
   一致 → 一致 & 239 & 25 & 27 & 25 & 22 & 10 \\ \hline
   一致 → 不一致 & 0 & 76 & 68 & 24 & 32 & 20 \\ \hline \hline
   合計 & 239 & 101 & 95 & 49 & 54 & 30 \\ \hline
   マイナスの影響度 & & 75.2\,\% & 71.6\,\% & 49.0\,\% & 59.3\,\% & 66.7\,\% \\ \hline
  \end{tabular}
 \end{center}
\end{table}

表\ref{tab:delsets}\,から，「が文節」と「を文節」中のキータームを除去するとその影響は最も顕著に現れ，どちらも70\,\%以上の影響度がある．その結果，以下の文節の順にマッチングに重要なキーワードが含まれると考えられる．

\[
 \mbox{「が文節」} > \mbox{「を文節」} > \mbox{「は文節」} > \mbox{「に文節」} > \mbox{「で文節」}
\]

\vspace*{1cm}

\subsection{実験3：タームの補い}

実験3では，実験1において質問の要約文とのマッチングで不一致であった初期質問文に対して，実験2から得られた補いルールと，比較のための単純な補いルールに基づいてキータームを追加して再度質問の要約文とのマッチングを行なう．その結果一致する初期質問文を調べ，その評価を行なう．

\begin{table}[b]
 \caption{サ変名詞と「の」の関係}
 \label{tab:sano}
 \begin{center}
  \begin{tabular}{|l|r|r|r|} \hline
   \multicolumn{1}{|c|}{語句} & \multicolumn{1}{|c|}{頻度} & \multicolumn{1}{|c|}{「の」の左側に出現} & \multicolumn{1}{|c|}{「の」の右側に出現} \\ \hline \hline
   設定 & 722 & 32 & 690 \\ \hline
   表示 & 166 & 9 & 157 \\ \hline
   インストール & 158 & 16 & 142 \\ \hline
   変更 & 144 & 4 & 140 \\ \hline
   接続 & 119 & 18 & 101 \\ \hline \hline
   サ変合計 & 5107 & 862 & 4245 \\ \hline
   割合 & & 16.9\,\% & 83.1\,\% \\ \hline
  \end{tabular}
 \end{center}
 
 \caption{普通名詞と「の」の関係}
 \label{tab:funo}
 \begin{center}
  \begin{tabular}{|l|r|r|r|} \hline
   \multicolumn{1}{|c|}{語句} & \multicolumn{1}{|c|}{頻度} & \multicolumn{1}{|c|}{「の」の左側に出現} & \multicolumn{1}{|c|}{「の」の右側に出現} \\ \hline \hline
   ファイル & 262 & 132 & 130 \\ \hline
   データ & 182 & 75 & 107 \\ \hline
   ハードディスク & 121 & 85 & 36 \\ \hline
   パソコン & 107 & 77 & 30 \\ \hline
   プログラム & 96 & 47 & 49 \\ \hline \hline
   普通合計 & 14181 & 6362 & 7819 \\ \hline
   割合 && 44.9\,\% & 55.1\,\% \\ \hline
  \end{tabular}
 \end{center}

 \caption{固有名詞と「の」の関係}
 \label{tab:kono}
 \begin{center}
  \begin{tabular}{|l|r|r|r|} \hline
   \multicolumn{1}{|c|}{語句} & \multicolumn{1}{|c|}{頻度} & \multicolumn{1}{|c|}{「の」の左側に出現} & \multicolumn{1}{|c|}{「の」の右側に出現} \\ \hline \hline
   Windows95 & 180 & 149 & 20 \\ \hline
   Windows98 & 85 & 76 & 9 \\ \hline
   Windows & 65 & 61 & 4 \\ \hline
   Word & 37 & 35 & 2 \\ \hline
   富士通 & 36 & 35 & 1 \\ \hline \hline
   固有合計 & 1567 & 1405 & 162 \\ \hline
   割合 && 88.9\,\% & 11.1\,\% \\ \hline
  \end{tabular}
 \end{center}
\end{table}


実験1の結果では，5割以上の初期質問文が不一致であった．これらのマッチング精度を高めるためには，実験2の考察で得られたように，主辞だけをキータームとする検索では，問題を解決する知識（蓄積している応答文）にたどり着くことはできず，主辞の修飾語が重要である．そこで，今回は，主辞の周りにいかに適切なタームを補って詳細化するかというポイントに絞り，蓄積した類似質問にナビゲーションできるかどうかを実験で検証することにした．これを対話により効率的に補うためには，システムからどのような問い掛けをするかがタームの補いの方略となる．そのために，初期質問文中のどのタームに着目したらよいかを決め，さらに，着目したタームをどのように詳細化するかを決める必要がある． 

そこで，名詞の種類がタームの詳細化の方法を決定する手がかりになり得るかを調べるために，蓄積された34,736個の文を分析し，「の」による修飾・被修飾の出現頻度5以上のものを数え上げた．典型的な語句の例と合計頻度，及びその割合を表\ref{tab:sano}\,〜\ref{tab:kono}\,に示す．表\ref{tab:sano}\,にはサ変名詞と「の」の関係，表\ref{tab:funo}\,には普通名詞と「の」の関係，表\ref{tab:kono}\,には固有名詞と「の」の関係を示す．

これらの表からわかることは，サ変名詞の場合は，「〜の設定」というように「の」の右側に出現して，サ変名詞自体を意味的に限定するタームの要求が多い．一方，固有名詞の場合は，「富士通の〜」というように，「の」の左側に出現して，固有名詞を詳細化するタームの要求が多い．


これまでの分析から，初期質問文中のどのタームに着目するかを決めるルールとして，以下に示す5つのルールを導出できる．

\begin{enumerate}
 \item 文節が一つの場合は，その文節の主辞に着目する．文節が複数の場合は，検索精度に影響を与える文節の順（表\ref{tab:delsets}\,より「が文節$>$を文節$>$は文節$>$に文節$>$で文節」）に，その文節の主辞となるタームに着目する．
 \item 着目するタームがサ変名詞ならば，そのサ変名詞が右側に出現するようなタームを補う （表\ref{tab:sano}\,より）．
 \item 着目するタームが普通名詞ならば，その普通名詞が右側または左側のどちらかに出現するような両方の可能性を考慮してタームを補う（表\ref{tab:funo}\,より）．
 \item 着目するタームが固有名詞ならば，その固有名詞が左側に出現するようなタームを補う（表\ref{tab:kono}\,より）．
 \item 着目するターム「B」がすでに「AのB」の形で修飾されている場合には，表\ref{tab:AnoB}\,の品詞の組み合わせで着目すべきタームを決定する．例えば，Aがサ変名詞でBが普通名詞の場合，Aは左から修飾される（ルール(2)より）場合があり、Bは左から修飾される場合と、右を修飾する（ルール(3)より）場合がある．ここで，Bは「Aの」によりすでに修飾されているため，左から修飾されることはない．よって着目すべきタームは第一に「A」，第二に「B」となる． 
\end{enumerate}

\begin{table}[ht]
 \caption{「AのB」の場合の着目すべきターム}
 \label{tab:AnoB}
 \begin{center}
  \begin{tabular}{|c|c|c|c|} \hline
   A＼B & サ変名詞 & 普通名詞 & 固有名詞 \\ \hline \hline
   サ変名詞 & A & A，B & A，B \\ \hline
   普通名詞 & A & A，B & A，B \\ \hline
   固有名詞 & なし & B & B \\ \hline
  \end{tabular}
 \end{center}
\end{table}

ルール(1)〜(5)で定めた着目すべきタームに対して新しいタームを補うために，システムからユーザに問いかける句の生成ルールを表\ref{tab:crule}\,に示す．これらのルールを用いて，着目するタームとシステムの問い掛けを決定する．その問い掛けへユーザが返す答えに含まれるタームが一次質問文へ補うタームとなる．

\begin{table}[ht]
 \caption{着目したタームに対しユーザへ問い掛ける句の生成ルール}
 \label{tab:crule}
 \begin{center}
  \begin{tabular}{|c|c|c|c|} \hline
   A＼B & サ変名詞 & 普通名詞 & 固有名詞 \\ \hline \hline
   \mrow{ナシ} & (2) & (3) & (4) \\ \cline{2-4}
   & 「どんなB」 & 「何のB」｜「Bの何」 & 「Bの何」\\ \hline
   \mrow{サ変名詞} & (2)(5) & (2)(3)(5) & (2)(4)(5) \\ \cline{2-4}
   & 「どんなA」 & 「どんなA」｜「Bの何」 & 「どんなA」｜「Bの何」 \\ \hline
   \mrow{普通名詞} & (2)(3)(5) & (3)(5) & (3)(4)(5) \\ \cline{2-4}
    & 「何のA」 & 「何のA」｜「Bの何」 & 「何のA」｜「Bの何」 \\ \hline
   \mrow{固有名詞} & (2)(4)(5) & (3)(4)(5) & (4)(5) \\ \cline{2-4}
    & -- & 「Bの何」 & 「Bの何」 \\ \hline
  \end{tabular}
 \end{center}
\end{table}

表\ref{tab:crule}\,において，上段は適用した着目すべきタームを決定するルールの番号，下段はシステムからの問い掛けを示し，「｜」記号は，どちらの可能性もあることを示す．例えば，ルール(1)で着目する文節が決定されたら，その文節のタームに着目する．そのタームがAのBの形になっていなければ，そのタームをBとして，Bの品詞を表\ref{tab:crule}\,にあてはめる．もしBがサ変名詞であれば，Aが「ナシ」となり，「どんなB」が導かれる．これにより，システムからユーザに「どんなBですか」という問い掛けを返す．また，もし着目するタームがAのBの形になっていて，Aがサ変名詞，Bが普通名詞なら，表\ref{tab:crule}\,から「どんなA」｜「Bの何」が導かれる．これにより，システムからの問い掛けは，「どんなAですか？」または「Bの何ですか？」となり，いずれかの新しいタームの要求を行なうことになる．なお，表\ref{tab:crule}\,では，「の」による修飾の補いが原則であるが，サ変名詞の限定には「どんな〜」を用いた方が自然な問い掛けとなるため，ヒューリスティックなルールとして用いた．

このように作成したシステムからの問い掛けに対して，ユーザが返した答えに含まれるキータームを初期質問文に追加して，二次質問文を作成する．例\ref{ex:2q}\,には，初期質問文に対して表\ref{tab:crule}\,で示したルールを適用し，システムが対話的にキータームを補い，二次質問文に相当するマッチングのための検索式を生成することを想定した例を示す．ここでは，実験1のベースラインのキータームを利用した検索式を生成する． 

\begin{example}[ht]
 \begin{center}
  \fbox{\small
\begin{minipage}{0.8\textwidth}
   \begin{tabular}{lll}
   \multicolumn{3}{l}{[初期質問文] CRT の設定は必要ですか} \\
   ~ & ~ & ⇒[マッチングのキーターム] CRT 設定 必要 \\
   \multicolumn{3}{l}{システム： 「何のCRT ですか」（「設定」は修飾済）}\\
   \multicolumn{3}{l}{ユーザ： 「FMV-5133T3 のCRT です」}\\
   ~ & \multicolumn{2}{l}{→[二次質問文]FMV-5133T3 のCRT の設定は必要ですか}\\
   ~ & ~ & ⇒[マッチングのキーターム] FMV-5133T3 CRT 設定 必要 \\
   \\
   \multicolumn{3}{l}{[初期質問文] 筆まめでエラーが発生する} \\
   ~ & ~ & ⇒[マッチングのキーターム] 筆まめ エラー 発生 \\
   \multicolumn{3}{l}{システム：「何のエラーですか」（が＞で）} \\
   \multicolumn{3}{l}{ユーザ：「住所リストのエラーです」} \\
   ~ & \multicolumn{2}{l}{→[二次質問文]筆まめで住所リストのエラーが発生する} \\
   ~ & ~ & ⇒[マッチングのキーターム] 筆まめ 住所リスト エラー 発生 \\
  \end{tabular}
\end{minipage}
  }
 \end{center}
 \caption{二次質問文の作成例}
 \label{ex:2q}
\end{example}

例\ref{ex:2q}\,で示したような新しい二次質問文から生成される検索式によってマッチングした結果を表\ref{tab:new2q}\,に示す．比較のため，質問の要約文の先頭語を補うという単純な補いルールに基づきキータームの追加を行なってマッチングした結果も表\ref{tab:new2q}\,に併記する．実験の目的は，ユーザが効率的に問題を解決できる知識にたどり着くことであり，対話的にタームを補っていくシステムを想定している．できる限り最適なタームを補うことが，問題解決を早めることに有効に働く．表\ref{tab:new2q}\,では，単純に補った場合も，先頭に来るタームが固有名詞である場合が多いため，ある程度の精度向上は見られるが，これはアドホックな対応である．ルールによって補った結果の影響度が高く，単純にタームを補うよりも効果が得られた．

\begin{table}[ht]
 \caption{新しい二次質問文による検索結果}
 \label{tab:new2q}
 \begin{center}
  \begin{tabular}{|l|r|r|r|} \hline
   & ベースライン & 単純に補い & ルールで補い \\ \hline \hline
   不一致 → 不一致 & 260 & 202 & 147 \\ \hline
   不一致 → 一致 & 0 & 58 & 113 \\ \hline \hline
   合計 & 260 & 260 & 260 \\ \hline
   プラスの影響度 & 0.0\,\% & 22.3\,\% & 43.5\,\% \\ \hline
  \end{tabular}
 \end{center}
\end{table}

