\section{実験}
\label{Sec:実験}

NNBの性能を測りその特色を調べるため，ふたつのコーパスを用いた実験を行った．
一つ目はオークションの商品分類の実験であり，二つ目はニュースグループの文書分類の実験である．
これらの二つの実験において，形態素解析により得た表層形のbag-of-wordsを用いてNB，CNB，NNBの文書分類の性能を比較した．
また，NBBとCNBの差は事前確率$P(c)$と$ \frac{1}{1-P(c)}$の部分であるため，CNBとNNBから第一項を省略した形の式（$P(c)$なしのCNB）でも実験を行った．

なお，形態素解析ソフトにはMeCab\footnote{http://mecab.sourceforge.net/}を利用した．

また，スムージング手法としては，予備実験によりラプラススムージング\cite{ラプラス,ラプラス2}とJeffreys Perks法\cite{JeffreysPerks}を
試し，Jeffreys Perks法の方が結果がよかったため，これを採用した．

さらに，Bayesではない手法の比較対象として，SVMについても実験を行った．
この際，分類器としてはマルチクラス対応のSVM (libsvm\footnote{http://www.csie.ntu.edu.tw/{\textasciitilde}cjlin/libsvm/}) を使用した．
カーネルは予備実験の結果，線形カーネルが最も高い正解率を示したため，これを採用した．
また，学習の素性はBayesの手法とそろえ，表層形のbag-of-wordsの頻度ベクトルを使用した．すべての実験には五分割交差検定を用いた．


\subsection{オークションの商品分類の実験}
\label{Sec:オークションの商品分類の実験}

オークションの商品分類の実験は，
Yahoo! オークション\footnote{http://auctions.yahoo.co.jp/}の商品タイトルを商品カテゴリに分類する実験である．
詳細は\citeA{佐藤}にならった．

本実験では，「デスクトップ」「記念切手」「赤ちゃん用の玩具」の
三つのジャンルカテゴリ\footnote{オークション $>$ コンピュータ $>$ パソコン $>$ Windows $>$ デスクトップの例では，「デスクトップ」だけでなく，「コンピュータ」や「パソコン」，「Windows」もジャンルカテゴリであるが，本実験ではデータサイズの観点から「デスクトップ」を対象として実験を行った．}
に含まれる商品を対象に実験を行った．
これらのジャンルカテゴリは，以下のようにトップカテゴリ（オークション）から絞り込むことができる．
\begin{itemize}
 \item オークション $>$ コンピュータ $>$ パソコン $>$ Windows $>$ デスクトップ
 \item オークション $>$ アンティーク，コレクション $>$ 切手，官製はがき $>$ 日本 $>$ 特殊切手，記念切手
 \item オークション $>$ おもちゃ，ゲーム $>$ ベビー用
\end{itemize}
ここで，$>$の左が親カテゴリ，右が子カテゴリを示す．
「デスクトップ」と「記念切手」は2012年6月26日に，「赤ちゃん用の玩具」は2012年6月29日に取得したデータである．
ひとつの商品はひとつの葉カテゴリにのみ属しているものとし，
出品者によって登録されたカテゴリを正しいカテゴリとして実験を行った．
なお，例えばジャンルカテゴリが「デスクトップ」の場合，「ASUSの1,000円〜1,099円」や「IBMパソコン単体31,000円〜34,999円」といったものが葉カテゴリである．
また，\citeA{佐藤}にならい，出品者個人による商品情報表記の癖などの偏りをなくすため，各カテゴリにつき 1 人
の出品者の商品は 1 つしか使用しないものとし，商品タイトルの全単語を利用した実験と名詞のみを使用した二つの実験を行った．

\begin{table}[b]
\hangcaption{それぞれのジャンルカテゴリ中の葉カテゴリ数，同じ出品者による商品をひとつにする前と後の商品数}
\label{Tab:同じ出品者による商品をひとつにする前と後の商品数}
\input{04table01.txt}
\end{table}

\tabref{Tab:同じ出品者による商品をひとつにする前と後の商品数}に
それぞれのジャンルカテゴリ中の葉カテゴリ数，同じ出品者による商品をひとつにする前と後の商品数を示す．
ここで，商品数（処理前），商品数（処理後）はそれぞれ，同じ出品者による商品をひとつにする前と後の商品数である．
なお，「赤ちゃん用の玩具」の商品数（処理後）には8205，8204と二つ数字があるが，8205は全ての品詞の分類，8204は名詞のみの分類による商品数を示している．
「赤ちゃん用の玩具」のデータには，形態素解析の結果，全ての形態素が名詞以外の品詞に割りつけられた商品が1件あったため，このような結果になっている．

\begin{figure}[b]
\begin{center}
\includegraphics{20-2ia4f2.eps}
\end{center}
\caption{「デスクトップ」のカテゴリごとの文書数，単語トークン数，名詞のトークン数}
\label{Fig:pc}
\end{figure}
\begin{figure}[b]
\begin{center}
\includegraphics{20-2ia4f3.eps}
\end{center}
\caption{「記念切手」のカテゴリごとの文書数，単語トークン数，名詞のトークン数}
\label{Fig:stamp}
\end{figure}

また，\figref{Fig:pc}，\figref{Fig:stamp}，\figref{Fig:toy}に
それぞれ「デスクトップ」，「記念切手」，「赤ちゃん用の玩具」のカテゴリごとの文書数，単語トークン数，名詞のトークン数を
折れ線グラフにしたものを示す．横軸のカテゴリindexは，カテゴリを文書数で並べ替えたときに降順につけたものである．
これらの図から，カテゴリの分類実験において，カテゴリごとに文書数，トークン数が非常に
偏っていることが分かる．特に，「記念切手」が最も偏っていることが読みとれる．

\begin{figure}[t]
\begin{center}
\includegraphics{20-2ia4f4.eps}
\end{center}
\caption{「赤ちゃん用の玩具」のカテゴリごとの文書数，単語トークン数，名詞のトークン数}
\label{Fig:toy}
\end{figure}
\begin{table}[t]
\hangcaption{オークションのカテゴリ分類実験の訓練事例中の商品数の標準偏差，標準偏差／平均，トークン数，1商品当たりの平均単語数}
\label{Tab:オークションのカテゴリ分類実験のデータ}
\input{04table02.txt}
\end{table}


また，\tabref{Tab:オークションのカテゴリ分類実験のデータ}に
オークションのカテゴリ分類実験の訓練事例中の商品数の標準偏差，訓練事例中の文書数の標準偏差を訓練事例中の総文書数の平均で割った値（以降，標準偏差／平均と表記），
トークン数，1商品当たりの平均単語数を示す．
標準偏差／平均は，カテゴリ（またはクラス）ごとの商品数（または文書数）のばらつきを見るために示した．
ばらつきを測るのには標準偏差を用いるのが一般的であるが，本実験のように全商品数（または文書数）が異なる実験設定同士を比べる際には，全商品数（文書数）の
絶対値が大きくなるにつれて標準偏差も大きくなるという問題があったためである\footnote{例えば，1，2，3，4，5の五つの値の標準偏差は約1.58になるが，0.1，0.2，0.3，0.4，0.5の五つの値の標準偏差は約0.158になる．}．
標準偏差を平均で割ることによって，全商品数（文書数）のスケールに左右されないデータのばらつきを測った．
\tabref{Tab:オークションのカテゴリ分類実験のデータ}のこの「訓練事例中の商品数の標準偏差／平均」を見てみると，
「記念切手」の値が「デスクトップ」や「赤ちゃん用の玩具」より高いことから，
\figref{Fig:pc}〜\figref{Fig:toy}から読みとったように，「記念切手」が最も偏っていることが読みとれる．


\subsection{ニュースグループの文書分類の実験}
\label{Sec:ニュースグループの文書分類の実験}

ニュースグループの文書分類の実験の
コーパスには20 Newsgroups\footnote{http://people.csail.mit.edu/jrennie/20Newsgroups/}を利用した．20 Newsgroupsは，全20クラス，18774件のニュース記事からコーパスが構成されており，
文書数はどのクラスもおよそ1000件である(cf.~\tabref{Tab:クラスごとの文書数を不均一にした実験のクラスごとの文書数})．

\begin{table}[b]
\caption{クラスごとの文書数を不均一にした実験のクラスごとの文書数}
\label{Tab:クラスごとの文書数を不均一にした実験のクラスごとの文書数}
\input{04table03.txt}
\end{table}


\subsubsection{一文書あたりの単語数を減らした実験}

CNBとNNBの式，式 (\ref{eq:cnb}) と式 (\ref{eq:nnb2}) を比較してみると，事前確率$P(c)$と$ \frac{1}{1-P(c)}$の部分が異なっていることが分かる．
残りの$\prod_{i=1}^{n} \frac{1}{P(w_i|\bar{c})}$については等しい．
しかし，単語数が少ない文書を分類する際には，単語数が多い文書を分類する際よりも，相対的に事前確率の影響が大きくなることが予想される．
そのため，一文書あたりの単語数を減らして実験を行い，その分類正解率を比較する．
この際，一文書あたりの単語数を$n$とし，パラメータを$x$とすると，一文書あたりの単語数を$n/2^{x}$（ただし割り切れない場合には1を加算する）として実験した．
パラメータ$x$は，0〜4を試した．$x$が0のときには，オリジナルの20 Newsgroupsと等しい．

ニュースグループの分類実験において一文書あたりの単語数を減らした実験の訓練事例中の単語数，1文書当たりの平均の単語トークン数を
\tabref{Tab:一文書あたりの単語数を減らした実験のデータ}に示す．なお，このとき訓練事例中の総文書数はすべて18,774であり，
訓練事例中の文書数の標準偏差はすべて95.95である．また，訓練事例中の文書数の標準偏差／平均は0.10になる．



\subsubsection{クラスごとの文書数を不均一にした実験}

NNBは事前確率を数学的に正しく考慮しているため，文書分類ではクラスごとの文書数が不均一である際に効果を発揮すると考えられる．
そのため，20 Newsgroupsにおいて，クラスごとに文書を間引きすることによって，クラスごとの文書数を不均一にして
実験を行い，比較する．
この際，クラスのインデックスを$i=1...20$，パラメータを$y$とすると，$i=1$ だけは常にオリジナルの文書数を保ったままとし，$i=2$から文書数を
$1/((i-1)y)$に減らして実験を行った．例えば，$y=1$のときには，$i=2，3，4$の時にはそれぞれ$1/1，1/2，1/3$となり，
$y=2$のときには，$i=2，3，4$の時にはそれぞれ$1/2，1/4，1/6$となる．パラメータ$y$は，1〜4を試した．

\begin{table}[b]
\hangcaption{ニュースグループの分類実験において一文書あたりの単語数を減らした実験の訓練事例中の単語トークン数，1文書当たりの平均の単語トークン数}
\label{Tab:一文書あたりの単語数を減らした実験のデータ}
\input{04table04.txt}
\end{table}
\begin{table}[b]
\hangcaption{ニュースグループの分類実験においてクラスごとの文書数を不均一にした実験の訓練事例中の総文書数，文書数の標準偏差，標準偏差／平均，単語トークン数，1文書当たりの平均の単語トークン数}
\label{Tab:クラスごとの文書数を不均一にした実験のデータ}
\input{04table05.txt}
\end{table}

\tabref{Tab:クラスごとの文書数を不均一にした実験のクラスごとの文書数}に，クラスごとの文書数を不均一にした実験のクラスごとの文書数を
示す．また，\tabref{Tab:一文書あたりの単語数を減らした実験のデータ}に
ニュースグループの分類実験においてクラスごとの文書数を不均一にした実験の訓練事例中の総文書数，文書数の標準偏差，標準偏差／平均，単語トークン数，1文書当たりの平均の単語トークン数
を示す．また，ニュースグループの分類実験においてクラスごとの文書数を不均一にした実験の訓練事例中の総文書数，文書数の標準偏差，標準偏差／平均，単語トークン数，1文書当たりの平均の単語トークン数を
\tabref{Tab:クラスごとの文書数を不均一にした実験のデータ}に示す．


