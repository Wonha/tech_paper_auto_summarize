データ構造
\label{data-str}

構文解析で使用する言語リソースのデータ構造についてその定義を与える．第１は，
係り受け関係の表現ための構文木，第２は，係り受け関係の基本データ構造である縮
退型共起関係である．

\subsection{構文木}

日本語の係り受けを解析することをここでは構文解析ともいう．解析結果を与
える構文は，工学的観点にたって見やすく工夫している．
図\ref{構文解析結果の表示例}にその例を示す．
各文節は順序番号を付与して係り先の文節番号
と係り受け関係を明示しグラフで表示している．文節は長い文節にも対応でき
るように縦に配置している．文節の先頭の品詞も明示している．詳細は省くが，
このグラフ表示に対して形態素，構文レベルの修正が可能である．修正機能は
１００％正解が困難な現状の自然言語処理にとって有用な支援機能である．グ
ラフの上段は形態素解析の結果を示している．

\begin{figure}[htb]
\begin{center}
\epsfile{file=fig1.eps,width=119mm}

\caption{構文解析結果の表示例} \label{構文解析結果の表示例}
\end{center}
\end{figure}

\subsection{係り受けの連続性}

文中で連続した文節が係り受けの関係になっている場合，その係り受けの２文節は「
連続」あるいは「連続句」であるという．文中で離れた文節間で係り受け関係があれ
ば「不連続」という．日本語においては特定の係り受け関係は連続して生ずるケース
が見られ，これに注目するため連続，不連続を区別している．

連続，不連続を付与した係り受け関係においては，連続して用いられる度合の強い係
り受け関係は解析において単語に次ぐ重要な言語リソースで，辞書の見出しを単語か
ら句に拡大するとき最初にエントリの候補となるものである．

\subsection{縮退型共起関係}

縮退型共起関係では，文節の自立語列はヘッドとなる最終の自立語の品詞で，付
属語列はリテラルとしてそのままの文字列で表現される．句読点も
付属語列に含める．係り受け関係は例えば\cite{YamagamiAndYasuhara1993}に
示したような係り受け関係名で記述する．単に係り受けの関係だけを解析する
のであれば関係名は係り側の付属語列で代用するか，あるいはまったく無視し
ても本処理系には影響を与えない．図\ref{データ構造}に縮退型共起関係のデー
タ構造とその例を示す．
\vspace*{5mm}

\begin{figure} [htb]
\begin{center}
\epsfile{file=fig2.eps,width=131mm}
\caption{縮退型共起関係のデータ構造とその例} \label{データ構造}
\end{center}
\end{figure}

大文字Ａ，Ｂは自立語品詞，Ｆは付属語品詞列，小文字ａ，ｂは自立語リテラル，ｆ
は付属語列のリテラルを表わすとすると，一般に共起関係を構文規則として見て，
抽象化の強いものから並べると次の４種類に分類される．１）ＡＦＢＦ型，２）Ａｆ
Ｂｆ型，３）Ａｆｂｆ型あるいはａｆＢｆ型，４）ａｆｂｆ型である．２），３），
４）のように具体的に記述するにしたがって共起関係の数は増大する．通常の構文規
則は１）のレベルで記述するのが一般的である．

縮退型共起関係は２）の型に属し，その特徴は文節の自立語を品詞で代用しているこ
とと受け側の付属語も添付していることである．付属語は付属語相当語を含めて現在
６５０語を用いているがオーダ的には組み合わせや句読点を考慮して１０００程度で
あり，リテラルとした．自立語は１０万のオーダになりそれらをすべて記憶しておく
ことは２項関係としては動詞が１万とすると名詞と動詞の組み合わせだけでギガのオ
ーダであり，付属語パターンも含めると現状の機械処理の立場からは困難である．こ
れは\cite{Yoshida1972}でも示された考え方であった．

本論文では，付属語列の末尾に句読点情報も付与している．なぜなら，現実の文章に
おいては，句読点が係り受け関係の決定に意味を持っているからである．これの有効
性は従属節の述語間の係り受けに対して\cite{Shirai1995}でも示されている．

係り受け関係で受け側の付属語列を伴ったＡｆＢｆ型が重要なことは，ＡｆＢでは次
にどのような付属語列が来るかはＢのみの品詞情報で決定され，文節Ａの付属語列は
関与しないことによる．しかし文法的には等価であるが慣用的な用法が多い自然言語
では，特定の付属語を好む場合がある．例えば，文「\underline{欧米においては}電
車で寝ているような光景は決して\underline{見られないが，}」で，「欧米において
は」は動詞に係るというだけの情報では，この文の場合「寝ている」に係るとしてし
まうことになる．ＡｆＢｆ型にするとＢに付属語「〜ないが，」が付くパターンを優
先して使用することができる．もっと単純な場合では，「Ｎ（名詞）はＡ（形容詞）
」の規則で，「彼は若い．」と「彼は長い（トンネルを）」を同じと見てしまう．し
かしＢにｆを付与すると「．」が効力を持つ．もちろん組み合わせの数はＡｆＢｆ型
がＡｆＢ型より３桁多くなるが，係り受けの絞り込みは良くなる．

付属語列をリテラルにしておくメリットは，「男は車に\underline{近づいた．}」の
縮退型共起関係である「ＮはＶ\underline{た．}」\hspace*{-1mm}により「男は近づいた車を見た．
」\hspace*{-1mm}の文で「男は」\hspace*{-1mm}は\hspace*{-1mm}「近づい\underline{た}」\hspace*{-1mm}ではなく\hspace*{-1mm}「見\underline{た．}」\\に係
る．また「女は赤い服を着た．」で，「女は」は「赤い」に係らないで「着た．」に
係っている．「Ｎ\underline{助詞}Ａ」といったＡＦＢ型の共起記述では「女は」は
「赤い」に係ってしまう．もちろん自立語で品詞を使用することによって「髪が長い
少女に会った．」の類に関しては「ＮがＡ」の規則が生まれて上記の文の解析を誤ら
しめて良くないがこれは頻度情報や後述する学習機能によって避けられると考えてい
る．別の解決法は名詞の品詞を細分類したり，\cite{Shirai1986}のようにクラスタ
ー分割することが一つの解決策であるが，本論文では単純な方法を採用した．

縮退型共起関係と連続句の概念によって解析の曖昧性は次のように解消できる．
\cite{Yoshida1972}では，「彼は山に登って景色を見た．」に対して３つの解析例が
ある
としているが，連続句を優先すれば「山に」は「登って」に係り，縮退型共起関係「
ＮはＶて」が無いか，あるいは在っても「ＮはＶた．」に比較して頻度が少なければ
「彼は」は「見た．」に係かる．

\subsection{共起データベース}

共起データベースCOODBとは，係り受け解析の出力から得られる縮退型共起関
係を蓄積したデータベースである．但し，頻度は１であるので記憶していない．
各レコードは，縮退型共起関係からなっている．それらを文に対応させて記憶
することにより，任意の縮退型共起関係から逆にそれが使用された原文を参照
することが可能になる．これにより与えられた縮退型共起関係が正しいかどう
かの判断を実例文で確認することができる．図\ref{COODBの例}に共起データ
ベースの例を示す．共起データベース中の縮退型共起関係をソートして頻度を
付与したものをソート済み共起データベースSTCDBと呼ぶ．
\vspace*{3mm}

\begin{figure} [htb]
\begin{center}
\epsfile{file=fig3.eps,width=101mm}
\caption{縮退型共起関係データベースCOODBの例}
\label{COODBの例}
\end{center}
\end{figure}

新解析系
\label{new-ana}

\subsection{係り受け文法の定式化}

ＡｆＢｆ型の係り受け関係を形式化するとCFGと等価なことが分かる．さらに
図\ref{データ構造}でも示したように係り受け関係には頻度や確率が付与されるた
め確率付
きCFGと見なすことも可能である．文節の文法カテゴリをγＢf，δＢf等で表わすと
一般の係り受け関係は，
\begin{eqnarray}
δＢg　 ＝     γＢf　    γＢg
\label{cc}
\\
δＢg　 ＝     δＢf　    γＢg
\label{dc}
\\
δＢg　 ＝     γＢf　    δＢg
\label{cd}
\\
δＢg　 ＝     δＢf　    δＢg
\label{dd}
\end{eqnarray}
で表現することが出来る．ここで，γは規則が最初に適用される文節カテゴリに付与
しており，δは１度以上規則を適用してできたカテゴリである．カテゴリの添え字γ
，δは，意味的には連続，不連続と関係させたものである．連続のものは規則が適用
されると文節間にギャップができるため左辺のカテゴリにはγは現われない．またＢ
は品詞，ｆは付属語リテラルに相当する．~(\ref{cc})の右辺の”γＢf　γＢg”は
文節カテゴリγＢfがγＢgに連続して係ることを示す．
（例．机を＝＞運ぶ．）~(\ref{dc})の意味はδＢfがγＢgに連続して係ることを表
わしている．（例．（大きな
＝＞）少年の＝＞頭には）~(\ref{cd})はγＢfが不連続にδＢgに係る．（例．少年
が〜＞（机を＝＞）運ぶ）~(\ref{dd})はδＢfが不連続にδＢgに係ることを示して
いる．（例．（大きな＝＞）少年が〜＞（机を＝＞）運ぶ．）ここで＝＞は連続した
係り受け関係を表わし，〜＞は不連続の係り受け関係を意味している．
以上の~(\ref{cc})，~(\ref{dc})の規則は連続フラグが立っている縮退型共起関係
から生成され，
~(\ref{cd})，~(\ref{dd})
は不連続な縮退型共起関係から生成したものである．もう少し緩い規則として連続，
不連続のいずれも上記４つの規則に展開しておくことを考えてもよい．なぜなら，一
般に日本語においては連続した共起関係は不連続でも発生し得るし，逆も可能である
からである．いずれにしてもSTCDBをチョムスキー標準形のCFG規則に変換すること
が出来る．しかしこれは従来のCFGの規則数と比較してオーダの違った規則群になる
．解析するのは原理的にCYK法のようなボトムアップ解析によれば可能である．その
場合，係り受けの交差も自動的に回避できる．ここでは全解パージングではなくコス
ト等を導入して最尤解を求めるために\ref{ana-sys}に述べるような独自な系を作成し
た．

\subsection{解析系}
\label{ana-sys}

以下で縮退型共起関係を用いた解析系を記述する．
\begin{itemize}
\item[(1)] システム構成

縮退型共起関係を用いた解析システムの構成を図\ref{システム構成}に示す．

\begin{figure} [htb]
\begin{center}
\epsfile{file=fig4.eps,width=113mm}
\caption{係り受け解析システム構成}
\label{システム構成}
\end{center}
\end{figure}

本システムで使用する特徴的な言語リソースを以下に示す．いわゆる解析規則はなく
，共起関係データベースがその代りになっている．共起関係データベースはフィード
バック系になっている．

\clearpage

\begin{itemize}
\item[(a)] 係り受けマトリックス

\begin{figure} [htb]
\begin{center}
\epsfile{file=fig5.eps,width=106mm}
\caption{係り受けマトリックス}
\label{マトリックス}
\end{center}
\end{figure}
\vspace*{-2mm}

これは，\cite{Yoshida1972}でも与えられているが，
本論文では図\ref{マトリックス}に示すように行列要素の値を係り受けの可否では
なくコストで与え
る点とさらにそれらの関係名を記述する点で相違する．

\item[(b)]ソート済み縮退型共起関係データベースの作成

COODB，STCDBともに初期状態は空である．先ず実際の文章からCOODBを収集し，ソー
トして重複頻度付きの形式でSTCDBを作成する．係り受け解析の結果は共起関係で表
現できるから，先ず何らかの手段で解析データを収集する．人手でやるのも可能だが
量的に限界がある．解析の結果に対して機械的に収集すればよい．すなわち解析その
ものに共起関係を利用することが最終目標であるが，そのためのデータ収集は，人手
で解析されたデータや別の解析ツールを使用することができる．これによって本解析
エンジンで最低限度の解析ができる程度の容量になるまで蓄積する．今回は，本解析
方式（図\ref{システム構成}中の日本語係り受け解析２）とは別の解析システム（日
本語係り受け解析１）を用いてCOODBの自動抽出ツールを作成した．STCDBのデータ構
造はＢ木や配列として記憶しておく．解析エンジンが始動してそこからデータを収集
すればブートストラップになる．
\end{itemize}
\item[(2)]解析ステップ

以下，解析のステップを順に述べる．
先ず，システムは形態素解析を行い，文節に区切られた結果を構文解析に渡す．構文
解析では係り受けマトリックスをSTCDBを用いて作成する．その後，文頭の文節から
順にその係り先を係り受けマトリックスを用いて非交差条件を守りながらコストの低
いものを優先して決定する．したがって係り先の文節はコストが同じなら距離が近い
ものほど優先することになる．連続する共起関係は，学習で選んだものを除いて最も
コストを低くしている．最終的に最小コストの係り受け関係を一つだけ出力する．

コストを例えば１から６に設定すると，１は最小コストで６が最大コストになる．後
述する学習した共起関係のコストは１とし，連続する共起関係は２，不連続は頻度に
よって３から５とし，疑わしい共起関係は６とする．データ量が多くなり飽和してく
れば頻度の代りに確率を使うことも考えられるが，現状は１文づつの更新で常時頻度
が変化しているため確率や頻度計算をすることは避け，連続，不連続だけで選択して
いる．

\item[(3)]更新機能および学習機能

本方式による係り受け解析は１００％の正確さではない．従ってユーザには，
失敗に対して，係り先や係り受け関係を修正する機能が提供されている．
\ref{data-str}章で述べたように係り受け解析の結果はグラフ表示が出来るた
めユーザは任意の係り受け関係を画面上で係り元，係り先および関係名を番号
で指示することにより修正することができる．

係り受け関係を修正すると，縮退型共起関係の４種類の更新機能を聞いてくる．ユー
ザはいずれかを選択する．具体的には，１）何もしない．２）現在の共起関係自身が
間違っている疑いがある．３）修正結果は新規の共起関係としてSTCDBに登録する．
および４）学習機能である．２）の場合は直接削除することはやめて，疑問符を付け
ておき，コストも最大にする．後日，COODB等を用いて適否を検討するようにしてい
る．４）の学習機能は係り先を変更したり，古い係り受け関係を新しい関係で置き換
えることによって起動し，古い関係はコストを高めることにより優先度を下げ，当該
共起関係の選択を抑止するようにする．同時に新しく指定した共起関係に対しては~
図\ref{データ構造}（ａ）に示した学習フラグをセットして最小のコストを付与す
る．頻度を高めていく方法もあるが，学習効果を即時に得るためこの方法を採用した
．１文の解析が終了するとこの文で指示されたSTCDBに対する上述の共起関係の追加
，修正および学習が実行される．

以上のステップから，更新機能によってインクリメンタルにSTCDBが拡大して
いくとともに学習機能によって優先順位が更新され最近の選択結果を優先する
ことが可能になる．同じ構文をこの後に実行すると優先順位に逆転が起こり，
正しい係り受け解析が得られる．

\begin{figure} [htb]
\begin{center}
\epsfile{file=fig6.eps,width=137mm,height=90.5mm}
\caption{学習の例}
\label{学習}
\end{center}
\end{figure}

図\ref{学習}に学習例を示す．構文解析が学習によって適応規則を変更してい
くため，インタラクティブな環境ではワープロのカナ漢字変換に似た学習効果
が得られる．学習・更新効果の評価は別の機会にゆずるが，一般的に述べると
本方式の特徴は付属語リテラルのパターンを用いることにある．「ですます調」
とか「だ文」とかの文体あるいは「〜ですか」のような会話文独特の表現はい
ずれも付属語が文体を代表しており効果が現われやすい．
\end{itemize}

