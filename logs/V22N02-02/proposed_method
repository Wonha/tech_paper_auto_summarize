レシピ用語タグセットの定義
\label{nestd}

\ref{rw_ner}節で述べたとおり，
レシピテキストのように，新聞とは異なる利用目的をもつ言語資源を取り扱う場合，
一般的な固有表現の定義は有用ではない．
そこで
我々はレシピを用いて調理を行う際に必要となるレシピ用語を分類，定義した．
本節で述べるレシピ用語の一部は先行研究
\cite{Structural.Analysis.of.Cooking.Preparation.Steps.in.Japanese}
で用いられていた表現分類を踏襲しているが，
コーパス構築を行う過程で，先行研究における分類だけではカバーできないと判断した
レシピ中の重要表現を新しく定義し，追加した．
レシピ用語タグの一覧を表\ref{tab_NEtag}に示す．
実際のコーパス構築においては各単語にIOB2タグ（\ref{rw_ner}節参照）を
付与するという形でCOOKPAD\footnote{http://cookpad.com}が公開しているレシピの中
から
無作為抽出で選択した
436レシピにアノテーションを行った．
構築したコーパスの詳細を表\ref{table_corpus}に示す．
なお，後述する評価実験では
コーパスを学習・テストに分割して実験を行うため，
表~\ref{table_corpus}には分割後の詳細を示している．
また，アノテーションを行ったコーパス中の
レシピ用語タグ付与数の分布，ならびにタグごとの平均単語長と最大単語長を
表\ref{tab_dist}に示す．
以下では，8種類のレシピ用語タグについて個別に例を挙げながら述べる．
なお，本節以降では簡単の為IOB2タグ形式を用いた表記ではなく，「例） /パイ 生地/F を /焼/Ac く」のように，
「/単語列/レシピ用語タグ名」の形式でレシピ用語タグの範囲を示し，例文を記述する．

\begin{table}[t]
\caption{レシピ用語タグ一覧}
\label{tab_NEtag}
\input{02table01.txt}
\end{table}
\begin{table}[t]
  \caption{レシピ用語タグ付与コーパス}
  \label{table_corpus}
\input{02table02.txt}
\end{table}
\begin{table}[t]
\caption{付与したレシピ用語タグの統計}
\label{tab_dist}
\input{02table03.txt}
\end{table}


\subsection{F: 食材}

レシピテキストにおいては調理対象である食材，ならびに調理を行うための道具が主な人工物
として記述される．中でも食材
は調理における動作の目的語，食材の変化や状態の遷移の主語となるため，レシピに記述さ 
れた手続きの要素として過不足無く抽出されることが望ましい．
また，レシピにおいては，中間食材や食材の集合を番号や記号・代名詞によって表現する事例が
多い．以上を踏まえ，以下に挙げる単語列を『F: 食材』と定義した．
\begin{description}
 \item [食材]\mbox{}\\
	     例） {\bf /チーズ/F}\\
	     例） {\bf /ごま 油/F}
 \item [中間食材]\mbox{}\\
	     例） {\bf /生地/F}\\
	     例） {\bf /サルサ ソース/F}
 \item [食材の一部]\mbox{}\\
	     例） {\bf /じゃがいも/F} の {\bf /皮/F}\\
	     例） {\bf /水分/F} を /切/Ac る
 \item [調理の完成品]\mbox{}\\
	     例） {\bf /卵焼き/F}\\
	     例） {\bf /チーズ ケーキ/F}
 \item [記号・代名詞]\mbox{}\\
	     例） {\bf /1/F} を /フライパン/T に /流し入れ/Ac る\\
	     例） お /鍋/T の {\bf /中身/F} が /ぐつぐつ/Af し て き た ら
 \item [商品名]\mbox{}\\
	     例） {\bf /とろけ る チーズ/F}\\
	     例） {\bf /薄切り ベーコン/F}
\end{description}


\subsection{T: 道具}

鍋，蓋，包丁，コンロなど，調理道具や器等を道具表現とする．
手や指などの体の一部も道具表現になる場合がある．
食せない，量が変化しない点以外は『F: 食材』のルールを踏襲する．

\quad \noindent 例） /3 分/D {\bf /レンジ/T} を /し/Ac て から

ただし，「『T: 道具』（する）」という表現は，後述する『Ac: 調理者の動作』となりうる．
この場合には，『Ac: 調理者の動作』のアノテーションを優先する．

\quad \noindent 例） /3 分/D /レンジ/Ac する

以下に示す「弱火」の例では
「コンロ」「鍋」といった調理に必要な道具が明示されていないが，
実際の調理ではそのような道具を用いて
調理する意味を含んでいるため，道具とする．

\quad \noindent 例） {\bf /弱火/T} で /煮/Ac る

以下の「水」や「手」も道具とする．

\quad \noindent 例） {\bf /水/T} で /洗/Ac って

\quad \noindent 例） {\bf /手/T} で /洗/Ac って


\subsection{Ac: 調理者の動作 / Af: 食材の変化}

『Ac: 調理者の動作』は調理者を主語にとって調理者が行う動作を示す用言であり，
『Af: 食材の変化』は『F: 食材』を主語として食材の変化を示す用言である．
『Ac: 調理者の動作』と『Af: 食材の変化』は異なるレシピ用語として定義されるが，
アノテーションの際には両者を混同しやすい事例が頻出するため，本項でまとめて例を述べる．
いずれも，同一性判定を容易にするために，活用語尾を含めない．
動作を修飾する，「よく」「ざっくり」などの副詞表現も，同様の理由により
レシピ用語
としない．

調理者が行う動作を示す用言を『Ac: 調理者の動作』とする．

\quad \noindent 例） /フライパン/T を {\bf /温め/Ac} る

『F: 食材』を主語としてその変化を示す用言を『Af: 食材の変化』とする．

\quad \noindent 例） {\bf /沸騰/Af} し 始め た ら

使役・否定の助動詞を伴う場合のみ，これらの助動詞語幹までを含めて
『Ac: 調理者の動作』とする．
受動の助動詞を伴う場合，主語が『F: 食材』であれば実際には調理者を主語として
『F: 食材』を対象とした調理行動を行っているとし，『使役，否定』の場合と同様に
助動詞語幹までを含め『Ac: 調理者の動作』とする．
なお，本論文でタグ付与の対象としたレシピテキストにおいて『F: 食材』を主語とした受動態の
事例は確認されなかったため，以下では使役・否定の事例のみを挙げる．

\quad \noindent 例） {\bf /沸騰 さ せ/Ac} た ら

\quad \noindent 例） {\bf /沸騰 し な/Af} い よう に

目的語など格助詞で示される「項」を含めない．

\quad \noindent 例） /皮/F を {\bf /む/Ac} い て

複合動詞は全体を調理動作とする．

\quad \noindent 例） {\bf /ふる/Ac} っ て お い た /薄力 粉/F  を {\bf /振る い いれ/Ac}

開始や完了などをあらわす補助的な動詞は含まない．

\quad \noindent 例） {\bf /煮込/Ac} ん で い く

\quad \noindent 例） {\bf /煮た/Af} っ て く る

動詞派生名詞やサ変名詞などの事態性名詞も動作とする．

\quad \noindent 例） /ねぎ/F を {\bf /みじん切り/Ac} する．

\quad \noindent 例） /ねぎ/F を /みじん切り/Sf に {\bf /する/Ac} ．

『F: 食材』で述べたように，商品名など，実際に行わない用言は『F: 食材』に含める．

\quad \noindent 例） /とろけ る チーズ/F

\quad \noindent 例） {\bf /水溶き/Ac} /片栗粉/F


\subsection{Sf: 食材の様態}

レシピテキストでは，調理の進行度合いや食材の変化を伝えるために個々の時点
における食材の様態が記述される．
『Ac: 調理者の動作』や『Af: 食材の変化』の影響によって食材が変化する（した）状態を表す
表現を『Sf: 食材の様態』とする．

\quad \noindent 例） {\bf /柔らか/Sf} く /な/Af る まで /煮/Ac る

\quad \noindent 例） {\bf /色/Sf} が /変わ/Af る

以下の例に示すように，『Sf: 食材の様態』は，見た目，大きさ，分量などの様々な単語を含ん
でおり，一つのレシピ用語を構成する単語数が多くなりやすい．このため，
\begin{itemize}
 \item アノテーションを行う際に作業内容の一貫性を担保しにくい
 \item 未知の『Sf: 食材の様態』が多く出現する
\end{itemize}
という問題が発生する．
この問題の詳細については3.8節で後述する．

\quad \noindent 例） {\bf /やっと 手 を 入れ られ る くらい/Sf} の お /湯/F

\quad \noindent 例） /にんじん/F を {\bf /だいたい 薄さ ５ ｍｍ/Sf} に /切/Ac る


\subsection{St: 道具の様態}

用意された道具様態の初期状態を表す表現，並びにAcやAfの影響で遷移する（した）状態を表す表
現をStとする．

\quad \noindent 例） {\bf /弱火/St} の /フライパン/T で /炒め/Ac る

\quad \noindent 例） /オーブン/T を {\bf /150 度/St} に /予熱/Ac する

『St: 道具の様態』は，『T: 道具』の例

\quad \noindent 例） {\bf /弱火/T} で /煮/Ac る

と混同しやすいが，文中で調理過程における道具が明示され，
その道具の状態を示している表現を『St: 道具の様態』と定義する．


\subsection{D: 継続時間}

加熱時間や冷却時間など，加工の継続時間を示す．
数字と単位のほか，それらに対する修飾語句も含める．

\quad \noindent 例） {\bf /12 〜 15 分 間/D} /煮込/Ac みます

\quad \noindent 例） {\bf /5 分 くらい/D} 

\quad \noindent 例） {\bf /2 日 後 くらい/D} が /食べ時/Af で す !


\subsection{Q: 分量}

食材の一部を用いた調理動作を行う場合，その一部が量として表される場合にその表現を『Q: 分
量』とする．
数字と単位のほか，それらに対する修飾語句も含める．

\quad \noindent 例） /人参/F  {\bf /３ 〜 ４ ｃｍ くらい/Q} を /鍋/T に /入れ/Ac

\quad \noindent 例） /酒/F  {\bf /大さじ ２/Q} を /加え/Ac


\subsection{レシピ用語タグの付与が困難な事例}
\label{dfne}

1節で述べたように，本論文においてアノテーションの対象とするレシピテキストは推敲が乏しく，
レシピとは関係のない内容も多く含まれる．このため，
本節で述べた
レシピ用語
の定義を用いて実際にアノテーションを行うと，
レシピ用語タグ
を付与するべきか否かの判断に迷う部分が出現する．
とくに，タグ付与数
の多いレシピ用語タグほど，レシピ用語となる表現のバリエーションも多く，
その分アノテーション作業に時間を要すると考えられる（タグ付与数の分布は表\ref{tab_dist}
を参照）．
以下では，レシピ用語タグを付与する際にアノテーションの困難であった事例を列挙し，
現状でのアノテーション処理を述べる．

\begin{itemize}
 \item 入れ子：
表\ref{tab_dist}の平均単語数と最大単語数からわかるとおり，
『Sf: 食材の様態』，『D: 継続時間』，『St: 道具の様態』，『Q: 分量』
は他のレシピ用語タグと比較して
長い単語列となりやすく，以下の例のように入れ子構造が発生することがある．

\quad \noindent 例） /やっと /手/T を 入れ られ る くらい/Sf の お /湯/F

このような場合は，より長い単語列の
レシピ用語タグ
（上述した例では『Sf: 食材の様態』）
       を優先し，アノテーションを行う．
 \item 調理と関係のない記述：食事の感想など，調理とは直接関係の無い記述に調理に関連する
       表現が出現することがある．
       例えば，レシピ中に出現する用言のほとんどは『Ac: 調理者の動作』
       もしくは『Af: 食材の変化』であるが，上述した理由によりそれ以外の用言も存在する．
       これらの表現にはレシピの検索や構造の把握といった応用に
       おいては優先度が低く，また作業者への負担が大きくなるため，すべてOタグを付与する．
       また人名や地域名といった，調理とは直接関係のない固有名詞に
       関しては，本節で述べた各レシピ用語タグの付与対象となる単語列の一部となって
       いない限りOタグを付与する．
 \item 他のレシピIDの参照：まれに他のレシピIDを参照して調理手順や材料を示す事例が見られ
       るが，これらのレシピIDにはOタグを付与し，1つのレシピのみでアノテーション作業を完結させる．
 \item 記述内容の一部だけが実際の調理に対応付けられる：
       「〜ならば，〜する」，「〜する（または〜する）」といった仮定表現や括弧表現など
       には，実際に行われない調理行動を含めた表現が複数レシピに記述されることがある．
       この場合は，実際に行われる調理行動は不明であり，また，一般的な固有表現認識の手
       法ではそれらを区別することはできない．このような事例では，すべての表現に
レシピ用語タグ
を付与する．

\quad \noindent 例） /フライパン/T に /グレープ シードル/F （ また は /オリーブ オイル
       /F ） を ひ い て
\end{itemize}



レシピ用語の自動認識

固有表現認識タスクは，各単語に対してIOB2タグを推定する，系列ラベリング問題として解く
ことが一般的であり，SVMや点予測などを用いた手法が提案されている\cite{Support.Vector.Machineを用いた日本語固有表現抽出,A.Machine.Learning.Approach.to.Recipe.Text.Processing}．

本節では，
点予測によるIOB2タグ推定と動的計画法による経路探索による手法
\cite{A.Machine.Learning.Approach.to.Recipe.Text.Processing}
を用いて
レシピ用語の自動認識実験
を行い，作成したコーパスの精度を評価する．
また，学習コーパスに現れない未知のレシピ用語の推定事例についての事例を示し，
議論する．
本実験のための学習コーパスならびにテストコーパスとして，
\ref{nestd}節で述べたレシピ用語タグ付与コーパスを用いる（表\ref{table_corpus}参照）．


\subsection{レシピ用語の自動認識と精度評価}
\label{neexp}

本節では点予測によるレシピ用語の自動認識手法
\cite{A.Machine.Learning.Approach.to.Recipe.Text.Processing}
について概説し，自動認識実験の結果と考察を述べる．
まず，
IOB2タグの付与された学習コーパスを用いて
ロジスティック回帰に基づく識別器
\cite{LIBLINEAR:.A.Library.for.Large.Linear.Classification}を構築
し，
テストコーパスの各単語
$w_i$
に対応するIOB2タグ
$t_{j}$
ごとの確率
$s_{i,j}$
を以下の式により推定する．
\[
  s_{i,j} = P_{LR}(t_{j}|\Bdma{x}^{-},w_i,\Bdma{x}^{+}).
\]
$\Bdma{x}^{-} = \cdots x^{-2}x^{-1}, \Bdma{x}^{+} = x^{+1}x^{+2}\cdots$はそれぞれ単語$w_i$の前後の文字列を示す．
本論文で用いるロジスティック回帰識別器の素性の一覧を\tabref{feat_lr}に示す．
表中の$c(x)$は$x$に対応する文字種（漢字，平仮名，片仮名，数字，アルファベット，記号）を得る関数である．

次に，IOB2タグを用いた固有表現はIタグから始まらない
等のタグ制約を適用しながら，各単語までの経路の中で
確率最大となるようにIOB2タグを順に選んでいくことで最適経路を決定し，
自動認識器の最終的な出力とする
（図\ref{figure:NE}参照）．

\begin{table}[b]
\caption{ロジスティック回帰に基づく識別器の素性一覧}
\label{feat_lr}
\input{02table04.txt}
\end{table}

\begin{figure}[b]
  \begin{center}
\includegraphics{22-2ia2f2.eps}
  \end{center}
  \caption{ロジスティック回帰によるタグ確率付与と最適経路（太字部分）の探索図}
  \label{figure:NE}
\end{figure}

\begin{table}[b]
  \caption{IOB2タグ推定精度とレシピ用語タグの自動認識精度とカバレージ}
  \label{table_exp_result}
\input{02table05.txt}
\end{table}

\begin{figure}[t]
  \begin{center}
\includegraphics{22-2ia2f3.eps}
  \end{center}
  \caption{レシピ用語タグごとのカバレージ}
  \label{graph_exp_cov}
\end{figure}

学習コーパスの量を5段階に調節して自動認識実験を
行った結果を表\ref{table_exp_result}に示す．
また，レシピ用語タグ別の評価として，
各タグごとのカバレージを図\ref{graph_exp_cov}に，
自動認識精度（F値）を図\ref{graph_exp_all}
に示す．
ここで，表\ref{table_exp_result}，図\ref{graph_exp_cov}，図\ref{graph_exp_all}
におけるカバレージは，
テストコーパスに出現するIOB2タグあるいはレシピ用語タグのうち，
学習コーパスにも出現したタグの割合（頻度を加味する．）である．
また，表\ref{table_exp_result}におけるIOB2タグ推定精度は，
テストコーパス中のIOB2タグに対する，
自動認識システムが出力したIOB2タグの一致率を示し，
レシピ用語タグの自動認識精度はF値を示している．

表\ref{table_exp_result}から，一般分野の固有表現認識と同様に，
学習コーパスの増加に伴い自動認識精度が向上していることが分かる．
また，学習コーパスの分量が少量の状態で，学習コーパスのテストセットカバレージが
50\%程度の場合であっても，自動認識精度は70\%以上の水準を達成しており，
レシピ用語タグ付与コーパスを用いた
固有表現認識手法が有効に機能していることがわかる．
特に，『D: 継続時間』に関しては，図\ref{graph_exp_cov}と図\ref{graph_exp_all}の該当
タグ部分より，10\%程度の低いカバー率しか達成できていない学習コーパスを利用した場合
においても70\%以上の自動認識精度を達成可能であることがわかる．
この要因として，
『D: 継続時間』が数詞と単位からなる単語列に付与されるレシピ用語タグであるために，
文字並びに文字種を素性とした固有表現認識が効果的に機能しているこ
とが考えられる．

\begin{figure}[t]
  \begin{center}
\includegraphics{22-2ia2f4.eps}
  \end{center}
  \caption{レシピ用語タグごとの自動認識精度}
  \label{graph_exp_all}
\end{figure}

次に，
図\ref{graph_exp_all}から，
『F: 食材』，『T: 道具』，『Ac: 調理者の動作』，『Af: 食材の変化』，の4種類
のタグについては，
一般分野の固有表現認識精度（1万文程度の学習コーパスで80\%〜90\%）と同程度
であり，すでに比較的高い精度が達成
されていることがわかる．
『Sf: 食材の様態』に関しては，『T: 道具』と同程度のアノテーション数があるにも関わらず
精度は70\%程度にとどまっている．
この要因として，『Sf: 食材の様態』には
機能語や別のレシピ用語タグの一部がしばしば含まれており，長い単語列となっている
（\ref{dfne}節を参照）
ことが自動認識を困難にしているということが考えられる．
『St: 道具の様態』，『D: 継続時間』，『Q: 分量』については，『D: 継続時間』のみ
90\%を超えているが，他の2種類に関しては60\%〜70\%の精度である． 
また，表\ref{tab_NEtag}から，上述した3種類のタグは他のタグに比較して
学習コーパス中のアノテーション数が不十分であることがわかる．
今後は，これらのタグに対するアノテーションを増加させること
で容易に精度を向上させることが可能であろう．
また，レシピ以外の分野における固有表現認識タスクにおいても，
本実験で示したようにタグごとの検討を行って
優先的にアノテーションするべきタグを選択し，
効率的に固有表現認識器を構築することが可能である．


\subsection{未知のレシピ用語タグの推定事例}
\label{est_unk}

本節では，
上述のレシピ用語の自動認識
実験において，
テストセットにおける未知の
レシピ用語
に対し，正しくタグが推定されているか
どうかについて，その事例を示し，議論する．以下に示す自動推定結果の例では，
学習セットに現れなかった未知の
レシピ用語
を太字で示す．

\begin{itemize}
 \item 未知の『Sf: 食材の様態』が出現する場合，ニ格を伴う場合や食材の切り方を示す場合に
       は，識別器によって適切にタグ推定が行われている．

\quad \noindent 例） {\bf /サイコロ 切り/Sf} に する/Ac ．

       その一方で，
\ref{dfne}節で述べた
       『Sf: 食材の様態』のような長い単語列となるレシピ用語タグ
の自動推定精度は下がる
       傾向にある．以下の例において，正しい『Sf: 食材の様態』の範囲は「１ 〜 ２ ｍｍ 位」
       であるが，自動推定では「１ 〜 ２」と誤って推定されている．

\quad \noindent 例） {\bf /１ 〜 ２/Sf} ｍｍ 位 で ．

       テストセットでは現れなかったが，
\ref{dfne}
節
に示したようにさらに長い単語列を『Sf: 食材の様態』とする場合
       もあるため，『Sf: 食材の様態』の自動推定は他の
レシピ用語タグ
に比較して困難に
       なると考えられる．

 \item 『Ac: 調理者の動作』に関しては，以下の例のように1文中において複数の単語が連続で
       Acと推定される事例（「所々」
       はAcではないため，誤り）が見られた．

\quad \noindent 例） 皮/F を {\bf /所々/Ac} /剥/Ac き

レシピテキストにおいては，「『F: 食材』を
       『Ac: 調理者の動作』」という表現が多く出現することが原因であると考えられるが，レ
       シピの構造を把握するなどの応用を考えると，誤った『Ac: 調理者の動作』が増加するこ
       とは応用全体の精度低下につながるため，品詞情報を識別器の素性に加えるなどの対策
       が必要になると考えられる．
\end{itemize}


