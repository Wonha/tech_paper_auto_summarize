はじめに

本稿では語義曖昧性解消 (Word Sense Disambiguation, WSD) をタスクとした領域適応の問題が
共変量シフトの問題と見なせることを示す．そして共変量シフトの解法である確率密度比を重みにした
パラメータ学習により，WSD の領域適応の解決を図る．
共変量シフトの解法では確率密度比の算出が鍵となるが，ここでは Naive
Bayes で利用されるモデルを利用した簡易な算出法を試みた．
そして素性空間拡張法により拡張されたデータに対して，共変量シフトの解法を行う．
この手法を本稿の提案手法とする．

自然言語処理の多くのタスクにおいて帰納学習手法が利用される．
そこではコーパス\( S \)からタスクに応じた訓練データを作成し，
その訓練データから分類器を学習する．
そしてこの分類器を利用することで当初のタスクを解決する．
このとき実際のタスクとなるデータはコーパス\( S \)とは領域が異なる
コーパス\( T \)のものであることがしばしば起こる．
この場合，コーパス\( S \)（ソース領域）から学習された分類器では，
コーパス\( T \) （ターゲット領域）のデータを精度良く解析することができない問題が生じる．
これが領域適応の問題であり\footnote{領域適応は機械学習の分野では転移学習
\cite{kamishima}の一種と見なされている．}，近年活発に研究が行われている\cite{da-book}．

WSD は文\( \boldsymbol{x} \)内の多義語\( w \)の語義\( c \in C \)を識別する問題である．
\( P(c|\boldsymbol{x}) \)を文\( \boldsymbol{x} \)内の単語\( w \)
の語義が\( c \)である確率とすると，
確率統計的には \( \arg \max_{c \in C} P(c|\boldsymbol{x}) \) を解く問題といえる．
例えば単語\( w =\)「ボタン」には少なくとも \(c_1:\) 服のボタン，\(c_2: \) スイッチのボタン，
\(c_3: \) 花のボタン（牡丹），の3つの語義がある．そして文\( \boldsymbol{x} =\)「シャツのボタンが取れた」が
与えられたときに，文中の「ボタン」が\( C= \{ c_1,c_2,c_3 \} \) 内のどれかを識別する．
直接的には教師付き学習手法を用いて\( P(c|\boldsymbol{x}) \)を推定して解くことになる．
WSD の領域適応の問題は，前述したように，教師付き学習手法を利用する際に
学習もとのソース領域のコーパス\( S \)と，
分類器の適用先であるターゲット領域のコーパス\( T \)が異なる問題である．
領域適応ではソース領域\( S \)から\( S \)上の条件付き分布\( P_S(c|\boldsymbol{x}) \)は学習できるという設定なので，
\( P_S(c|\boldsymbol{x}) \)やその他の情報を利用して，
ターゲット領域\( T \)上の条件付き分布\( P_T(c|\boldsymbol{x}) \)を推定できれば良い．
ここで「シャツのボタンが取れた」という文中の「ボタン」の語義は，
この文がどのような領域のコーパスに現れても変化するとは考えづらい．
つまり\( P_T(c|\boldsymbol{x}) \)は領域に依存していないため，
\( P_S(c|\boldsymbol{x}) = P_T(c|\boldsymbol{x}) \)が成立していると考えられる．
今\( P_S(c|\boldsymbol{x}) \)は推定できるので，\( P_S(c|\boldsymbol{x}) = P_T(c|\boldsymbol{x}) \)が成立していれば，
\( P_T(c|\boldsymbol{x}) \)を推定する必要はないように見える．
ただしソース領域だけを使って推定した\( P_S(c|\boldsymbol{x}) \)では，
実際の識別精度は低い場合が多い．それは\( P_S(\boldsymbol{x}) \ne P_T(\boldsymbol{x})\)から生じている．
\( P_S(c|\boldsymbol{x}) = P_T(c|\boldsymbol{x}) \)だが\( P_S(\boldsymbol{x}) \ne P_T(\boldsymbol{x})\)という仮定の下で，
\( P_T(c|\boldsymbol{x}) \)を推定する問題は
共変量シフトの問題\cite{shimodaira2000improving,sugiyama-2006-09-05,sugiyama-book}である．
本稿では WSD の領域適応の問題を共変量シフトの問題として捉え，
共変量シフトの解法を利用してWSD の領域適応を解決することを試みる．

訓練データを\( D = \{ (\boldsymbol{x_i},c_i) \}_{i = 1}^N \)とする．
共変量シフトの標準的な解法では\( P_T (c|\boldsymbol{x}) \) に
確率モデル\( P(c|\boldsymbol{x};\boldsymbol{\theta}) \)を設定し，
次に確率密度比\( r(\boldsymbol{x_i}) = P_T(\boldsymbol{x_i})/P_S(\boldsymbol{x_i}) \)を重みにした以下の対数尤度を
最大にする\( \boldsymbol{\theta} \)を求めることで，\( P_T (c|\boldsymbol{x}) \) を構築する．
\[
\sum_{i=1}^{N} r(\boldsymbol{x_i}) \log P(c_i|\boldsymbol{x_i};\boldsymbol{\theta})
\]

また領域適応に対しては Daum{\'e} の手法\cite{daume0}が非常に簡易でありながら，
効果が高い手法として知られている．Daum{\'e} の手法は，
データの表現を領域適応に効果が出るように拡張し，
拡張されたデータを用いて SVM 等の学習手法を利用する手法である．
ここでは拡張する手法を「素性空間拡張法 (Feature Augmentation)」と呼び，
拡張されたデータを用いて SVM などで識別までを行う手法を
「Daum{\'e} の手法」と呼ぶことにする．
拡張されたデータに対しては任意の学習手法が利用できる．
つまり素性空間拡張法により拡張されたデータに対して，
共変量シフトによる解法を利用することも可能である．本稿ではこの手法を提案手法とする．


実験では現代日本語書き言葉均衡コーパス（BCCWJ コーパス\cite{bccwj}）
における3つの領域 OC （Yahoo! 知恵袋），PB （書籍）及び PN （新聞）
を利用する．SemEval-2 の日本語 WSD タスク\cite{semeval-2010}ではこれらのコーパスの一部に語義タグを付けた
データを公開しており，そのデータを利用する．
すべての領域である程度の頻度が存在する多義語 16単語を対象にして，WSD の領域適応の実験を行う．
領域適応としては OC→PB，PB→PN，PN→OC，OC→PN，PN→PB，PB→OC の計 6通りが存在する．
結果 \( 16 \times 6 = 96 \)通りのWSD の領域適応の問題に対して実験を行った．
その結果，提案手法は  Daum{\'e} の手法と同等以上の正解率を出した．

本稿で用いた簡易な確率密度比の算出法であっても
共変量シフトの解法を利用する効果が高いことが示された．
より正確な確率密度比の推定法を利用したり，
SVM を利用するなどの工夫で更なる改善が可能である．
また教師なし領域適応へも応用可能である．
WSD の領域適応に共変量シフトの解法を利用することは有望であると考えられる．


