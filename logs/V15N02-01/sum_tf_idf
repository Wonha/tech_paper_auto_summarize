================================================================
[section type  : abstract]
[section title : abstract]
================================================================
[i:3, score:451] したがって，クラス所属確率は，推定したいクラスの分類スコアだけでなく他のクラスの分類スコアにも依存すると考えられるため，推定したいクラス以外の分類スコアも用いて推定する必要があると思われる．
[i:4, score:709] 本稿は，多値分類における任意のクラスについてのクラス所属確率を，複数の分類スコア，特に推定したいクラスと第1位のクラスの分類スコアを用いて，ロジスティック回帰により高精度に推定する方法を提案する．
[i:6, score:688] また，本稿では，クラス所属確率を推定する別の方法として，各分類スコアを軸として等間隔に区切ってセルを作成する「正解率表」を利用する方法も提案したが，この方法においても複数の分類スコアを用いることは有効であった．

================================================================
[section type  : intro]
[section title : 序論]
================================================================
[i:38, score:699] ビニングによる方法は，訓練事例を分類スコアの順にソートして等サンプルごとに「ビン」にまとめ，各ビンごとに正解率を計算しておいたものをクラス所属確率として利用する（表[REF_bining1]を参照のこと．
[i:57, score:709] 本稿は，多値分類における任意のクラスについてのクラス所属確率を，複数の分類スコア，特に推定したいクラスと第1位のクラスの分類スコアを用いて，ロジスティック回帰により高精度に推定する方法を提案する．
[i:62, score:718] 例えば，「正解率表」を利用する方法において，訓練事例により表[REF_accuracy_table1]が作成されている場合，未知の事例において第1位に予測されたクラスの分類スコアが0.8,第2位に予測されたクラスの分類スコアが[MATH]であれば，この事例の第1位のクラスに対するクラス所属確率は0.67であると推定される．

================================================================
[section type  : related_study]
[section title : 関連研究]
================================================================
[i:68, score:598] ここでは，本稿の基礎として，クラス所属確率を推定する代表的な方法であるPlattの方法および，Zadroznyらにより提案されたビニングによる方法とIsotonic回帰による方法について述べる．
[i:69, score:197] これらはいずれも2値分類を想定しているが，Isotonic回帰による方法においては，2値分類を多値分類に対応させる方法についても述べる．
[i:70, score:297] 最後に，Plattの方法とIsotonic回帰による方法について，多種類の分類器とデータセットによる実験を行って比較したCaruanaらによる研究[CITE]について述べる．
-----------------------------------------------------
  [subsection title : Platt の方法]
-----------------------------------------------------
  [i:lead, 695] Platt [CITE]は，分類器をSVMに限定し，分類スコアを事例に対してクラスが予測された際の分離平面からの距離[MATH]として，シグモイド関数[MATH]により[0,1]区間に変換される値[MATH]をクラス所属確率の推定値として用いることを提案した．
.....
  [i:71, score:695] Platt [CITE]は，分類器をSVMに限定し，分類スコアを事例に対してクラスが予測された際の分離平面からの距離[MATH]として，シグモイド関数[MATH]により[0,1]区間に変換される値[MATH]をクラス所属確率の推定値として用いることを提案した．
  [i:73, score:500] シグモイド関数による方法の利点は，分類スコアから直接，クラス所属確率の推定値を求めることができるため，パラメータ[MATH]および[MATH]が推定されていれば，手続きが容易であることである．
  [i:76, score:566] 図[REF_Platt]において，[MATH]軸は分類スコア，[MATH]軸はクラス所属確率を表し，[MATH]印は分類スコアを0.1の区間に分けた場合に対応するクラス所属確率の実測値，実線は推定値を表す．
-----------------------------------------------------
  [subsection title : ビニングによる方法]
-----------------------------------------------------
  [i:lead, 219] Zadroznyらは，分類器としてナイーブベイズを想定し，ビニングによる方法（ヒストグラム法）を提案した[CITE].
.....
  [i:80, score:538] ビニングによる方法は，未知の事例のクラス所属確率を直接推定せずに，あらかじめ作成しておいた「ビン」を参照し，そのビンにある正解率を用いて間接的に推定を行う方法である．
  [i:83, score:368] このとき，各ビンに属する事例の分類スコアから，そのビンに所属する事例における分類スコアの最大値と最小値を調査しておく．
  [i:87, score:571] 最後に，未知の事例の分類スコアから該当するビンを見つけ，そのビンの正解率を未知の事例のクラス所属確率値とする．
-----------------------------------------------------
  [subsection title : Isotonic 回帰による方法]
-----------------------------------------------------
  [i:lead, 433] Zadroznyらは，ビニングによる方法の問題点を解決する方法として，次には，分類スコアと正解率が単調非減少な関係にあるという観察に基づくIsotonic回帰による方法を提案した[CITE].
.....
  [i:98, score:498] PAVを用いたIsotonic回帰による方法も，ビニングによる方法と同様に，最初に訓練事例を分類スコア順にソートする必要があるが，事例をまとめて扱わずに，各事例に対して正解率（正例の場合は1,負例の場合は0となる）を付ける点が異なる（図[REF_Isotonic]における開始時点の表を参照のこと）．
  [i:103, score:475] Zadroznyらは，次に，多値分類においては，分類器は各々の予測クラスに対して分類スコアを1つずつ出力すると仮定し，多値分類におけるPAVの効果を調査した．
  [i:110, score:553] なお，Zadroznyらは，この後さらに提案したProbingとよばれるクラス所属確率の推定方法を多値分類へ拡張する場合には，ここで述べた統合方法を用いずに，one-against-allにより分解した各組において2値分類として推定した値をそのまま用いるという非常に単純な方法を示した[CITE].
-----------------------------------------------------
  [subsection title : 方法の比較]
-----------------------------------------------------
  [i:lead, 477] Caruanaら[CITE]は，アンサンブル学習を含めた10種類の分類器（SVM,ニューラルネット，決定木，k近傍法，bagged trees, random forests, boosted trees, boosted stumps,ナイーブベイズ分類器，ロジスティック回帰）を，8種類のデータセット（UCI Repositoryから4種類，医療分野から2種類選んだデータセット，IndianPine92データセット[CITE], Stanford Linear Accelerator）に適用し，Plattの方法とIsotonic回帰による方法(PAV)の比較を行った．
.....
  [i:112, score:477] Caruanaら[CITE]は，アンサンブル学習を含めた10種類の分類器（SVM,ニューラルネット，決定木，k近傍法，bagged trees, random forests, boosted trees, boosted stumps,ナイーブベイズ分類器，ロジスティック回帰）を，8種類のデータセット（UCI Repositoryから4種類，医療分野から2種類選んだデータセット，IndianPine92データセット[CITE], Stanford Linear Accelerator）に適用し，Plattの方法とIsotonic回帰による方法(PAV)の比較を行った．
  [i:113, score:199] その結果，Plattの方法はデータが少ないとき（約1,000サンプル未満）に効果的であり，Isotonic回帰による方法は過学習しない程度に十分なデータがあるときによかった．
  [i:114, score:336] Jonesら[CITE]は，検索を成功させるために，ユーザが入力したクエリから新しくクエリを生成して置き換えるというタスクにおいて，置き換えられたクエリの正確さの程度を予測するために確信度スコアが必要であると考え，Isotonic回帰による方法(PAV)とシグモイド関数による方法についての簡単な比較実験を行った．

================================================================
[section type  : proposed_method]
[section title : 第 1 位のクラスについてのクラス所属確率推定]
================================================================
[i:116, score:438] 本稿においても，Zadroznyらと同様に，多値分類においては，分類器は各々の予測クラスに対して分類スコアを1つずつ出力すると仮定する．
[i:120, score:601] 以上より，多値分類において第1位のクラスのクラス所属確率は，第1位のクラスの分類スコアだけでなく他のクラスの分類スコアにも依存すると考えられるために，正確な推定値を得るためには，第1位のクラス以外の分類スコアも考慮に入れた複数の分類スコアを用いる必要があると思われる．
[i:125, score:439] 以下では，まず，本節において，第1位の予測クラスについてクラス所属確率の推定方法を検討し，有効な方法を提案する．
-----------------------------------------------------
  [subsection title : 提案手法]
-----------------------------------------------------
  [i:lead, 546] 本稿では，第1位のクラス所属確率を複数の分類スコアを用いて推定することを提案する．
.....
  [i:129, score:659] 第1位のクラスから第[MATH]位のクラスまで[MATH]個の分類スコアを用いる場合，ロジスティック回帰による方法は（1）式により直接，クラス所属確率を推定する．
  [i:150, score:730] 例えば，第1位のクラスと第2位のクラスの分類スコアの2つを用いて区間幅0.1とする場合，縦横ともに0.1間隔で区切られたセルをもつ長方形の正解率表となるが，訓練事例中の各評価事例における2つのクラスの分類スコアから，どのセルに属するかが決まる．
  [i:175, score:712] STEP3未知の事例に対するクラス所属確率の推定は，未知の事例において用いる分類スコアにより正解率表の中から該当するセルを見つけ，そのセルの正解率を推定値とする．
-----------------------------------------------------
  [subsection title : 実験]
-----------------------------------------------------
  [i:lead, 612] 実験の目的は，多値分類における第1位のクラスのクラス所属確率について有効な推定方法を調査し，複数の分類スコアを用いることが有効であることを示すこと（実験1），および実験1で最も有効であった方法の性能を評価すること（実験2）である．
.....
  [i:220, score:922] なお，今回，等事例に区切る方法において最もよかったのは，セルの個数が12個または7個の場合であったが，Zadroznyらのビニングによる方法においてもビンの個数が10個の場合が最もよかったとの報告があり[CITE],第1位のクラスの分類スコアのみを用いる場合には，分類器やデータセットが異なっていても最適なセルの個数が類似していることは興味深い．
  [i:237, score:852] 次に，ロジスティック回帰による方法も含めてすべての場合の中で最もよい結果を示したのは，最適な正解率表を利用した場合，すなわち「第1位と第2位のクラスの分類スコアを用いてカバレッジを重みとする移動平均法による平滑化を行った正解率表を利用する方法」（セルの区間幅0.1）であった．
  [i:252, score:759] 特に，最適な正解率表である「第1位と第2位のクラスの分類スコアを用いて（カバレッジによる重み付き）移動平均法による平滑化を行い，セルの区間幅を0.1（セルの個数30個）に設定した正解率表」を利用する方法は最も有効であった．

================================================================
[section type  : proposed_method]
[section title : 第 2 位以下の任意のクラスについてのクラス所属確率推定]
================================================================
[i:289, score:601] 3節で，多値分類における第1位の予測クラスについてのクラス所属確率は，複数の分類スコアを用いた推定が有効であることが明らかになった．
[i:290, score:264] 本節では，3節で得られた結論を第2位以下の任意のクラスに対して拡張する方法を検討する．
[i:291, score:283] この場合，どのクラスの分類スコアを組み合わせることが有効であるかを検討することが重要である．
-----------------------------------------------------
  [subsection title : 提案手法]
-----------------------------------------------------
  [i:lead, 710] 本稿では，多値分類における第2位以下の任意のクラスについてのクラス所属確率を高精度に推定するために，推定したいクラス（第[MATH]位のクラス）と第1位のクラスの分類スコアを用いてロジスティック回帰により推定する方法を提案する．
.....
  [i:292, score:710] 本稿では，多値分類における第2位以下の任意のクラスについてのクラス所属確率を高精度に推定するために，推定したいクラス（第[MATH]位のクラス）と第1位のクラスの分類スコアを用いてロジスティック回帰により推定する方法を提案する．
  [i:296, score:487] ここで，推定したいクラスの他に用いるクラスとして第1位のクラスを選択した理由は，3節でも述べたように，多値分類においては，第1位のクラスの分類スコアが最も大きく，どのクラスの分類スコアも第1位のクラスの分類スコアの値以上にはならないため，推定したいクラスの分類スコアの値を第1位のクラスの分類スコアとの相対的な関係で捉えることが有効であると考えたためである．
  [i:298, score:600] また，クラス所属確率の推定方法については，第2位以下のクラスにおいては，第1位のクラスよりも分類スコアの傾向をさらに把握しにくくなるために，最適な正解率表を作成することが困難であると考えられる．
-----------------------------------------------------
  [subsection title : 実験]
-----------------------------------------------------
  [i:lead, 758] 実験の目的は，多値分類における第2位以下の任意のクラスのクラス所属確率の推定に用いる分類スコアは，提案手法による組み合わせ方が最も有効であることを示すこと（実験1），および第2位以下のクラスにおいては，ロジスティック回帰による方法が正解率表を利用する方法より有効であることを示すこと（実験2）である．
.....
  [i:301, score:758] 実験の目的は，多値分類における第2位以下の任意のクラスのクラス所属確率の推定に用いる分類スコアは，提案手法による組み合わせ方が最も有効であることを示すこと（実験1），および第2位以下のクラスにおいては，ロジスティック回帰による方法が正解率表を利用する方法より有効であることを示すこと（実験2）である．
  [i:327, score:716] AUCによる評価において最もよかった方法は，JGSSデータセットの場合は提案手法であり，20 Newsgroupsデータセットの場合は，注目するクラスと直前および直後のクラスの分類スコアを用いる方法（第2位のクラスの場合）や，第1位から推定したいクラスまでのすべてのクラスの分類スコアを用いる方法（第3位のクラスの場合）であった．
  [i:338, score:664] もう1つは，第2位以下の各クラスにおける分類スコアのとる値の状況に合わせて，セルの区間幅を適宜（例えば0.2など）変えたもので，「正解率表（改良版）」とよぶことにする．

================================================================
[section type  : conclusion]
[section title : 結論]
================================================================
[i:347, score:504] 本稿では，文書分類で適用されることの多い多値分類における任意のクラスのクラス所属確率を，複数の分類スコアを用いて高精度に推定する方法を提案した．
[i:348, score:653] 提案手法は，複数個の分類スコア，特に推定したいクラスと第1位のクラスの分類スコアを用いてロジスティック回帰によりクラス所属確率を推定する．
[i:349, score:716] ここで，第1位のクラスについては，第1位と第2位のクラスの分類スコアのなす空間を等間隔（0.1）に区切って作成した各セルにおいて正解率を計算し，カバレッジを重みとする移動平均法により平滑化を行った正解率表を参照する方法も有効であった．

