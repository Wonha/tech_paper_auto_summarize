1  自然 言語 処理 において は  タグ 付け や 文書 分類 を はじめ と する さまざま な 分類 タスク において  分類 器 が 出力 する クラス に 確信 度 すなわち クラス 所属 確率 を 付与 する こと は 有用 で ある  
0  例えば  自動 分類 システム が より 大きな システム の 一部 を 構成 し  自動 分類 結果 が 別 の システム に 自動 入力 さ れる よう な 場合 に  クラス 所属 確率 は 重要 な 役割 を 果たす  
0  この 例 として  ブログ 記事 に対して さまざま な 観点 から 付け られ た タグ  複数  を ユーザ に 表示 する システム において  タグ を 自動的 に 付与 する 際 に  クラス 所属 確率 が 閾値 より 低い タグ について は 排除 する こと が 有効 な 場合 が ある  CITE  
0  同様 に  手書き 文字 認識 システム による 分類 結果 が  言語 モデル の よう な ドメイン 知識 を 組み込ん だ システム の 入力 で ある 場合 も  クラス 所属 確率 が 用い られ て いる  CITE  
1  また  自動的 に タグ 付け さ れ た 事例 の うち 誤 分類 さ れ た もの を 人手 により 訂正 し たい 場合 に  すべて の 事例 を チェック する の は 大きな コスト が かかる が  クラス 所属 確率 が 低い もの ほど 不 正解 で ある 可能 性 が 高い と 仮定 し  クラス 所属 確率 が 閾値 を 下回る 事例 のみ を 訂正 する こと に すれ ば  効率 的 な 作業 が 行える  
0  さらに  自動 分類 結果 が 人間 の 意思 決定 を 支援 する 場合 において は  クラス 所属 確率 は 判断 の 根拠 を 与える  
0  例えば  高橋 ら は  社会 調査 において 自由 回答 で 収集 さ れる 職業 データ を 該当 する 職業 コード に 自動 分類 し  CITE  上位 5 位 まで に 予測 さ れ た クラス を 候補 として 画面 に 提示 する システム  NANACO システム  を 開発 し た  CITE  
1  NANACO システム は  我が国 の 主要 な 社会 調査 で ある JGSS  Japanese General Social Surveys  日本 版 総合 的 社会 調査  kern  0  5 zw や  SSM 調査  Social Stratification and Social Mobility Survey  社会 階層 と 社会 移動 調査  kern  0  5 zw など に 利用 さ れ て いる が  システム を 利用 し た コーダ から  提示 さ れ た 各 クラス について どの 程度 確か らしい か を 示す クラス 所属 確率 を 付与 し て ほしい という 要望 が 出さ れ て いる  
0  最後 に  クラス 所属 確率 は EM アルゴリズム において も 有用 で ある  
1  例えば  語 の 曖昧 性 解消 において  ある ドメイン で 訓練 さ れ た 分類 器 を  別 の ドメイン の コーパス 用 に 調整 する ため に 用い られ た EM アルゴリズム において  クラス 所属 確率 は 精度 の 向上 に 役立つ こと が 報告 さ れ て いる  CITE  
0  事例  MATH  が ある クラス  MATH  に 所属 する クラス 所属 確率  MATH  は  2 値 分類  多値 分類 の いずれ において も  MATH  で 表さ れる  
0  この よう な クラス 所属 確率 の 意味 から は  1 つ の 事例 が 複数 の クラス に 所属 する マルチ ラベル 分類 の 可能 性 が あっ て も よく  CITE  また ある 事例 の 全 クラス に対する クラス 所属 確率 の 推定 値 の 総和 が  MATH  で ある 必要 も ない  CITE  
0  しかし  もし  シングル ラベル 分類 で  全 クラス に対する クラス 所属 確率 の 推定 値 を 求める こと が できれ ば  その 総和 が  MATH  に なる よう に 正規 化 する こと が 可能 で ある  
1  この よう な クラス 所属 確率 は  正規 化 さ れ た クラス 所属 確率  と よば れ  CITE  事後 確率 と 考える こと が できる  
1  対象 と する 分類 問題 を シングル ラベル として 扱う 場合  本来 は 正規 化 さ れ た クラス 所属 確率 を 用いる 必要 が ある と 考え られる  
1  しかし  本稿 において は  事例 が 注目 する クラス に 所属 する か 否 か という 問題 に対する 関心 により  それぞれ の クラス を 独立 に 扱う ため  一部 の 実験 を 除き 基本 的 に は 正規 化 さ れ た クラス 所属 確率 を 用い ない  
1  実際 に は  今回 の 実験 で は  正規 化 を 行わ ない クラス 所属 確率 の 推定 値 の 総和 の 平均 は ほぼ 1 に 等しく  また 限定 さ れ た 実験 の 結果 で は ある が  本稿 における 提案 手法 に関して は  正規 化 を 行わ ない 場合 は 正規 化 さ れ た 場合 と ほぼ 同様 か やや 劣る 結果 で ある ため  本稿 における 結論 は  正規 化 さ れ た クラス 所属 確率 を 用い た 場合 に は  さらなる 説得 性 を もつ と 考え られる  
1  クラス 所属 確率 の 推定 は  分類 器 が 出力 する スコア  分類 スコア  に 基づい て 行わ れる  
0  非常 に 単純 に は  例えば ナイーブベイズ 分類 器 や 決定 木 で は 分類 スコア が  MATH  の 値 を とる ため に  分類 スコア を そのまま 用いる こと が できる  
0  また  サポートベクターマシン  SVM  の よう に 分類 スコア が  MATH  の 値 を とら ない 場合 でも  最大 値 や 最小 値 を 利用 し て 確率 値 に 変換 する こと は 容易 で ある  
0  しかし  この よう に し て 得 られ た 推定 値 は 実際 の 値 から 乖離 する こと が 多い  
0  この 理由 は  例えば  ナイーブベイズ 分類 器 が 出力 する 確率 値 は  0 または 1 に 近い 極端 な 値 を とる こと が 多い ため に  この 値 を そのまま クラス 所属 確率 と する と 不正確 に なる ため で ある  CITE  
0  また  決定 木 において は  少なくとも  ナイーブベイズ 分類 器 の 場合 と 同様 の 確率 値 の 偏り および  リーフ に 関連 する 訓練 事例 数 が 少ない 場合 に 分散 が 大きい という 2 つ の 問題 が ある が  刈り込み によって も 確率 値 の 改善 は 期待 でき ない ため  クラス 所属 確率 の 推定 値 として は 使え ない  CITE  
0  SVM において も  分類 スコア として 用い られる 分離 平面 から の 距離 が  事例 が クラス に 所属 する 程度 に 正確 に は 比例 し ない  CITE  ため に  単純 な 変換 で は 正確 な 値 を 推定 し にくい  
0  したがって  クラス 所属 確率 の 正確 な 値 を 推定 する 方法 について の 研究 が 必要 で ある  
0  これ まで に いくつ か の 方法 が 提案 さ れ て いる が  代表 的 な もの に  Platt の 方法  CITE  や Zadrozny ら により 提案 さ れ た 方法  CITE  が ある  
0  Platt の 方法 で は  SVM における 分離 平面 から の 距離 を 分類 スコア と し  この 値 を シグモイド 関数 を 利用 し て  MATH  区間 の 値 に 変換 し て クラス 所属 確率 値 の 推定 値 と する  図  REF _ Platt  における 実線   
1  例えば  訓練 事例 により 図  REF _ Platt  の 実線 で 表さ れる よう な 変換 式 が 得 られ て いる 場合 に  ある 事例 の 分類 スコア が 1  5 で あれ ば  この 事例 の クラス 所属 確率 は 0  9 で ある と 計算 さ れる  
0  しかし  Platt の 方法 で は 分類 器 や データセット によって は うまく 推定 でき ない 場合 が ある として  CITE  Zadrozny ら は 決定 木 や ナイーブベイズ 分類 器 に対して いくつ か の 方法 を 提案 し た  CITE  
0  この うち  ナイーブベイズ 分類 器 に 適用 し た  ビニング による 方法  は 注目 に 値する  
0  ビニング による 方法 は  訓練 事例 を 分類 スコア の 順 に ソート し て 等 サンプル ごと に  ビン  に まとめ  各 ビン ごと に 正解 率 を 計算 し て おい た もの を クラス 所属 確率 として 利用 する  表  REF _ bining 1  を 参照 の こと  
0  表 の 上段 の 数値  斜体  は 各 ビン における 分類 スコア の 範囲  下段 の 数値 は 各 ビン の 正解 率 を 表す   
1  すなわち  評価 事例 の 分類 スコア から 該当 する ビン を 参照 し  その ビン の 正解 率 を 評価 事例 の クラス 所属 確率 の 推定 値 と する  
1  例えば  訓練 事例 により 表  REF _ bining 1  が 作成 さ れ て いる 場合 に  未知 の 事例 の 分類 スコア が 0  6 で あれ ば  この 事例 の クラス 所属 確率 は 0  46 で ある と 推定 さ れる  
0  Zadrozny ら は  ビニング による 方法 に は 最適 な ビン の 個数 を 決定 する の が 困難 で ある という 問題 が ある として  次に Isotonic 回帰 による 方法 を 提案 し た  CITE  
0  Isotonic 回帰 による 方法 も ビニング による 方法 と 同様 に  訓練 事例 を 分類 スコア の 順 に ソート する こと が 前提 条件 で ある が  ビン として まとめ ず に 事例 ごと に 確率  正解 の 場合 1  不 正解 の 場合 0  を 付ける 点 が 異なる  
0  確率 値 は 初期 値 1 または 0 で 開始 さ れる が  分類 スコア と 単調 関係 を 保つ よう に なる まで 修正 が 繰り返さ れ  最終 的 に 定まっ た 値 を 正解 率 と する  表  REF _ Isotonic 1  を 参照 の こと  
0  表 の 上段 の 数値  斜体  は 各 事例 の 分類 スコア  下段 の 数値 は 各 事例 の 正解 率 を 表す   
1  評価 事例 の クラス 所属 確率 は  評価 事例 の 分類 スコア と 等しい 分類 スコア を もつ 事例 の 正解 率 を 参照 し  この 値 を 推定 値 と する  
1  例えば  訓練 事例 により 表  REF _ Isotonic 1  が 作成 さ れ て いる 場合 に  未知 の 事例 の 分類 スコア が 0  8 で あれ ば  この 事例 の クラス 所属 確率 は 0  5 で ある と 推定 さ れる  
1  これ まで に 提案 さ れ た 方法 は いずれ も 2 値 分類 を 想定 し て いる ため に  クラス 所属 確率 の 推定 に は 推定 し たい クラス の 分類 スコア のみ を 用いる  
1  したがって  文書 分類 で しばしば 用い られる 多値 分類 に対して も  分類 スコア を 単独 に 用い て 推定 する 2 値 分類 に 分解 する 方法 が 検討 さ れ た  CITE  
0  すなわち  多値 分類 を いったん 2 値 分類 の 組 に 分解 し  それぞれ の 組 で 2 値 分類 として 推定 し た クラス 所属 確率 の 値 を 最後 に 統合  調整  する  
0  多値 分類 を 2 値 分類 に 分解 する に は  all  pairs  one  versus  one  および one  against  all  one  versus  rest  の 2 つ の 方法 が ある が  Zadrozny ら は  分解 する 方法 そのもの に 精度 の 違い が ない こと を 実験 により 示し た 上 で  実験 において は いずれ の 場合 も one  against  all を 用い た  
0  各組 の 2 値 分類 における 推定 値 を 統合 する 方法 として は  one  against  all により 分解 し た 各組  クラス の 数 と 等しい  において 推定 し た 値 の 合計 が 1 に なる よう に それぞれ の 推定 値 を 正規 化 する 方法 が よい 結果 を 示し た こと を 報告 し た  CITE  
0  また  Zadrozny ら による 最新 の 統合 方法 は さらに 単純 で  one  against  all により 分解 し た 2 値 分類 の 各組 において 推定 し た クラス 所属 確率 を そのまま その クラス について の 推定 値 と する  CITE  
0  多値 分類 について の 推定 方法 について は Zadrozny ら の 研究 以外 に なく  例えば  Caruana ら による クラス 所属 確率 の 推定 方法 の 比較  CITE  において も  2 値 分類 を 対象 と し て おり  多値 分類 に対して は  Zadrozny ら の 文献  CITE  の 紹介 に とどまっ て いる  
1  しかし  多値 分類 は 2 値 分類 の 場合 と 異なり  予測 さ れる クラス は 分類 スコア の 絶対 的 な 大き さ で は なく 相対 的 な 大き さ により 決定 さ れる ため に  クラス 所属 確率 は 推定 し たい クラス の 分類 スコア だけ で なく 他 の クラス の 分類 スコア に も 依存 する と 考え られる  
1  したがって  多値 分類 において は  推定 し たい クラス 以外 の クラス の 分類 スコア も 用いる こと が 有効 で ある と 思わ れる  
1  本稿 は  多値 分類 における 任意 の クラス について の クラス 所属 確率 を  複数 の 分類 スコア  特に 推定 し たい クラス と 第 1 位 の クラス の 分類 スコア を 用い て  ロジスティック 回帰 により 高 精度 に 推定 する 方法 を 提案 する  
1  本稿 で は また  複数 の 分類 スコア を 用い て クラス 所属 確率 を 推定 する 別 の 方法 として   正解 率 表   表  REF _ accuracy _ table 1  を 参照 の こと  
0  表 の 最 左 列 と 最 上段 の 数値  斜体  は それぞれ 第 1 位 と 第 2 位 に 予測 さ れ た クラス に対する 分類 スコア の 範囲  それ 以外 の 数値 は  第 1 位 の クラス について の 正解 率 を 表す  
0   を 利用 する 方法 も 提案 する  
0  正解 率 表 を 利用 する 方法 と は  各 分類 スコア の なす 空間 を 等 区間  例えば 0  5  に 区切っ て  セル  を 作成 し  各 セル について 正解 率 を 計算 し た 表 を 用意 し て 参照 する 方法 で ある  
1  例えば   正解 率 表  を 利用 する 方法 において  訓練 事例 により 表  REF _ accuracy _ table 1  が 作成 さ れ て いる 場合  未知 の 事例 において 第 1 位 に 予測 さ れ た クラス の 分類 スコア が 0  8  第 2 位 に 予測 さ れ た クラス の 分類 スコア が  MATH  で あれ ば  この 事例 の 第 1 位 の クラス に対する クラス 所属 確率 は 0  67 で ある と 推定 さ れる  
1  しかし  もし 第 2 位 に 予測 さ れ た クラス の 分類 スコア が  MATH  または 0  3 で あれ ば  第 1 位 の クラス について の クラス 所属 確率 の 推定 値 は  それぞれ 0  53 または 0  38 の よう により 小さな 値 に なる  
1  この よう に  提案 手法 は 既存 の 方法 と 異なり  推定 し たい クラス 所属 確率 に 関連 する と 思わ れる 別 の クラス  例えば 第 2 位 の クラス  の 分類 スコア を 直接 利用 する こと で  より 正確 な 推定 を 行う こと が 可能 に なる  
1  以下  次節 で 関連 研究 について 述べ た 後  3 節 で は  まず 第 1 位 に 予測 さ れ た クラス の クラス 所属 確率 を 複数 の 分類 スコア を 用い て 推定 する 方法 を 提案 し  実験 を 行う  
0  4 節 で は 3 節 で 得 られ た 結論 を 第 2 位 以下 の 任意 の クラス に対して 拡張 する 方法 を 提案 し  実験 を 行う  
