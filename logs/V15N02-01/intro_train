1 自然言語処理 において は タグ付け や 文書分類 を はじめ と する さまざま な 分類タスク において 分類器 が 出力 する クラス に 確信度 すなわち クラス所属確率 を 付与 する こと は 有用 で ある 
0 例えば 自動分類システム が より 大きな システム の 一部 を 構成 し 自動分類結果 が 別 の システム に 自動入力 さ れる よう な 場合 に クラス所属確率 は 重要 な 役割 を 果たす 
0 この 例 として ブログ記事 に対して さまざま な 観点 から 付け られ た タグ複数 を ユーザ に 表示 する システム において タグ を 自動的 に 付与 する 際 に クラス所属確率 が 閾値 より 低い タグ について は 排除 する こと が 有効 な 場合 が ある 
0 同様 に 手書き文字認識システム による 分類結果 が 言語モデル の よう な ドメイン知識 を 組み込ん だ システム の 入力 で ある 場合 も クラス所属確率 が 用い られ て いる 
0 また 自動的 に タグ付け さ れ た 事例 の うち 誤 分類 さ れ た もの を 人手 により 訂正 し たい 場合 に すべて の 事例 を チェック する の は 大きな コスト が かかる が クラス所属確率 が 低い もの ほど 不 正解 で ある 可能性 が 高い と 仮定 し クラス所属確率 が 閾値 を 下回る 事例 のみ を 訂正 する こと に すれ ば 効率的 な 作業 が 行える 
0 さらに 自動分類結果 が 人間 の 意思決定 を 支援 する 場合 において は クラス所属確率 は 判断 の 根拠 を 与える 
0 例えば 高橋ら は 社会調査 において 自由回答 で 収集 さ れる 職業データ を 該当 する 職業コード に 自動分類 し CITE上位5位 まで に 予測 さ れ た クラス を 候補 として 画面 に 提示 する システムNANACOシステム を 開発 し た 
0 NANACOシステム は 我が国 の 主要 な 社会調査 で ある JGSSJapaneseGeneralSocialSurveys日本版総合的社会調査kern05zw や SSM調査SocialStratificationandSocialMobilitySurvey社会階層 と 社会移動調査kern05zw など に 利用 さ れ て いる が システム を 利用 し た コーダ から 提示 さ れ た 各 クラス について どの 程度確か らしい か を 示す クラス所属確率 を 付与 し て ほしい という 要望 が 出さ れ て いる 
0 最後 に クラス所属確率 は EMアルゴリズム において も 有用 で ある 
0 例えば 語 の 曖昧性解消 において ある ドメイン で 訓練 さ れ た 分類器 を 別 の ドメイン の コーパス用 に 調整 する ため に 用い られ た EMアルゴリズム において クラス所属確率 は 精度 の 向上 に 役立つ こと が 報告 さ れ て いる 
0 事例MATH が ある クラスMATH に 所属 する クラス所属確率MATH は 2値分類多値分類 の いずれ において も MATH で 表さ れる 
0 この よう な クラス所属確率 の 意味 から は 1 つ の 事例 が 複数 の クラス に 所属 する マルチラベル分類 の 可能性 が あっ て も よく CITE また ある 事例 の 全 クラス に対する クラス所属確率 の 推定値 の 総和 が MATH で ある 必要 も ない 
0 しかし もし シングルラベル分類 で 全 クラス に対する クラス所属確率 の 推定値 を 求める こと が できれ ば その 総和 が MATH に なる よう に 正規化 する こと が 可能 で ある 
0 この よう な クラス所属確率 は 正規化 さ れ た クラス所属確率 と よば れ CITE事後確率 と 考える こと が できる 
0 対象 と する 分類問題 を シングルラベル として 扱う 場合本来 は 正規化 さ れ た クラス所属確率 を 用いる 必要 が ある と 考え られる 
0 しかし 本稿 において は 事例 が 注目 する クラス に 所属 する か 否 か という 問題 に対する 関心 により それぞれ の クラス を 独立 に 扱う ため一部 の 実験 を 除き 基本的 に は 正規化 さ れ た クラス所属確率 を 用い ない 
0 実際 に は 今回 の 実験 で は 正規化 を 行わ ない クラス所属確率 の 推定値 の 総和 の 平均 は ほぼ 1 に 等しく また 限定 さ れ た 実験 の 結果 で は ある が 本稿 における 提案手法 に関して は 正規化 を 行わ ない 場合 は 正規化 さ れ た 場合 と ほぼ 同様 か やや 劣る 結果 で ある ため本稿 における 結論 は 正規化 さ れ た クラス所属確率 を 用い た 場合 に は さらなる 説得性 を もつ と 考え られる 
0 クラス所属確率 の 推定 は 分類器 が 出力 する スコア分類スコア に 基づい て 行わ れる 
0 非常 に 単純 に は 例えば ナイーブベイズ分類器 や 決定木 で は 分類スコア が MATH の 値 を とる ため に 分類スコア を そのまま 用いる こと が できる 
0 また サポートベクターマシンSVM の よう に 分類スコア が MATH の 値 を とら ない 場合 でも 最大値 や 最小値 を 利用 し て 確率値 に 変換 する こと は 容易 で ある 
0 しかし この よう に し て 得 られ た 推定値 は 実際 の 値 から 乖離 する こと が 多い 
0 この 理由 は 例えば ナイーブベイズ分類器 が 出力 する 確率値 は 0 または 1 に 近い 極端 な 値 を とる こと が 多い ため に この 値 を そのまま クラス所属確率 と する と 不正確 に なる ため で ある 
0 また 決定木 において は 少なくとも ナイーブベイズ分類器 の 場合 と 同様 の 確率値 の 偏り および リーフ に 関連 する 訓練事例数 が 少ない 場合 に 分散 が 大きい という 2 つ の 問題 が ある が 刈り込み によって も 確率値 の 改善 は 期待 でき ない ためクラス所属確率 の 推定値 として は 使え ない 
0 SVM において も 分類スコア として 用い られる 分離平面 から の 距離 が 事例 が クラス に 所属 する 程度 に 正確 に は 比例 し ない CITEため に 単純 な 変換 で は 正確 な 値 を 推定 し にくい 
0 したがって クラス所属確率 の 正確 な 値 を 推定 する 方法 について の 研究 が 必要 で ある 
0 これ まで に いくつ か の 方法 が 提案 さ れ て いる が 代表的 な もの に Platt の 方法CITE や Zadroznyら により 提案 さ れ た 方法CITE が ある 
0 Platt の 方法 で は SVM における 分離平面 から の 距離 を 分類スコア と し この 値 を シグモイド関数 を 利用 し て MATH区間 の 値 に 変換 し て クラス所属確率値 の 推定値 と する 図REF_Platt における 
0 例えば 訓練事例 により 図REF_Platt の 実線 で 表さ れる よう な 変換式 が 得 られ て いる 場合 に ある 事例 の 分類スコア が 15 で あれ ば この 事例 の クラス所属確率 は 09 で ある と 計算 さ れる 
0 しかし Platt の 方法 で は 分類器 や データセット によって は うまく 推定 でき ない 場合 が ある として CITEZadroznyら は 決定木 や ナイーブベイズ分類器 に対して いくつ か の 方法 を 提案 し た 
0 この うちナイーブベイズ分類器 に 適用 し た ビニング による 方法 は 注目 に 値する 
0 ビニング による 方法 は 訓練事例 を 分類スコア の 順 に ソート し て 等 サンプルごと に ビン に まとめ 各 ビンごと に 正解率 を 計算 し て おい た もの を クラス所属確率 として 利用 する 表 REF_bining1 を 参照 の 
0 表 の 上段 の 数値斜体 は 各 ビン における 分類スコア の 範囲下段 の 数値 は 各 ビン の 正解率 を 表す 
0 すなわち 評価事例 の 分類スコア から 該当 する ビン を 参照 し その ビン の 正解率 を 評価事例 の クラス所属確率 の 推定値 と する 
0 例えば 訓練事例 により 表 REF_bining1 が 作成 さ れ て いる 場合 に 未知 の 事例 の 分類スコア が 06 で あれ ば この 事例 の クラス所属確率 は 046 で ある と 推定 さ れる 
0 Zadroznyら は ビニング による 方法 に は 最適 な ビン の 個数 を 決定 する の が 困難 で ある という 問題 が ある として 次に Isotonic回帰 による 方法 を 提案 し た 
0 Isotonic回帰 による 方法 も ビニング による 方法 と 同様 に 訓練事例 を 分類スコア の 順 に ソート する こと が 前提条件 で ある が ビン として まとめ ず に 事例ごと に 確率正解 の 場合1 不 正解 の 場合0 を 付ける 点 が 異なる 
0 確率値 は 初期値1 または 0 で 開始 さ れる が 分類スコア と 単調関係 を 保つ よう に なる まで 修正 が 繰り返さ れ 最終的 に 定まっ た 値 を 正解率 と する 表 REF_Isotonic1 を 参照 の 
0 表 の 上段 の 数値斜体 は 各 事例 の 分類スコア下段 の 数値 は 各 事例 の 正解率 を 表す 
0 評価事例 の クラス所属確率 は 評価事例 の 分類スコア と 等しい 分類スコア を もつ 事例 の 正解率 を 参照 し この 値 を 推定値 と する 
0 例えば 訓練事例 により 表 REF_Isotonic1 が 作成 さ れ て いる 場合 に 未知 の 事例 の 分類スコア が 08 で あれ ば この 事例 の クラス所属確率 は 05 で ある と 推定 さ れる 
1 これ まで に 提案 さ れ た 方法 は いずれ も 2値分類 を 想定 し て いる ため に クラス所属確率 の 推定 に は 推定 し たい クラス の 分類スコア のみ を 用いる 
0 したがって 文書分類 で しばしば 用い られる 多値分類 に対して も 分類スコア を 単独 に 用い て 推定 する 2値分類 に 分解 する 方法 が 検討 さ れ た 
0 すなわち 多値分類 を いったん 2値分類 の 組 に 分解 し それぞれ の 組 で 2値分類 として 推定 し た クラス所属確率 の 値 を 最後 に 統合調整 する 
0 多値分類 を 2値分類 に 分解 する に は allpairsoneversusone および oneagainstalloneversusrest の 2 つ の 方法 が ある が Zadroznyら は 分解 する 方法そのもの に 精度 の 違い が ない こと を 実験 により 示し た 上 で 実験 において は いずれ の 場合 も oneagainstall を 用い た 
0 各組 の 2値分類 における 推定値 を 統合 する 方法 として は oneagainstall により 分解 し た 各組クラス の 数 と 等しい において 推定 し た 値 の 合計 が 1 に なる よう に それぞれ の 推定値 を 正規化 する 方法 が よい 結果 を 示し た こと を 報告 し た 
0 また Zadroznyら による 最新 の 統合方法 は さらに 単純 で oneagainstall により 分解 し た 2値分類 の 各組 において 推定 し た クラス所属確率 を そのまま その クラス について の 推定値 と する 
0 多値分類 について の 推定方法 について は Zadroznyら の 研究以外 に なく 例えば Caruanaら による クラス所属確率 の 推定方法 の 比較CITE において も 2値分類 を 対象 と し て おり 多値分類 に対して は Zadroznyら の 文献CITE の 紹介 に とどまっ て いる 
1 しかし 多値分類 は 2値分類 の 場合 と 異なり 予測 さ れる クラス は 分類スコア の 絶対的 な 大き さ で は なく 相対的 な 大き さ により 決定 さ れる ため に クラス所属確率 は 推定 し たい クラス の 分類スコア だけ で なく 他 の クラス の 分類スコア に も 依存 する と 考え られる 
1 したがって 多値分類 において は 推定 し たい クラス以外 の クラス の 分類スコア も 用いる こと が 有効 で ある と 思わ れる 
1 本稿 は 多値分類 における 任意 の クラス について の クラス所属確率 を 複数 の 分類スコア 特に 推定 し たい クラス と 第 1位 の クラス の 分類スコア を 用い て ロジスティック回帰 により 高 精度 に 推定 する 方法 を 提案 する 
1 本稿 で は また 複数 の 分類スコア を 用い て クラス所属確率 を 推定 する 別 の 方法 として 正解率表 表 REF_accuracy_table1 を 参照 の 
0 表 の 最 左列 と 最 上段 の 数値斜体 は それぞれ 第 1位 と 第 2位 に 予測 さ れ た クラス に対する 分類スコア の 範囲それ以外 の 数値 は 第 1位 の クラス について の 正解率 を 表す 
0 を 利用 する 方法 も 提案 する 
1 正解率表 を 利用 する 方法 と は 各 分類スコア の なす 空間 を 等 区間 例えば 05 に 区切っ て セル を 作成 し 各 セル について 正解率 を 計算 し た 表 を 用意 し て 参照 する 方法 で ある 
0 例えば 正解率表 を 利用 する 方法 において 訓練事例 により 表 REF_accuracy_table1 が 作成 さ れ て いる 場合未知 の 事例 において 第 1位 に 予測 さ れ た クラス の 分類スコア が 08 第 2位 に 予測 さ れ た クラス の 分類スコア が MATH で あれ ば この 事例 の 第 1位 の クラス に対する クラス所属確率 は 067 で ある と 推定 さ れる 
0 しかし もし 第 2位 に 予測 さ れ た クラス の 分類スコア が MATH または 03 で あれ ば 第 1位 の クラス について の クラス所属確率 の 推定値 は それぞれ053 または 038 の よう により 小さな 値 に なる 
0 この よう に 提案手法 は 既存 の 方法 と 異なり 推定 し たい クラス所属確率 に 関連 する と 思わ れる 別 の クラス 例えば 第 2位 の クラス の 分類スコア を 直接利用 する こと で より 正確 な 推定 を 行う こと が 可能 に なる 
1 以下次節 で 関連研究 について 述べ た 後3節 で は まず 第 1位 に 予測 さ れ た クラス の クラス所属確率 を 複数 の 分類スコア を 用い て 推定 する 方法 を 提案 し 実験 を 行う 
0 4節 で は 3節 で 得 られ た 結論 を 第 2位以下 の 任意 の クラス に対して 拡張 する 方法 を 提案 し 実験 を 行う 
