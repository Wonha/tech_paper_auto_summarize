実験と考察
\label{sec:exp}

この章では，語順生成の実験をいろいろな角度から分析する．
実験には，京大コーパス(Version 2)
\cite{kurohashi:nlp97} を用いた．
学習には1月1日から8日までと1月10日から6月9日までの17,562文を，
試験には1月9日と6月10日から6月30日までの2,394文を用いた．

\subsection{実験データにおける語順の定義}
\label{sec:exp_data}

ある一つの文節に対しそれに係る文節(係り文節)が複数あるとき，
その係り文節の順序を語順と定義した．
我々が用いた実験データでは，
各文節は係り先(受け文節)の情報を一つだけ持つ．
そして，ある文節$B_{m}$とその受け文節$B_{d}$との間に$B_{d}$と並列の関係にある
文節$B_{p}$がある場合，$B_{p}$にはその受け文節が$B_{d}$であるという情報
とともに並列を表すラベル(P)が付与されている．
これは，文節$B_{m}$が$B_{p}$と$B_{d}$の両方に係り得ることを間接的に示している．
このような場合は文節$B_{m}$が$B_{p}$と$B_{d}$の両方に係るとする．

以上の条件の下では，ある文節$B$の係り文節は以下の手順で同定できる．
\begin{enumerate}
\item $B$を受け文節とする文節は$B$の係り文節とする．
\item $B$にラベルが付与されているとき，
  $B$よりも文頭に近い位置にあり$B$と同じ受け文節を持つ文節は
  $B$の係り文節とする．
\item $B$の係り文節の係り文節うちラベルが付与された文節は
  $B$の係り文節とする．手順(3)を再帰的に繰り返す．
\end{enumerate}
以上の手順で，並列の関係にある文節はすべて同じ文節に係るものとして同定される．
例えば，表~\ref{table:kakari_bunsetsu} の左欄のようなデータからは
それぞれの文節に対し，同表の右欄のような係り文節が得られる．
ここで例えば，「出て，」と「優勝した」が並列の関係にあることから，
「優勝した．」の係り文節である「花子は」は「出て，」にも係る文節として
同定されている．
また，「太郎と」と「花子は」が並列の関係にあることから，
「太郎と」は「花子は」と同じ受け文節に係る文節として同定されている．

  \begin{table*}[htbp]
    \begin{center}
      \caption{実験データから同定される係り文節の例}
      \label{table:kakari_bunsetsu}
      \leavevmode
      \renewcommand{\arraystretch}{}
      \begin{tabular}[c]{|c|c|c|l||l|}
        \hline
        \multicolumn{4}{|c||}{実験データ} 
        & 左欄の各文節を受け文節とする係り文節\\
        \hline
        文節 & 係り先の & ラベル & 文字列 & 係り文節(文節番号) \\
        番号 & 文節番号 & & & \\
        \hline
        0 & 1 & P & 太郎と & \\
        1 & 5 &   & 花子は & 太郎と(0)\\
        2 & 3 &   & テニスの & \\
        3 & 4 &   & 試合に & テニスの(2)\\
        4 & 5 & P & 出て， & 太郎と(0) 花子は(1) 試合に(3)\\
        5 &   &   & 優勝した．& 太郎と(0) 花子は(1) 出て(4)\\
        \hline
      \end{tabular}
    \end{center}
  \end{table*}

\subsection{実験結果}
\label{sec:exp_result}

まず，語順の学習および生成の実験に用いた素性を表~\ref{table:feature1} ，
表~\ref{table:feature2} に示す．
表~\ref{table:feature1} にあげた素性は素性名と素性値から成り，
文節が持ち得る属性の情報，統語情報，文脈情報を表している．
これらを基本素性と呼ぶ．
一方，表~\ref{table:feature2} にあげた素性は基本素性の組み合わせである．
これらの素性は文献\cite{Saeki:98}の「語順を支配する基本条件」を
できるだけ反映するように選んだ．
素性の総数はおよそ19万個である．
そのうち学習には学習コーパスに3回以上観測されたもの51,590個を用いた．

\begin{table}[htbp]
  \scriptsize
  \begin{center}
    \caption{学習に利用した素性(基本素性)}
    \label{table:feature1}
    \leavevmode
    \renewcommand{\arraystretch}{}
    \begin{tabular}[c]{|c|l|l|l|l|l|}
      \hline
      \multicolumn{4}{|c|}{\bf 基本素性} 
      & \multicolumn{2}{|c|}{削除したときの一致度}\\
      \hline
      タイプ & 対象 & 素性名 & 素性値 & 二文節単位 & 完全一致 \\
      & 文節 & & & & \\
      \hline
      \hline
      1 & 係り1，
      & 主辞見出し & (5,066個) & 86.65\% & 73.87\% \\
      & 係り2，& & & ($-$0.79\%) & ($-$1.54\%) \\
      & 受け & & & & \\
      \hline
      2 & 係り1，
      & 主辞品詞(Major) 
      & 動詞 形容詞 名詞 助動詞 接続詞 $\ldots$ & 87.07\% & 75.03\% \\
      & 係り2， & & \q\q\q\q\q\q (11個) & ($-$0.37\%) & ($-$0.38\%) \\
      & 受け & 主辞品詞(Minor) 
      & 普通名詞 サ変名詞 数詞 程度副詞 $\ldots$ & & \\
      & & & \q\q\q\q\q\q (24個) & & \\
      \hline
      3 & 係り1，
      & 主辞活用(Major) & 母音動詞 子音動詞カ行 $\ldots$ & 87.39\% & 75.20\% \\
      & 係り2， & & \q\q\q\q\q\q (30個) & ($-$0.05\%) & ($-$0.21\%) \\
      & 受け & 主辞活用(Minor) & 語幹 基本形 未然形 意志形 命令形 $\ldots$ 
      & & \\
      & & & \q\q\q\q\q\q (60個) & & \\
      \hline
      4 & 係り1，
      & 主辞意味素性(110) & 真 (1個) & 87.21\% & 75.20\% \\
      & 係り2， & 主辞意味素性(111) & 真 (1個) 
      & ($-$0.23\%) & ($-$0.21\%)\\
      & 受け & $\cdots$ & & & \\
      & & 主辞意味素性(433) & 真 (1個) & & \\
      & & (90個) & & & \\
      \hline
      5 & 係り1，
      & 語形(String) & こそ こと そして だけ と に も $\ldots$ 
      & 84.78\% & 70.03\% \\
      & 係り2， & & \q\q\q\q\q\q (73個) & ($-$2.66\%) & ($-$5.38\%) \\
      & 受け & 語形(Major) & 助詞 接尾辞 子音動詞カ行 判定詞 $\ldots$ & & \\
      & & & \q\q\q\q\q\q (43個) & & \\
      & & 語形(Minor) & 格助詞 基本連用形 動詞接頭辞 $\ldots$ & & \\
      & & & \q\q\q\q\q\q (102個) & & \\
      \hline
      6 & 係り1，
      & 助詞1(String) & から まで のみ へ ねえ $\ldots$ & 87.32\% & 75.14\% \\
      & 係り2， & & \q\q\q\q\q\q (63個) & ($-$0.12\%) & ($-$0.27\%) \\
      & 受け & 助詞1(Minor) & (無) 格助詞 副助詞 接続助詞 終助詞 & & \\
      & & & \q\q\q\q\q\q (5個) & & \\
      & & 助詞2(String) & けど まま や よ か $\ldots$ (63個) & & \\
      & & 助詞2(Minor) & 格助詞 副助詞 接続助詞 終助詞 (4個) & & \\
      \hline
      7 & 係り1，
      & 句点の有無 & 無 有 (2個) & 87.39\% & 75.54\% \\
      & 係り2， & & & ($-$0.05\%) & ($+$0.13\%) \\
      & 受け & & & & \\
      \hline
      8 & 係り1，
      & 係り文節数 & A(0) B(1) C(2) D(3以上) (4個) & 87.14\% & 74.86\% \\
      & 係り2 & & & ($-$0.30\%) & ($-$0.55\%) \\
      \cline{2-6}
      & 受け 
      & 係り文節数 & A(2) B(3) C(4以上) (3個) & 87.40\% & 75.35\% \\
      & & & & ($-$0.04\%) & ($-$0.06\%) \\
      \hline
      9 & 係り1，
      & 並列 & P(並列) A(同格) D(それ以外) (3個) & 86.26\% & 73.61\% \\
      & 係り2， & & & ($-$1.18\%) & ($-$1.80\%) \\
      & 受け & & & & \\
      \hline
      10 & 係り1，
      & 係り語形1と語形2が一致 & 真 偽 (2個) & 87.34\% & 75.09\% \\
      & 係り2 & 係り語形2と語形1 & 真 偽 (2個) & ($-$0.10\%) & ($-$0.32\%) \\
      & & が一致 & & & \\
      & & 係り語形1と係り語形2 & 真 偽 (2個) & & \\
      & & が一致 & & & \\
      \hline
      11 & 係り1，
      & 主辞見出しが既出 & 真 偽 (2個) & 87.31\% & 75.14\% \\
      & 係り2， & 係り文節主辞見出しが既出 & 真 偽 (2個) 
      & ($-$0.13\%) & ($-$0.27\%) \\
      & 受け & & & & \\
      \hline
      12 & 係り1，
      & 文脈指示語の有無 & 無 有 (2個) & 87.27\% & 75.12\% \\
      & 係り2 & 文脈指示語(String) & この これ こんな そこ その それ 
      $\ldots$ & ($-$0.17\%) & ($-$0.29\%) \\
      & & & \q\q\q\q\q\q (42個) & & \\
      \hline
    \end{tabular}
  \end{center}
\end{table}

\begin{table}[htb]
  \begin{center}
    \caption{学習に利用した素性(基本素性の組み合わせ)}
    \label{table:feature2}
    \leavevmode
    \renewcommand{\arraystretch}{}
    \begin{tabular}[c]{|l|c|c|}
      \hline
      \multicolumn{1}{|c|}{\bf 基本素性の組み合わせ} 
      & \multicolumn{2}{|c|}{削除したときの一致率}\\
      \cline{2-3}
      \multicolumn{1}{|c|}{} & 二文節単位 & 完全一致\\
      \hline
      \multicolumn{1}{|c|}{二素性} & 87.23\% & 74.65\% \\
      \cline{1-1}
      (係り1:語形, 係り2:語形), & ($-$0.21\%) & ($-$0.76\%) \\
      (係り1:語形, 受け:主辞見出し), & & \\
      (係り1:語形, 受け:主辞品詞), & & \\
      (係り1:語形, 係り1:並列), & & \\ 
      (係り1:語形, 係り語形2と語形1が一致), & & \\ 
      (係り2:語形, 受け:主辞見出し), & & \\
      (係り2:語形, 受け:主辞品詞), & & \\
      (係り2:語形, 係り2:並列), & & \\ 
      (係り2:語形, 係り語形1と語形2が一致), & & \\
      (係り1:主辞見出し, 受け:句点の有無), & & \\
      (係り1:主辞品詞, 受け:句点の有無), & & \\
      (係り1:主辞品詞, 係り1:主辞見出しが既出), & & \\
      (係り2:主辞見出し, 受け:句点の有無), & & \\
      (係り2:主辞品詞, 受け:句点の有無), & & \\
      (係り2:主辞品詞, 係り2:主辞見出しが既出) & & \\
      \hline
      \multicolumn{1}{|c|}{三素性} & 87.22\% & 74.86\% \\ 
      \cline{1-1}
      (係り1:語形, 係り2:語形, 受け:主辞見出し), 
      & ($-$0.22\%) & ($-$0.55\%) \\
      (係り1:語形, 係り2:語形, 受け:主辞品詞), & & \\
      (係り1:語形, 係り1:並列, 受け:語形), & & \\ 
      (係り2:語形, 係り2:並列, 受け:語形), & & \\ 
      (係り1:助詞1, 係り1:助詞2, 受け:主辞見出し), & & \\
      (係り1:助詞1, 係り1:助詞2, 受け:主辞品詞), & & \\
      (係り2:助詞1, 係り2:助詞2, 受け:主辞見出し), & & \\
      (係り2:助詞1, 係り2:助詞2, 受け:主辞品詞) & & \\
      \hline
      \multicolumn{1}{|c|}{上記すべての組み合わせ素性} 
      & 85.79\% & 71.67\% \\
      & ($-$1.65\%) & ($-$3.74\%) \\
      \hline
    \end{tabular}
  \end{center}
\end{table}

表~\ref{table:feature1} ，表~\ref{table:feature2} の素性名で使われている
用語の意味は以下の通りである．
\begin{description}
\item[係り1・係り2・受け] \ref{sec:word_order_model}~節で述べた語順モデルでは，
  ある文節に係る文節を二つずつ取り上げて並べその順序が適切である確率を求める．
  その際の受け文節を「受け」，二つ取り上げて並べた係り文節を前から順に
  「係り1」，「係り2」と呼ぶ．
\item[主辞] 各文節内で，品詞の大分類が特殊，助詞，接尾辞となるもの
  \footnote{これらの品詞分類はJUMAN\cite{JUMAN3.5}のものに従う．}
  を除き，最も文末に近い形態素．
\item[主辞見出し] 主辞の基本型(単語)．
  素性値として用いる単語は，主辞の見出し語として学習コーパスに
  5回以上出現したものとする．
\item[意味素性] 「分類語彙表」\cite{NLRI64aj}
  の上位から3レベル目の階層を意味素性として用いる．
  「分類語彙表」は日本語シソーラスの一つであり，
  7レベルの階層からなる木構造で表現される．
  木構造の葉の部分には単語が割り振られており，
  各単語には分類番号という数字が付与されている．
  表~\ref{table:feature1} で例えば「主辞意味素性(110)」の括弧内の数字は
  その分類番号の上位3桁を表す．「主辞意味素性(110):真」という素性は，
  主辞の単語に付与された分類番号の上位3桁が110であることを意味する．
\item[語形] 各文節内で，特殊を除き最も文末に近い形態素．
  もしそれが助詞，接尾辞以外の形態素で活用型，活用形
  \footnote{JUMANの活用型，活用形に従う．}
  を持つものである場合はその活用部分とする
  \footnote{
    語形は基本的に活用部分を指すが，単独の名詞，副詞などからなる文節
    の場合には語形部分なしとするのではなく主辞と同じであると定義する．
    }~．
\item[語形1・語形2] それぞれ係り1，係り2の語形のこと．
\item[助詞1・助詞2] 各文節内で，一番文末に近い助詞を「助詞1」，
  その次に文末に近い助詞を「助詞2」とする．
\item[係り語形1・係り語形2] それぞれ係り1，係り2の係り語形のこと．
  係り語形は係り文節に係っている文節の語形であると定義する．
\item[主辞見出しが既出] 前の文に同じ主辞見出しが出現していること．
\item[文脈指示語] 着目している文節あるいはその係り文節に現れる指示語のこと．
\end{description}

表~\ref{table:feature1} でタイプ1からタイプ6までは文節内の属性を表し，
タイプ7からタイプ10までは統語的な情報を表す．
タイプ11とタイプ12は文脈的な情報を表す．

\begin{table}[htb]
  \begin{center}
    \caption{実験結果}
    \label{Result} 
    \begin{tabular}{|l@{ }|c@{ }|c@{ }|}
      \hline
      & 一致率(二文節単位) & 一致率(完全一致)\\
      \hline      
      本手法 & 87.44\% (12,361/14,137) & 75.41\% (3,980/5,278)\\
      ベースライン1 & 48.96\% (6,921/14,137) & 33.10\% (1,747/5,278)\\
      ベースライン2 & 49.20\% (6,956/14,137) & 33.84\% (1,786/5,278)\\
      \hline
    \end{tabular}
  \end{center}
\end{table}
次に我々の解析結果を表~\ref{Result} に示す．
第1行は京大コーパス1月9日と6月10日から6月30日までの2,394文のうち
係り文節を二つ以上持つ文節5,278文節に対して，
その係り受け関係にある文節およびそれらの文節に関して
コーパスから得られる形態素情報，文節区切り情報，統語情報，文脈情報を入力とし，
語順を生成させたときの結果である．ただし，統語情報としては
係り受けが並列あるいは同格の関係にあるかどうかおよび
文末であるかどうかの情報のみを与える．
また，文脈情報としては生成の対象となっている文節を含む文の前の文を与える．
ベースライン1としてはランダムに選んだ場合の一致率をあげた．
ベースライン2としては，語順モデルの式(\ref{eq:p1})の代わりに
次の式を用いたときの一致率をあげた．
\begin{eqnarray}
  \label{eq:base2}
  p^{*}(1|b) & = & \frac{freq(w_{12})}{freq(w_{12})+freq(w_{21})}
\end{eqnarray}
ここで，$freq(w_{12})$，$freq(w_{21})$は，
係り文節$B_1$と$B_2$の語形の見出し語を$w_1$，$w_2$，
受け文節$B$の主辞見出しを$w$とするとき，これらが
毎日新聞91年から97年のテキストにおいてそれぞれ「$w_1$／$w_2$／$w$」，
「$w_2$／$w_1$／$w$」の順に現れた頻度を表す
\footnote{
  ただし，
  $w_1$と$w_2$が同じときは係り文節$B_1$と$B_2$の主辞見出しを
  それぞれ$w_1$と$w_2$とした．
  また，一方の頻度が0でもう一方の頻度が5以下の場合は
  $freq(w_{12})$，$freq(w_{21})$としてそれぞれ，
  「$w_1$／$w_2$」，「$w_2$／$w_1$」の順に現れた頻度を用いた．
  さらに$freq(w_{12})$，$freq(w_{21})$がいずれも0のときは0から1までの
  乱数値を与えた．
  }．
式(\ref{eq:base2})を用いると例えば，
「太郎は／テニスを／した．」の場合，「は／を／した」の順に
現れる頻度と「を／は／した」の順に現れる頻度を調べ，頻度が大きい並びを
解とすることになる．

\subsection{素性と一致率}
\label{sec:feature_and_accuracy}

この節では，我々が実験で用いた素性が一致率の向上にどの程度
貢献しているかを示す．

\ref{sec:exp_result}~節にあげた表~\ref{table:feature1} ，
表~\ref{table:feature2} の右欄には，
それぞれの素性を削除したときの一致率と削除したことによる一致率の増減を
示してある．
基本素性を削るときは，それを含む組み合わせの素性も一緒に削った．
最も一致率の増加に貢献していると考えられるのは，語形の情報である．
語形は主に格や活用形を表す部分であり，この部分の情報によって
最も語順が影響を受けているという結果は人間の直観とも合っている．

我々が実験に用いた素性は，
言語学的な研究において「語順を支配する基本条件」とされているものを
できるだけ反映したものである．
その条件がどの程度一致率に影響しているかを示すために，
表~\ref{table:feature1} ，表~\ref{table:feature2} に
素性のまとまりごとにその素性を削除したときの一致率を示した．
しかし，「は」「を」などの助詞をひとまとまりとして削除しているなど，
削除する単位が言語学的に興味のある情報よりも粗い可能性がある．
そのような場合には，興味のある要素に対応する素性のみ，
例えば助詞の「は」のみについて，
その素性を削除したときとしなかったときの一致率を比べることにより，
その重要性を定量的に検証することが可能である．
さらに新たな言語学的成果に対してもそれに対応するような素性を追加して
一致率に有意な増加がみられるかどうかを調べることにより，
同様に検証することができると考えられる．

\subsection{学習コーパスと一致率}
\label{sec:corpus_and_accuracy}

この節では，学習コーパスと一致率の関係について考察する．
まず，図~\ref{fig:learning_curve1} ，
図~\ref{fig:learning_curve2} に学習コーパスの量と一致率の関係をあげる．
これらの図には学習コーパスとテストコーパスのそれぞれを解析した場合の
コーパスの量と一致率の関係を載せている．
学習コーパスに対する実験としては基本的に
京大コーパス1月1日の1,172文を用いた．
学習コーパスが250文，500文のときは1月1日の1,172文のうち
上から250文，500文を用いた．

\begin{figure}[htbp]
  \begin{center}
    \leavevmode
    \epsfile{file=learning1.eps,height=8cm}
\vspace{5mm}
    \caption{学習コーパスの量と一致率(二文節単位)の関係}
    \label{fig:learning_curve1}
  \end{center}
\end{figure}
\begin{figure}[htbp]
  \begin{center}
    \leavevmode
    \epsfile{file=learning2.eps,height=8cm}
\vspace{5mm}
    \caption{学習コーパスの量と一致率(完全一致)の関係}
    \label{fig:learning_curve2}
  \end{center}
\end{figure}

学習コーパスが250文という少ない量でもテストコーパスに対して
二文節単位で82.54\%，完全一致で68.40\%の一致率となっている．
これはベースラインよりもかなり高い一致率である．
この結果は，学習コーパスの量が少なくても
新聞記事に対してはある程度語順の傾向を学習できることを示している．

学習コーパスが17,562文のとき，一致率は完全一致で75.41\%である．
テストコーパスと一致しなかった残りの約25\%のうちいくつかは
学習がうまくできなかったものであり，
残りは語順が比較的自由なもので必ずしもコーパスと一致しなくてもよいもの
であると考えられる．
前者に対しては
誤りを分析して，語順の傾向を効率良く学習する素性をもっと補う必要がある．
そこで，テストコーパスに対する結果を調査した．
係り文節の語順がテストコーパスと一致しなかった1,298文節から，
ランダムに100文節を選び分析した．
そのうち，システムが生成した語順でも不自然ではないものが48個，
不自然なものが52個であった．
この不自然なものがテストコーパスの語順と一致するようになるには，
大量の学習コーパス，および表~\ref{table:feature1} ，表~\ref{table:feature2} に
あげたものとは性質の異なる素性が必要である．
学習コーパスが不十分であると思われるものの中には，
「法治国家が／聞いて／あきれる」，
「創案したのが／そもそもの／始まり」，
「味に／精魂／込める」
などイディオム的な表現を含むものが多かった．
コーパスの量が増えればこのような表現に対しては適切な語順が
学習される可能性が高い．
新たな素性を考慮するべきであると思われるものの中には，
並列関係を含むものが目立った．
これについては今後の言語学的な知見なども考慮しながら有効そうな素性を
追加したい．

今回素性として用いた意味素性および文脈指示語や承前反復語は，
意味解析，文脈解析をした結果を基にしている訳ではない．
これらをより有効に利用できるようにするためには，
意味タグや文脈タグなどが付与されたコーパスおよび
意味解析システムや文脈解析システムを統合して用いていく必要がある．

\subsection{生コーパスからの学習}
\label{sec:raw_corpus}

正しい語順の情報はテキスト上に保存されているため，
学習コーパスは必ずしもタグ付きである必要はなく，
生コーパスに対し既存のシステムを用いて解析した結果を学習に用いることもできる．
本節では，タグ付きコーパスと生コーパスを用いて，あるいは生コーパスのみを用いて
学習したときにどの程度の一致率が得られるかについて実験結果を示し考察する．
生コーパスとしては毎日新聞1994年版の最初の200,000文と，
京大コーパスの1月1日から8日までと1月10日から6月9日までの17,562文，
合計217,562文を用いた．このうち京大コーパスの17,562文はタグの付与されていない
原文を用いた．
生コーパスに対しては，
そこから素性の情報を得るために形態素解析，構文解析を行なう．
形態素解析にはJUMAN，構文解析にはKNP\cite{KNP2.0b6}を用いた．
JUMANは形態素区切りおよび品詞の付与の精度が98\%程度，
KNPは係り受け単位の精度が90\%程度である．
これらはいずれも新聞記事に対する精度である．

テストコーパスに対する一致率は，学習コーパスとして
生コーパスのみ217,562文を用いた場合，
二文節単位で87.64\%，完全一致で75.77\%であり，
学習コーパスとして生コーパス(毎日新聞1994年版の最初の200,000文)と
タグ付コーパス(京大コーパスの17,562文)合計217,562文を用いた場合，
二文節単位で87.66\%，完全一致で75.88\%であった．
いずれの場合もタグ付コーパスのみ17,562文を用いたときに比べて，
0.2\%から0.5\%程度一致率が増加した．
この結果から，タグ付きコーパスが少ない場合は，
既存の解析システムの精度が90\%程度であれば
生コーパスのみでも学習コーパスとして十分に役割を果たすことが分かる．
またこの結果は語順の学習はシステムの解析誤りの影響をあまり受けないということを
示していると言える．

