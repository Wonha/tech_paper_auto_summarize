ここで想定している音声対話システムの構成を図[REF_fig-system]に示す．
システムは，音声理解，発話生成，対話制御を行う各モジュールとデータベースから構成される．
データベースの内容は一定ではなく，日々内容が更新されるようなタスクを想定する．
音声理解モジュールはユーザ音声からユーザ発話内容を理解し，理解した結果はシステム理解状態として保持される．
対話制御モジュールは，以下に述べるように，システム理解状態と現在のデータベースの内容に基づいて，システム行動を決定する．
発話生成モジュールは，対話制御モジュールの決定にしたがって，システム応答の言語表現を生成し，音声として出力する．
音声対話システムとユーザの対話は，ユーザ要求確定フェーズとシステム情報伝達フェーズという2つの対話フェーズの間を移行しながら進行する．
ユーザ要求確定フェーズにおいて，ユーザはシステムに対する要求を音声によって伝える．
システムとユーザは確認対話を通してユーザ要求内容を確定する．
ユーザ要求内容を確定した後，対話はシステム情報伝達フェーズに移行し，確定したユーザ要求にしたがって情報を伝達するためのシステム応答が生成される．
システム理解状態は，3つ組[MATH]属性，値，確定フラグ[MATH]の集合として保持される．
ユーザ要求タイプの種類と属性の全体集合はタスクごとに決まっている．
各ユーザ要求タイプについて，ユーザ要求の内容として含むことができる属性と，各属性がとりうる値の範囲が決まっている．
各ユーザ要求タイプについて，ユーザ要求内容として含むことができる属性を有効な属性，値としてとりうる属性値を有効な属性値とよぶ．
有効でない属性，属性値を無効な属性，属性値とよぶ．
確定フラグは，属性の値が確認対話により確定するまで「未」という値をとり，確認対話により確定されると「済」という値をとる．
ユーザ要求確定フェーズでは，システム理解状態にしたがって，確認行動，情報要求行動のいずれかのシステム行動を行う．
確認行動とは，システム理解状態において値が与えられている属性について，ユーザに対して属性値を確認する発話（確認発話）を行い，「はい」といったユーザの肯定的な発話(承認発話)によって属性値が確定されるまで，その属性の値の確認を繰り返すという行動である．
ユーザは，承認発話以外に，システムの確認内容を訂正する発話(訂正発話)を行うことができる．
情報要求行動とは，システム理解状態において値が与えられていない属性について，ユーザに対して属性の値を要求する発話（情報要求発話）を行い，その後，その属性についての確認行動を実施するという行動である．
すなわち，情報要求行動とは一つの情報要求発話に続く確認発話の繰り返しである．
ユーザ要求確定フェーズにおいて，ユーザ要求タイプが一意に決定されており，その時点で確定しているユーザ要求内容にしたがってシステム応答を生成することが適切であると判断されると，システム情報伝達フェーズに移行する．
システム情報伝達フェーズにおいて，確定済みのユーザ要求内容に応じて情報をユーザに伝達するためにシステム応答を生成するという行動を情報伝達行動と呼ぶ．
対話制御とは，対話の各時点において，対話を効率的に実施するという観点から最適なシステム行動を決定することである．
システム行動としては，確認行動，情報要求行動，情報伝達行動がある．
情報伝達行動を選択するということは，ユーザ要求確定フェーズからシステム情報伝達フェーズへの移行を決定することと同等である．
本稿では気象情報案内を行う音声対話システムを想定する．
ユーザ要求タイプとして，警報問い合わせ，天気問い合わせ，気温問い合わせ，降水確率問い合わせの4種類のユーザ要求タイプを考える．
属性の全体集合は，場所，日，警報種別，情報種別の4つの属性から成る集合である．
ユーザ要求タイプと属性との間の関係を表[REF_tab-task]に示す．
各ユーザ要求タイプについて，有効な属性を◯，無効な属性を×で示している．
場所属性は，どのユーザ要求タイプでも有効な属性であり，特定の場所の名前を値としてとる．
日属性は，ユーザ要求タイプが天気，気温，降水確率の問い合わせであるなら，今日か明日という値をとる．
警報問い合わせでは，日属性は無効な属性である．
警報種別属性は，大雨，洪水といった値をとり，天気問い合わせ，気温問い合わせ，降水確率問い合わせの各ユーザ要求タイプにとっては無効な属性である．
情報種別属性は，ユーザ要求タイプに応じて，警報，天気，気温，降水確率という値をとる．
警報という属性値は，ユーザ要求タイプが警報問い合わせであるときにのみ有効であり，他のユーザ要求タイプでは無効である．
天気，気温，降水確率という属性値についても，同様である．
たとえば，ユーザ要求確定フェーズにおいて，ユーザが神奈川県という場所を指定したとシステムが理解したという状況を想定すると，システム理解状態は次のようになる．
ここで，システムがとりうる行動として，場所属性についての確認行動と，情報種別属性についての情報要求行動を考える．
まず，場所属性についての確認行動をとるとすると，システムは「神奈川県ですか？」といった確認発話を行う．
システムは，ユーザが肯定的な応答で承認したとシステムが認識するまで，場所属性の値の確認を続ける．
[MATH]におけるシステム確認発話「神奈川県ですか？」に対して，ユーザが肯定発話で応じたとき，システム理解状態は次のようになる．
あるいは，[MATH]において，情報種別属性についての情報要求行動をとるとすると，システムは「お尋ねの情報種別は何ですか?」，「天気についてお尋ねですか?」といった情報要求発話を行う．
ユーザは情報種別属性の値を伝達する．
その後，システムは確認発話によって情報種別属性の値を確定していく．
ユーザが知りたい情報種別が警報であったとすると，情報要求行動が完了したときのシステム理解状態は次のようになる．
デュアルコスト法は，対話の効率を確認コストと情報伝達コストの和として計量し，2つのコストの和を最小化することにより，対話を制御する方法である．
確認コストと情報伝達コストの和を対話コストと呼ぶ．
確認コストはユーザ要求確定フェーズにおける確認対話の長さの期待値と定義し，情報伝達コストはシステム情報伝達フェーズにおけるシステム応答の長さの期待値と定義する．
確認コスト，情報伝達コストという2種類のコストを導入するのは，できるだけ短い対話で，ユーザが必要とする情報を伝達するためには，確認対話の長さだけでなく，それに続くシステム応答の長さも考慮する必要があるためである．
たとえば，ユーザ要求タイプが警報問い合わせであり，現在のデータベースの内容が，多くの場所に警報が発表されているという内容である場合を想定する．
この場合，ユーザが関心のある場所について確認対話を行わないとすると，システム応答が極端に長くなってしまう．
ユーザが関心のある場所を確定することによって，対話全体を短くすることができるので，場所についての確認は行う価値があると言える．
しかし，どこにも警報が発表されていない，あるいは，ごく少数の場所にしか警報が発表されていないというデータベースの内容である場合には，場所の確認を行わなくても，システム応答が極端に長くなることはなく，むしろ場所の確認を行わないことで，対話全体を短く済ますことができる可能性がある．
このように，システムのデータベースの内容に応じて，最も短い対話でユーザが要求する情報を伝達するためには，確認コストという確認対話の長さの期待値と情報伝達コストというシステム応答の長さの期待値の双方を考慮する必要がある．
デュアルコスト法の対話制御手順を説明する．
ユーザ要求確定フェーズにおいて，現時点のシステム理解状態で確定済となっている属性値が無効となるようなユーザ要求タイプを排除することにより，現時点で可能なユーザ要求タイプを導き出す．
可能なユーザ要求タイプごとに，可能な対話プランをすべて生成する．
対話プランとは，[REF_sec-plan]節で説明するように，ユーザ要求内容を確定するために確認行動と情報要求行動を繰り返し，その後，確定されたユーザ要求内容にしたがって情報伝達行動を実行するという一連の手順を記述したものである．
ユーザ要求タイプごとに，各対話プランの確認コストと情報伝達コストを計算し，対話コスト(確認コストと情報伝達コストの和)が最小となるような対話プランを選択する．
そのプランを各ユーザ要求タイプの最適プランと呼び，最適プランの対話コストを各ユーザ要求タイプの最適コストと呼ぶ．
ここで，ユーザ要求タイプが一意に決まっている場合には，その最適プランにしたがって，システム行動を選択すればよい．
問題となるのは，現在のシステム理解状態からはユーザ要求タイプが曖昧で一意に決めることができない場合である．
この場合に対処するために，システム行動の損失という概念を導入する．
一つのユーザ要求タイプを仮定するとき，システム行動の損失とは，その行動をとったがゆえに，ユーザ要求タイプの最適コストと比較して余計に費すことになるコストであると定義する．
その行動が最適プランに沿ったものであるならば，損失は[MATH]であるが，さもなければ，損失は正値をとる．
損失という概念を用いて，次の手順に進む．
現時点で実行可能なシステム行動をすべて生成し，ユーザ要求タイプごとに各システム行動の損失を計算する．
ユーザ要求タイプの確率分布に基づいて，各システム行動の損失の期待値を計算する．
損失の期待値を期待損失とよぶ．
最小の期待損失をもつシステム行動を選択する．
選択されたシステム行動を実行し，ユーザからの応答を待って，システム理解状態を更新する．
ユーザ要求タイプが一意に決まっており，これ以上システム行動を実施しても対話コストが下がらないなら，システム情報伝達フェーズに移行する．
さもなければ，(Step1)に戻る．
以下においては，例として，ユーザが場所属性を神奈川県と指定したとシステムが認識したという状況を考える．
この状況は，ユーザが「神奈川県」とだけ発話したとシステムが認識した場合に相当する．
システム理解状態は，[REF_sec-system]節で示した[MATH]によって表される．
[MATH]から導き出されるユーザ要求タイプは曖昧であり，警報問い合わせ，天気問い合わせ，気温問い合わせ，降水確率問い合わせの4つの要求タイプが導き出される．
また，システム知識の内容は，どの場所にも警報は発表されていないという内容であるとする．
システムの対話プランとは，確認行動と情報要求行動の任意回の繰り返しと，それに続く一つの情報伝達行動から成る．
(Step1)では，現在のシステム理解状態から可能なユーザ要求タイプを導出した後，ユーザ要求タイプの各々について，可能な対話プランを網羅的に生成する．
そのために，まず，各ユーザ要求タイプについて有効な属性を選びだし，有効な属性の中で既に値が確定したものを除いた残りの属性に注目する．
それらの属性すべての値を確定するための対話プランとして，次の条件を満たす確認行動，情報要求行動，情報伝達行動から成るプランを網羅的に生成する．
ただし，一つのプランの中で，一つの属性が異なる確認行動や情報要求行動の対象になることはないものとする．
システム理解状態で値が与えられている属性の部分集合[MATH]について，[MATH]に含まれるすべての属性の値を確定するための確認行動．
システム理解状態で値が与えられていない1つの属性について，その属性の値を確定するための情報要求行動．
プランに含まれるすべての確認行動と情報要求行動によってユーザ要求内容が確定したと仮定したときに，確定した要求内容に応じてユーザに対し情報を伝達するための情報伝達行動．
本稿では，属性を確認する順序によって確認コストは変わらないと仮定する．
したがって，プランの中の確認行動と情報伝達行動の順序を入れ換えても確認コストは変わらない．
情報伝達行動の生成は，ユーザ要求内容が確定したと仮定した上で，データベースを検索し，ユーザ要求内容に対するシステム応答内容を仮想的に生成することによって行う．
例として，システム理解状態[MATH]の下での対話プランについて考える．
まず，ユーザ要求タイプが警報問い合わせの場合を想定する．
可能な対話プランは多数あるが，簡単のため，情報種別を確認してから応答を行うプラン[MATH]と，場所と情報種別を確認してから応答を行うプラン[MATH]に注目する．
2つのプランは次のように表記される．
[MATH]は，行動[MATH]に続いて行動[MATH]を実行することを意味する．
:= [MATH]
:= [MATH]
ただし，
:=情報種別属性についての情報要求行動
:=場所属性についての確認行動
:=どこにも警報が発表されていないことを伝達するための情報伝達行動．
:=確定された場所には警報が発表されていないことを伝達するための情報伝達行動．
ユーザ要求タイプが天気問い合わせ，気温問い合わせ，降水確率問い合わせの場合に，次の対話プランを考える．
:= [MATH],
ただし，
:=日属性についての情報要求行動．
:=確定された場所，日における天気(あるいは，気温，降水確率)を伝達するための情報伝達行動．
確認コストを計算するために，まず，一つの確認行動あるいは情報要求行動が完了するまでに要するターン数の期待値について考える．
一つのターンは，システムの確認発話(例：「神奈川県ですか?」)あるいは情報要求発話(例：「いつですか?」)と，ユーザの訂正発話(例：「香川県です」)あるいは承認発話(例：「はい」)から成るとする．
システムが各属性の値を正しく認識する確率を属性認識率とよぶ．
属性認識率は[MATH]よりも大きく，[MATH]よりも小さな値であり，前もって与えられていることを前提とする．
また，属性の集合が与えられるとき，その集合に含まれるすべての属性の値を一度に正しく認識する確率を属性集合の認識率とび，各属性の属性認識率の積として計算できるものとする．
また，システムはユーザの承認発話を常に正しく認識できるものと仮定する．
属性の集合が与えられるとき，その集合に含まれるすべての属性の値を確定するための確認行動について考える．
システムとユーザの対話は，システムがすべての属性値を一度に提示することにより確認発話を行い，システムが提示した属性の値が一つでも誤っているなら，ユーザはすべての属性値を提示することにより訂正発話を行うというターンを繰り返していき，システムの提示する属性値がすべて正しければ，ユーザは承認発話を行い，そこで確認行動が完了するという動作系列であると仮定する．
属性集合の認識率を[MATH]とするとき，確認行動が完了するまでのターン数の期待値は，次の式で与えられる[CITE]．
情報要求行動は，属性の値が与えられていないときに，最初に情報要求発話を1回行い，その後は確認行動と同じ動作系列をとる．
したがって，情報要求行動が完了するまでのターン数の期待値は，次の式で与えられる．
次に，確認行動，情報要求行動の長さについて考える．
各行動の長さは，行動を遂行するために要する各ターンに含まれるシステム発話とユーザ発話の長さの和である．
ここでは，確認発話，情報要求発話，訂正発話においては，一つの属性が一つの名詞句として実現されると仮定し，発話の長さを発話に含まれる名詞句の延べ数と定義する．
また，承認発話は，1個の肯定的な応答表現(例：「はい」)によって実現されると仮定し，その長さを1と定義する．
まず，確認行動の長さについて考える．
確認すべき属性の数を[MATH]個とすると，システム確認発話，ユーザの訂正発話においては，常にすべての属性値が言及されると仮定しているので，最後の1回を除くターンには，長さ[MATH]のシステム確認発話，長さ[MATH]のユーザ訂正発話が含まれ，最後1回のターンには，長さ[MATH]のシステム確認発話，長さ[MATH]のユーザ承認発話が含まれることになる．
したがって，一つの確認行動の長さは，次の式で定義される．
次に，一つの情報要求行動の長さは，次の式で定義される．
確認行動と情報要求行動の長さの定義に基づいて，対話プランの確認コストは，対話プランに含まれるすべての確認行動と情報伝達行動の長さの和と定義する．
次に，情報伝達コストの算出について説明する．
情報伝達コストは，情報伝達行動を実施するために生成されるシステム応答の長さの期待値であるとする．
システム応答の長さは，応答に含まれる内容語の延べ数の期待値であると定義する．
たとえば，情報伝達行動が「警報はどこにも発表されていない」というシステム応答として実行されるなら，内容語として，「警報」，「どこにも」，「発表されていない」の3つの内容語を含むので，情報伝達コストは3となる．
対話プランによっては，確認行動や情報要求行動によって確定される属性の値が複数通りあり，対話を実際に行ってみないことには値が決まらず，情報伝達行動として生成されるシステム応答も一意に決まらないという場合がある．
こういった場合には，属性がとりうる値の生起確率は等確率であると仮定した上で，すべての値の組合せを考慮したときのシステム応答の長さの期待値が情報伝達コストであると定義する．
たとえば，プラン[MATH]では，場所属性，日属性の値は，実際に対話を行ってみないと決まらない．
[MATH]の情報伝達コストは，場所属性，日属性のとりえる値のすべての組合せを考慮したときのシステム応答の長さの期待値となる．
(Step2)では，[REF_sec-cost]節で説明したコスト計算方法にしたがって，各対話プランの対話コストが計算される．
今取り上げている例において，ユーザ要求タイプが警報問い合わせである場合を考える．
各属性の認識率は0.8であるとする．
[MATH]の確認コストは，[MATH]の長さと等しい．
[MATH]によって，確認コストは，[MATH]となる．
[MATH]は，「どこにも警報は発表されていない」という応答文で実行されると仮定する．
情報伝達コストは3となる．
したがって，[MATH]の対話コストは[MATH]となる．
[MATH]の確認コストは，[MATH]と[MATH]の長さの和である．
[MATH]の長さは[MATH]，[MATH]の長さは[MATH]であるので，確認コストは[MATH]となる．
確認行動によって確定する場所属性の値を[MATH]とするとき，[MATH]は「[MATH]には警報は発表されていません」という応答文で実行されると仮定する．
情報伝達コストは[MATH]となる．
したがって，[MATH]の対話コストは[MATH]となる．
結局，最適プランは[MATH]であり，最適コストは[MATH]である．
次に，ユーザ要求タイプが天気問い合わせである場合を考える．
ここでは，簡単のため，[MATH]が最適プランであると仮定する．
これは，天気問い合わせの場合は，場所や日が未定であると，すべての場所や日についての天気情報を伝達しなければならず，情報伝達コストが極端に増大すると考えるのが自然であるからである．
また，属性を確認する順序によって確認コストは変わらないと仮定しているので，[MATH]に含まれる確認行動，情報伝達行動の順序を入れ換えたプランも最適プランとなる．
最適プラン[MATH]の確認コストは，[MATH]となる．
応答文は「晴れです」といった文であると仮定する．
情報伝達コストは[MATH]となる．
したがって，最適コストは[MATH]となる．
同様に，気温問い合わせ，降水確率問い合わせの場合も，最適プランは[MATH]と[MATH]に含まれる確認行動と情報伝達行動の順序を入れ換えた対話プランであると考える．
なお，ここでは，簡単のため[MATH]が最適プランであると仮定しているが，システムのデータベースに登録されている場所の数が少ない場合には，場所属性についての確認を行わないで，すべての場所の天気情報をユーザに対し伝達するという対話プランが最適プランになることもありえる．
(Step3)では，各ユーザ要求タイプごとにシステム行動の損失が計算される．
システム行動[MATH]の損失を計算するためには，まず，システム行動[MATH]を含むような対話プランで，最小の対話コストをもつプランが探索される．
そのプランをシステム行動[MATH]のための準最適プランとよび，その対話コストを準最適コストとよぶ．
システム行動[MATH]の損失は最適コストと準最適コストの差であると定義する．
例として，[MATH]と[MATH]の2つの行動に注目する．
警報問い合わせに関して，[MATH]の準最適プランは，最適プラン[MATH]に等しく，[MATH]の損失は0である．
[MATH]の準最適プランが[MATH]であるとすると，[MATH]の損失は[MATH]となる．
天気問い合わせ，気温問い合わせ，降水確率問い合わせに関しては，最適プラン[MATH]の中に[MATH]，[MATH]が含まれているので，[MATH]，[MATH]の損失はいずれも0となる．
次に，(Step4)において期待損失が計算される．
今取り上げている例では，ユーザ要求タイプの確率分布によらず，[MATH]の期待損失は0であり，[MATH]の期待損失は正値をとるので，[MATH]が次のシステム行動として選択される．
すなわち，ユーザが「神奈川県」といった発話を行ったとシステムが認識した場合には，対話全体を効率的に進めるという観点からは，「神奈川県ですか?」と場所の確認をするのではなく，「どういった情報をお尋ねですか?」，「天気についてお尋ねですか?」といった情報種別を要求する発話を行うことが望ましい．
さらに複雑な例においては，期待損失を計算するためにユーザ要求タイプの確率分布が必要となる．
ここでは，ユーザ要求タイプのシステム理解状態に対する適切度[CITE]という概念に基づいて，ユーザ要求タイプの確率分布を近似的に求める．
現在のシステム理解状態において，各属性[MATH]が値[MATH]をとっており，各属性の属性認識率は[MATH]であるとする．
このシステム理解状態から導かれる可能なユーザ要求タイプが[MATH]であるとする．
このとき，ユーザ要求タイプ[MATH]として有効な属性の個数を[MATH]，属性値[MATH]が有効となるようなユーザ要求タイプの個数を[MATH]とするとき，ユーザ要求タイプ[MATH]の現在のシステム理解状態に対する適切度[MATH]を次のように定義する．
デュアルコスト法は，各ユーザ要求タイプの適切度を正規化したものをユーザ要求タイプの確率分布として用いている．
例として取り上げているシステム理解状態[MATH]では，各ユーザ要求タイプの確率は等確率で[MATH]となる．
したがって，[MATH]の期待損失は[MATH]，[MATH]の期待損失は[MATH]となる．
