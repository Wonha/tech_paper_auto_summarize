一般に，解析器を学習したコーパスとは異なるコーパスに適用する場合，各コーパスには同じ粒度のアノテーションが施してある必要がある．
アノテーションの粒度が異なる場合には精度よく解析できないため，解析器を改良し，学習しなおす必要がある．
解析器の改良にはコーパス間の相違点を把握することが重要となる．
本章では，CSJを基に構築した長単位解析器をBCCWJへ適用する上で必要な改良点を把握するため，言語単位，品詞体系，言語現象，付加情報に着目して，CSJとBCCWJを比較し，形態論情報における相違点について述べる．
CSJとBCCWJではともに，短単位と長単位という2種類の言語単位が用いられている．
短単位は，原則として，現代語で意味を持つ最小の単位2つが1回結合したものであり，その定義は一般的な辞書の見出しに近いものである．
長単位は，概ね，文節を自立語と付属語に分けたものであり，1短単位からなるか，あるいは，複数の短単位を複合したものからなる．
短単位と長単位の例を表[REF_unit_example]に挙げる．
表[REF_unit_example]は「日本型国際貢献が求められています」という文における文節，長単位，短単位の関係を表している．
例えば，「日本型国際貢献」という長単位は「日本」，「型」，「国際」，「貢献」の4短単位から構成される．
CSJとBCCWJではいずれも，短単位と長単位という同じ言語単位を利用しているが，BCCWJの短単位・長単位の認定規定は，CSJの規定に修正を加えたものを利用しているため，CSJとBCCWJの短単位・長単位は完全には一致しない．
CSJとBCCWJでは大きく異なる品詞体系が利用されている．
以下にCSJとBCCWJ，それぞれの品詞体系を示す．
CSJでは学校文法に基づく品詞体系が採用されており，15種類の品詞，59種類の活用型，8種類の活用形で構成されている[CITE]．
CSJの品詞体系は以下の通りである．
活用型の○にはア，カ，サ，タなどが入る．
品詞（15種類）
名詞，代名詞，形状詞，連体詞，副詞，接続詞，感動詞，動詞，形容詞，助動詞，助詞，接頭辞，接尾辞，記号，言いよどみ
活用型（59種類）
○行五段，○行上一段，○行下一段，カ行変格，サ行変格，ザ行変格，文語○行四段，文語○行上二段，文語○行下二段，文語カ行変格，文語サ行変格，文語ナ行変格，文語ラ行変格，形容詞型，文語形容詞型1，文語形容詞型2，文語形容詞型3，文語
活用形（8種類）
未然形，連用形，終止形，連体形，仮定形，已然形，命令形，語幹
BCCWJは形態素解析用辞書UniDic[CITE]に準拠した品詞体系を利用しており，品詞は「名詞-固有名詞-地名-一般」のように階層的に定義されている．
各階層は大分類，中分類，小分類，細分類と呼ばれる．
「名詞-固有名詞-地名-一般」の場合，「名詞」が大分類，「固有名詞」が中分類，「地名」が小分類，「一般」が細分類である．
品詞は4階層で定義され，大分類で15種類，細分類まで展開すると54種類ある．
活用型は3階層で定義され，大分類で20種類，小分類まで展開すると115種類ある．
活用形は2階層で定義され，大分類で10種類，中分類では36種類ある．
BCCWJの品詞体系のうち，大分類の体系は以下の通りである．
品詞（15種類）
名詞，代名詞，形状詞，連体詞，副詞，接続詞，感動詞，動詞，形容詞，助動詞，助詞，接頭辞，接尾辞，記号，補助記号
活用型（20種類）
五段，上一段，下一段，カ行変格，サ行変格，文語四段，文語上一段，文語上二段，文語下一段，文語下二段，文語カ行変格，文語サ行変格，文語ナ行変格，文語ラ行変格形容詞，文語形容詞，助動詞，文語助動詞，無変化型
活用形（10種類）
語幹，未然形，意志推量形，連用形，終止形，連体形，仮定形，已然形，命令形，ク語法
CSJが階層のない単純な品詞体系を利用しているのに比べ，BCCWJでは詳細な品詞体系が利用されている．
CSJの名詞とBCCWJの名詞を比較した例を表[REF_compare_noun]に示す．
BCCWJでは名詞は15種類に分類されている．
また，CSJでは短単位と長単位の品詞体系が一致しているのに対し，BCCWJでは短単位と長単位の品詞体系は一部異なっている．
これはBCCWJの短単位では「名詞-普通名詞-サ変可能」や「名詞-普通名詞-形状詞可能」などの曖昧性を持たせた品詞が設けられているのに対し，長単位ではこれらを設けていないためである．
CSJは話し言葉コーパスであるのに対し，BCCWJは書き言葉コーパスであるため，言語現象として，話し言葉と書き言葉という大きな違いがある．
例えば，話し言葉の場合，フィラーや言いよどみなどが生じる．
一方，書き言葉の場合，著者によって使われる表記が異なるため，表記のバリエーションが多い．
話し言葉のコーパスであるCSJと書き言葉のコーパスであるBCCWJを比べると，前者では人手で書き起こす際に表記揺れが吸収され表記は統一されており，後者では著者の著したテキストがそのまま使われているため表記は不統一である．
次の節でこれらに関連してコーパスに付加された情報の違いを整理する．
CSJとBCCWJでは短単位に付与されている情報に多少違いがある．
以下に，CSJのみ，及び，BCCWJのみにしか付与されていない情報について述べる．
CSJには話し言葉特有の情報など，以下の情報が付与されている．
フィラー：フィラーに対してタグ（F）が付与されている
（Fえー），（Fあのね），（Fんーと）
言いよどみ：言いよどみに対してタグ（D）が付与されている
（Dす）すると，（Dテニ）昨日のテニスは，（D情）情報が
アルファベット：アルファベット，算用数字，記号の短単位に対してタグ（A）が付与されている．
（Aシーディーアール；ＣＤ−Ｒ）
外国語：外国語や古語，方言などに対してタグ（O）が付与されている．
（Oザッツファイン）
名前：話者の名前や差別語，誹謗中傷などに対してタグ（R）が付与されている．
国語研の（R××）です
音や言葉のメタ情報：音や言葉に関するメタ的な引用に対してタグ（M）が付与されている．
助詞の（Mは）は（Mわ）と発音
一方，BCCWJではCSJには付与されていない以下の情報が付与されている．
語種情報：語種とは，語をその出自によって分類したものである．
BCCWJでは，短単位に以下の語種のいずれかが付与されている．
和語，漢語，外来語，混種語，固有名，記号
囲み情報：BCCWJでは，丸付き数字（\textcircled{ 1}，\textcircled{ 2}）や丸秘などの丸で囲まれている文字は内部の文字のみが短単位となっており，囲みの情報は別で付与されている．
例えば，「\textcircled{ 1}林木の新品種の開発」は書字形では「１林木の新品種の開発」となっており，囲みの情報は別で付与されている．
本章では，まず，CSJに基づいて構築された長単位解析手法（従来手法）について述べ，次に，提案手法について述べる．
従来手法をBCCWJに適用するためには改良が必要であり，提案手法では，CSJとBCCWJの形態論情報における相違点に着目した改良を行った．
長単位解析とは長単位境界，及び，長単位の語彙素，語彙素読み，品詞，活用型，活用形を同定するタスクである．
短単位解析では，辞書を用いることで，高精度に解析が行われてきた[CITE]．
長単位解析でも長単位辞書を構築することによって高精度に解析できることが考えられるが，短単位の組み合わせからなる長単位の語彙は膨大であり，辞書の構築には膨大な労力が必要となるため，効率的でない．
そのため，短単位情報を組み上げることにより長単位解析を行う．
Uchimotoらは長単位を認定する問題を，入力された短単位列に対する系列セグメンテーション問題として捉え，チャンキングモデルと後処理に基づいた長単位解析手法を構築した[CITE]．
図[REF_flow]に長単位解析の流れを示す．
短単位列を入力とし，チャンキングにより長単位境界を認定する．
このとき，一部の長単位に対しては品詞情報も付与する．
次に，後処理によって長単位の品詞，活用型，活用形，語彙素，語彙素読みを付与する．
チャンキングモデルによって，長単位境界を認定し，一部の長単位に対しては品詞情報も付与するために，Uchimotoらは下記の4つのラベルを定義している．
長単位を構成する短単位のうち先頭の要素で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
長単位を構成する短単位のうち先頭以外の要素で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
長単位を構成する短単位のうち先頭の要素で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
長単位を構成する短単位のうち先頭以外の要素で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
これは，長単位を構成する先頭の要素に付与されるラベルは「Ba」か「B」であり，長単位を構成する先頭以外の要素に付与されるラベルは「Ia」か「I」であることを意味する．
また，「Ba」「Ia」が付与された要素は長単位と同じ品詞，活用型，活用形を持つことを意味する．
したがって，このラベルを利用することにより，長単位境界だけでなく，多くの場合，品詞，活用型，活用形の情報も得られる．
図[REF_fig:suw_luw_org]に「日本型国際貢献が求められています」に対して，ラベルを付与した例を示す．
これらのラベルを正しく推定できれば，「Ba」あるいは「Ia」が付与された短単位から品詞，活用型，活用形が得られる．
図[REF_fig:suw_luw_org]は，「ている」以外の長単位については品詞，活用型，活用形も得られることを表わしている．
一方，「ている」については品詞がこれらを構成する短単位「て」「いる」のどちらとも異なるため，各短単位には「B」あるいは「I」のラベルしか付与されない．
この場合は，ラベルを正しく推定できたとしても品詞などは得られず，単位境界の情報のみが得られることになるため，次節に述べる後処理により品詞，活用型，活用形を推定する．
チャンキングモデルの素性としては，着目する短単位とその前後2短単位，あわせて5短単位について，以下の情報を利用する．
短単位情報
書字形，語彙素読み，語彙素，品詞，活用型，活用形
付加情報
[REF_additional_annotation]節で述べたCSJにのみ付与されている情報（フィラー，言いよどみ，アルファベット，外国語，名前，音や言葉のメタ情報を示すタグ）がそれぞれ着目している短単位の直前に付与されているか否かを素性として利用する．
[REF_chunking_model]節で記したチャンキングモデルにより，ラベルを正しく推定することができれば，図[REF_fig:suw_luw_org]の「日本型国際貢献」や「求める」などは「Ba」または「Ia」が付与された短単位から品詞，活用型，活用形が得られる．
一方，「ている」については，品詞が長単位を構成する短単位「て」及び「いる」とは異なるため，各短単位には「B」あるいは「I」のラベルしか付与されない．
この場合は，ラベルを正しく推定できたとしても品詞は得られず，単位境界の情報のみが得られることになる．
これらの長単位に対しては書き換え規則によって品詞，活用型，活用形を付与する．
単位境界のみが分かっている長単位ごと，つまり，「B」あるいは「I」が付与された短単位のみから構成される長単位ごとに書き換え規則を獲得，適用することによって品詞，活用型，活用形の情報を得る．
書き換え規則は対象の長単位とその前後の短単位を抽出することによって自動獲得する．
書き換え規則は対象の長単位を構成する短単位，及び，その前後の短単位からなる前件部と，対象の長単位からなる後件部で構成される．
例えば，図[REF_fig:suw_luw_org]の「ている」については図[REF_fig:rule]のような規則が獲得される．
前件部で同じ規則が複数得られた場合，最も頻度の高いもののみ書き換え規則として獲得する．
図[REF_fig:rule]の規則は，「て」「いる」という短単位にそれぞれ「B」，「I」というラベルが付与され，前方（文頭側）の短単位が「られ」，後方（文末側）の短単位が「ます」であるとき，「ている」という助動詞に書き換えられることを意味している．
どの書き換え規則も適用されない場合は，以下の手順で規則を汎化して再適用する．
後方文脈を削除
前方文脈と後方文脈を削除
前方文脈，後方文脈，書字形，語彙素読み，語彙素を削除
前方文脈とは対象の長単位より前方（文頭側）の短単位（図[REF_fig:rule]の「られ」），後方文脈とは対象の長単位より後方（文末側）の短単位（図[REF_fig:rule]の「ます」）を表す．
この手順で再適用し，結果的にどの規則も適用されなかった場合は，短単位の先頭の品詞，活用型，活用形を適用する．
本節では，[REF_uchimoto_method]節で示した長単位解析手法（従来手法）からの改良点について述べる．
CSJとBCCWJの品詞体系は[REF_pos_tagset_diff]節で示したように，大きく異なっている．
この問題に対し，以下の点を改善した．
CSJの品詞体系とは異なり，BCCWJの品詞体系では，品詞，活用型，活用形が階層的に定義されている．
しかし，階層化された素性をそのまま利用した場合，各階層の情報が考慮されなくなってしまう．
そこで，階層化された素性に対して上位階層で汎化した素性をチャンキングモデルの素性として追加する．
例えば「名詞-普通名詞-一般」に対しては，「名詞」「名詞-普通名詞」を素性として追加する．
CSJでは品詞体系が単純であったため，「B」あるいは「I」のラベルが付与された短単位のみから構成される長単位が少なく，後処理については書き換え規則である程度対応できていた．
しかし，品詞体系が詳細なBCCWJでは，短単位と長単位の品詞の対応関係が単純ではないため，書き換え規則で対応するのは困難である．
この問題に対し，次に述べるカテゴリ推定モデルを用いることで解決することを提案する．
カテゴリ推定モデルは，学習データに現れたカテゴリを候補として，その候補すべてについて尤もらしさを計算するモデルである．
長単位を構成する短単位列を与えると，その長単位に対して最尤のカテゴリを出力する．
推定するカテゴリを品詞，活用型，活用形とした，品詞推定モデル，及び，活用型推定モデル，活用形推定モデルをそれぞれ学習・適用し，最も尤もらしい品詞，活用型，活用形を推定する．
推定するカテゴリを品詞とする品詞推定モデルでは，学習データに現れた品詞のうち，助詞と助動詞を除くすべての品詞候補から最尤の品詞を出力する．
助詞と助動詞については長単位を構成する短単位列が複合辞と一致している場合のみ候補とする．
複合辞と一致しているかどうかは，複合辞辞書との文字列マッチングにより自動判定する．
複合辞辞書はBCCWJで認定された複合辞を予め人手で整理することにより用意した．
素性としては，着目している長単位とその前後の長単位，あわせて3長単位に対して，先頭から2短単位と末尾から2短単位の計12短単位の情報を用いる．
長単位が1短単位からなる場合は，先頭から2短単位目の情報は与えられなかったもの(NULL)として扱う．
各短単位に対して，書字形，語彙素読み，語彙素，品詞，活用型，活用形，及び，階層化された素性に対して上位階層で汎化した情報を素性として用いる．
図[REF_fig:suw_luw_org]の「てい」に対して品詞推定モデルを適用する例を図[REF_post_feature]に示す．
「てい」では，前後の長単位をあわせた「られ」「てい」「ます」の3長単位に対し，「られ」「NULL」（「られ」の先頭2短単位），「て」「い」（「てい」の先頭2短単位），「ます」「NULL」（「ます」の先頭2短単位），及び，「NULL」「られ」（「られ」の末尾2短単位），「て」「い」（「てい」の末尾2短単位），「NULL」「ます」（「ます」の末尾2短単位）の各短単位の情報を素性として用いる．
図[REF_post_feature]では，最尤の品詞として助動詞を出力している．
活用型推定モデル，及び，活用形推定モデルは，推定するカテゴリが品詞ではなくそれぞれ活用型，活用形となる点，及び，動的素性を用いる点を除いて品詞推定モデルと同様である．
動的素性としては，活用型推定モデルでは着目している長単位の品詞（自動解析時は品詞推定モデルにより自動推定した品詞）を，活用形推定モデルでは着目している長単位の品詞と活用型（自動解析時は品詞推定モデル，活用型推定モデルによりそれぞれ自動推定した品詞と活用型）を用いる．
[REF_additional_annotation]節で示したBCCWJにのみ付与されている以下の情報をチャンキングモデルの素性として利用する．
語種情報
短単位の語種が和語，漢語，外来語，混種語，固有名，記号のいずれであるかを素性として利用する．
囲み情報
BCCWJでは丸付き数字で長単位境界が区切れるため，囲み情報は長単位境界を判定するための大きな手がかりとなる．
そのため，短単位に囲み情報が付与されているか否かを素性として利用する．
本節では，コーパスの相違点に限らず，既存の手法にも適用できる改良について述べる．
[REF_chunking_model]節で示した4つのラベルを以下のように再定義した．
変更点を下線で示す．
単独で長単位を構成する短単位で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
複数短単位で構成される長単位の末尾の短単位で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
複数短単位で構成される長単位の先頭の短単位．
もしくは，単独で長単位を構成する短単位で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
複数短単位で構成される長単位の先頭でも末尾でもない短単位．
もしくは，複数短単位
で構成される長単位の末尾の短単位で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
単独の短単位から構成される長単位に対しては，短単位の品詞，活用型，活用形が長単位のものと一致する場合には「Ba」，一致しない場合には「B」が付与される．
一方，複数短単位から構成される長単位に対しては，先頭の短単位には「B」，先頭でも末尾でもない短単位には「I」，末尾の短単位にはその品詞，活用型，活用形が長単位のものと一致する場合には「Ia」，一致しない場合には「I」が付与される．
この定義を利用すると，図[REF_fig:suw_luw_org]の例では，「Ba」が付与されている「日本」には「B」，「Ia」が付与されている「国際」には「I」のラベルが付与されることになる．
本改良は，長単位の品詞，活用型，活用形は，長単位を構成する短単位のうち，末尾の短単位の品詞，活用型，活用形と一致することが多く，それ以外の位置にある短単位と一致する場合は偶然であることが多いという観察に基づく．
「Ba」，「Ia」のラベルが付与される短単位を長単位を構成する末尾の短単位のみに限定することにより，チャンキングモデルの精度が向上し，全体の性能が向上することが期待できる．
提案手法を用いることにより，CSJやBCCWJとは異なる言語単位や品詞体系のコーパスに対しても長単位を付与することが可能である．
より多くの研究者に対して，品詞体系の異なるコーパスや他分野のコーパスへの長単位情報付与を容易にするためには，長単位解析の学習・解析機能を備えたツールが利用可能になっていることが重要であると考える．
[REF_luw_analysis]章で説明した提案手法を実装することにより，長単位解析ツールComainuを作成した．
モデルの学習にはBCCWJのコアデータ（45,342文，828,133長単位，1,047,069短単位）を用いた．
本ツールは，平文または短単位列を入力すると，長単位を付与した短単位列を出力することができる．
平文が入力された場合，MeCabとUniDicにより形態素解析を行った後に長単位解析を行う．
長単位解析のチャンキングモデルにはSVMとCRFのいずれかを用いることができる．
また，平文や短単位列の直接入力だけでなくファイル入力にも対応しており，解析結果をファイルに保存することも可能である．
図[REF_comainu_sample]にComainuによる長単位解析の解析例を示す．
図[REF_comainu_sample]の例では，平文を入力とし，CRFによるチャンキングモデルとSVMによる品詞，活用型，活用形推定モデルを用いて長単位解析を実行し，長単位が付与された短単位列を出力している．
出力の2〜8列目はそれぞれ短単位の書字形，発音系，語彙素読み，語彙素，品詞，活用型，活用形を表し，出力の9〜14列目はそれぞれ長単位の品詞，活用型，活用形，語彙素読み，語彙素，書字形を表す．
長単位解析ツールComainuはオープンソースとしている．
これにより，長単位のアノテーションが容易になることが期待される．
一般に，解析器を学習したコーパスとは異なるコーパスに適用する場合，各コーパスには同じ粒度のアノテーションが施してある必要がある．
アノテーションの粒度が異なる場合には精度よく解析できないため，解析器を改良し，学習しなおす必要がある．
解析器の改良にはコーパス間の相違点を把握することが重要となる．
本章では，CSJを基に構築した長単位解析器をBCCWJへ適用する上で必要な改良点を把握するため，言語単位，品詞体系，言語現象，付加情報に着目して，CSJとBCCWJを比較し，形態論情報における相違点について述べる．
CSJとBCCWJではともに，短単位と長単位という2種類の言語単位が用いられている．
短単位は，原則として，現代語で意味を持つ最小の単位2つが1回結合したものであり，その定義は一般的な辞書の見出しに近いものである．
長単位は，概ね，文節を自立語と付属語に分けたものであり，1短単位からなるか，あるいは，複数の短単位を複合したものからなる．
短単位と長単位の例を表[REF_unit_example]に挙げる．
表[REF_unit_example]は「日本型国際貢献が求められています」という文における文節，長単位，短単位の関係を表している．
例えば，「日本型国際貢献」という長単位は「日本」，「型」，「国際」，「貢献」の4短単位から構成される．
CSJとBCCWJではいずれも，短単位と長単位という同じ言語単位を利用しているが，BCCWJの短単位・長単位の認定規定は，CSJの規定に修正を加えたものを利用しているため，CSJとBCCWJの短単位・長単位は完全には一致しない．
CSJとBCCWJでは大きく異なる品詞体系が利用されている．
以下にCSJとBCCWJ，それぞれの品詞体系を示す．
CSJでは学校文法に基づく品詞体系が採用されており，15種類の品詞，59種類の活用型，8種類の活用形で構成されている[CITE]．
CSJの品詞体系は以下の通りである．
活用型の○にはア，カ，サ，タなどが入る．
品詞（15種類）
名詞，代名詞，形状詞，連体詞，副詞，接続詞，感動詞，動詞，形容詞，助動詞，助詞，接頭辞，接尾辞，記号，言いよどみ
活用型（59種類）
○行五段，○行上一段，○行下一段，カ行変格，サ行変格，ザ行変格，文語○行四段，文語○行上二段，文語○行下二段，文語カ行変格，文語サ行変格，文語ナ行変格，文語ラ行変格，形容詞型，文語形容詞型1，文語形容詞型2，文語形容詞型3，文語
活用形（8種類）
未然形，連用形，終止形，連体形，仮定形，已然形，命令形，語幹
BCCWJは形態素解析用辞書UniDic[CITE]に準拠した品詞体系を利用しており，品詞は「名詞-固有名詞-地名-一般」のように階層的に定義されている．
各階層は大分類，中分類，小分類，細分類と呼ばれる．
「名詞-固有名詞-地名-一般」の場合，「名詞」が大分類，「固有名詞」が中分類，「地名」が小分類，「一般」が細分類である．
品詞は4階層で定義され，大分類で15種類，細分類まで展開すると54種類ある．
活用型は3階層で定義され，大分類で20種類，小分類まで展開すると115種類ある．
活用形は2階層で定義され，大分類で10種類，中分類では36種類ある．
BCCWJの品詞体系のうち，大分類の体系は以下の通りである．
品詞（15種類）
名詞，代名詞，形状詞，連体詞，副詞，接続詞，感動詞，動詞，形容詞，助動詞，助詞，接頭辞，接尾辞，記号，補助記号
活用型（20種類）
五段，上一段，下一段，カ行変格，サ行変格，文語四段，文語上一段，文語上二段，文語下一段，文語下二段，文語カ行変格，文語サ行変格，文語ナ行変格，文語ラ行変格形容詞，文語形容詞，助動詞，文語助動詞，無変化型
活用形（10種類）
語幹，未然形，意志推量形，連用形，終止形，連体形，仮定形，已然形，命令形，ク語法
CSJが階層のない単純な品詞体系を利用しているのに比べ，BCCWJでは詳細な品詞体系が利用されている．
CSJの名詞とBCCWJの名詞を比較した例を表[REF_compare_noun]に示す．
BCCWJでは名詞は15種類に分類されている．
また，CSJでは短単位と長単位の品詞体系が一致しているのに対し，BCCWJでは短単位と長単位の品詞体系は一部異なっている．
これはBCCWJの短単位では「名詞-普通名詞-サ変可能」や「名詞-普通名詞-形状詞可能」などの曖昧性を持たせた品詞が設けられているのに対し，長単位ではこれらを設けていないためである．
CSJは話し言葉コーパスであるのに対し，BCCWJは書き言葉コーパスであるため，言語現象として，話し言葉と書き言葉という大きな違いがある．
例えば，話し言葉の場合，フィラーや言いよどみなどが生じる．
一方，書き言葉の場合，著者によって使われる表記が異なるため，表記のバリエーションが多い．
話し言葉のコーパスであるCSJと書き言葉のコーパスであるBCCWJを比べると，前者では人手で書き起こす際に表記揺れが吸収され表記は統一されており，後者では著者の著したテキストがそのまま使われているため表記は不統一である．
次の節でこれらに関連してコーパスに付加された情報の違いを整理する．
CSJとBCCWJでは短単位に付与されている情報に多少違いがある．
以下に，CSJのみ，及び，BCCWJのみにしか付与されていない情報について述べる．
CSJには話し言葉特有の情報など，以下の情報が付与されている．
フィラー：フィラーに対してタグ（F）が付与されている
（Fえー），（Fあのね），（Fんーと）
言いよどみ：言いよどみに対してタグ（D）が付与されている
（Dす）すると，（Dテニ）昨日のテニスは，（D情）情報が
アルファベット：アルファベット，算用数字，記号の短単位に対してタグ（A）が付与されている．
（Aシーディーアール；ＣＤ−Ｒ）
外国語：外国語や古語，方言などに対してタグ（O）が付与されている．
（Oザッツファイン）
名前：話者の名前や差別語，誹謗中傷などに対してタグ（R）が付与されている．
国語研の（R××）です
音や言葉のメタ情報：音や言葉に関するメタ的な引用に対してタグ（M）が付与されている．
助詞の（Mは）は（Mわ）と発音
一方，BCCWJではCSJには付与されていない以下の情報が付与されている．
語種情報：語種とは，語をその出自によって分類したものである．
BCCWJでは，短単位に以下の語種のいずれかが付与されている．
和語，漢語，外来語，混種語，固有名，記号
囲み情報：BCCWJでは，丸付き数字（\textcircled{ 1}，\textcircled{ 2}）や丸秘などの丸で囲まれている文字は内部の文字のみが短単位となっており，囲みの情報は別で付与されている．
例えば，「\textcircled{ 1}林木の新品種の開発」は書字形では「１林木の新品種の開発」となっており，囲みの情報は別で付与されている．
本章では，まず，CSJに基づいて構築された長単位解析手法（従来手法）について述べ，次に，提案手法について述べる．
従来手法をBCCWJに適用するためには改良が必要であり，提案手法では，CSJとBCCWJの形態論情報における相違点に着目した改良を行った．
長単位解析とは長単位境界，及び，長単位の語彙素，語彙素読み，品詞，活用型，活用形を同定するタスクである．
短単位解析では，辞書を用いることで，高精度に解析が行われてきた[CITE]．
長単位解析でも長単位辞書を構築することによって高精度に解析できることが考えられるが，短単位の組み合わせからなる長単位の語彙は膨大であり，辞書の構築には膨大な労力が必要となるため，効率的でない．
そのため，短単位情報を組み上げることにより長単位解析を行う．
Uchimotoらは長単位を認定する問題を，入力された短単位列に対する系列セグメンテーション問題として捉え，チャンキングモデルと後処理に基づいた長単位解析手法を構築した[CITE]．
図[REF_flow]に長単位解析の流れを示す．
短単位列を入力とし，チャンキングにより長単位境界を認定する．
このとき，一部の長単位に対しては品詞情報も付与する．
次に，後処理によって長単位の品詞，活用型，活用形，語彙素，語彙素読みを付与する．
チャンキングモデルによって，長単位境界を認定し，一部の長単位に対しては品詞情報も付与するために，Uchimotoらは下記の4つのラベルを定義している．
長単位を構成する短単位のうち先頭の要素で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
長単位を構成する短単位のうち先頭以外の要素で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
長単位を構成する短単位のうち先頭の要素で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
長単位を構成する短単位のうち先頭以外の要素で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
これは，長単位を構成する先頭の要素に付与されるラベルは「Ba」か「B」であり，長単位を構成する先頭以外の要素に付与されるラベルは「Ia」か「I」であることを意味する．
また，「Ba」「Ia」が付与された要素は長単位と同じ品詞，活用型，活用形を持つことを意味する．
したがって，このラベルを利用することにより，長単位境界だけでなく，多くの場合，品詞，活用型，活用形の情報も得られる．
図[REF_fig:suw_luw_org]に「日本型国際貢献が求められています」に対して，ラベルを付与した例を示す．
これらのラベルを正しく推定できれば，「Ba」あるいは「Ia」が付与された短単位から品詞，活用型，活用形が得られる．
図[REF_fig:suw_luw_org]は，「ている」以外の長単位については品詞，活用型，活用形も得られることを表わしている．
一方，「ている」については品詞がこれらを構成する短単位「て」「いる」のどちらとも異なるため，各短単位には「B」あるいは「I」のラベルしか付与されない．
この場合は，ラベルを正しく推定できたとしても品詞などは得られず，単位境界の情報のみが得られることになるため，次節に述べる後処理により品詞，活用型，活用形を推定する．
チャンキングモデルの素性としては，着目する短単位とその前後2短単位，あわせて5短単位について，以下の情報を利用する．
短単位情報
書字形，語彙素読み，語彙素，品詞，活用型，活用形
付加情報
[REF_additional_annotation]節で述べたCSJにのみ付与されている情報（フィラー，言いよどみ，アルファベット，外国語，名前，音や言葉のメタ情報を示すタグ）がそれぞれ着目している短単位の直前に付与されているか否かを素性として利用する．
[REF_chunking_model]節で記したチャンキングモデルにより，ラベルを正しく推定することができれば，図[REF_fig:suw_luw_org]の「日本型国際貢献」や「求める」などは「Ba」または「Ia」が付与された短単位から品詞，活用型，活用形が得られる．
一方，「ている」については，品詞が長単位を構成する短単位「て」及び「いる」とは異なるため，各短単位には「B」あるいは「I」のラベルしか付与されない．
この場合は，ラベルを正しく推定できたとしても品詞は得られず，単位境界の情報のみが得られることになる．
これらの長単位に対しては書き換え規則によって品詞，活用型，活用形を付与する．
単位境界のみが分かっている長単位ごと，つまり，「B」あるいは「I」が付与された短単位のみから構成される長単位ごとに書き換え規則を獲得，適用することによって品詞，活用型，活用形の情報を得る．
書き換え規則は対象の長単位とその前後の短単位を抽出することによって自動獲得する．
書き換え規則は対象の長単位を構成する短単位，及び，その前後の短単位からなる前件部と，対象の長単位からなる後件部で構成される．
例えば，図[REF_fig:suw_luw_org]の「ている」については図[REF_fig:rule]のような規則が獲得される．
前件部で同じ規則が複数得られた場合，最も頻度の高いもののみ書き換え規則として獲得する．
図[REF_fig:rule]の規則は，「て」「いる」という短単位にそれぞれ「B」，「I」というラベルが付与され，前方（文頭側）の短単位が「られ」，後方（文末側）の短単位が「ます」であるとき，「ている」という助動詞に書き換えられることを意味している．
どの書き換え規則も適用されない場合は，以下の手順で規則を汎化して再適用する．
後方文脈を削除
前方文脈と後方文脈を削除
前方文脈，後方文脈，書字形，語彙素読み，語彙素を削除
前方文脈とは対象の長単位より前方（文頭側）の短単位（図[REF_fig:rule]の「られ」），後方文脈とは対象の長単位より後方（文末側）の短単位（図[REF_fig:rule]の「ます」）を表す．
この手順で再適用し，結果的にどの規則も適用されなかった場合は，短単位の先頭の品詞，活用型，活用形を適用する．
本節では，[REF_uchimoto_method]節で示した長単位解析手法（従来手法）からの改良点について述べる．
CSJとBCCWJの品詞体系は[REF_pos_tagset_diff]節で示したように，大きく異なっている．
この問題に対し，以下の点を改善した．
CSJの品詞体系とは異なり，BCCWJの品詞体系では，品詞，活用型，活用形が階層的に定義されている．
しかし，階層化された素性をそのまま利用した場合，各階層の情報が考慮されなくなってしまう．
そこで，階層化された素性に対して上位階層で汎化した素性をチャンキングモデルの素性として追加する．
例えば「名詞-普通名詞-一般」に対しては，「名詞」「名詞-普通名詞」を素性として追加する．
CSJでは品詞体系が単純であったため，「B」あるいは「I」のラベルが付与された短単位のみから構成される長単位が少なく，後処理については書き換え規則である程度対応できていた．
しかし，品詞体系が詳細なBCCWJでは，短単位と長単位の品詞の対応関係が単純ではないため，書き換え規則で対応するのは困難である．
この問題に対し，次に述べるカテゴリ推定モデルを用いることで解決することを提案する．
カテゴリ推定モデルは，学習データに現れたカテゴリを候補として，その候補すべてについて尤もらしさを計算するモデルである．
長単位を構成する短単位列を与えると，その長単位に対して最尤のカテゴリを出力する．
推定するカテゴリを品詞，活用型，活用形とした，品詞推定モデル，及び，活用型推定モデル，活用形推定モデルをそれぞれ学習・適用し，最も尤もらしい品詞，活用型，活用形を推定する．
推定するカテゴリを品詞とする品詞推定モデルでは，学習データに現れた品詞のうち，助詞と助動詞を除くすべての品詞候補から最尤の品詞を出力する．
助詞と助動詞については長単位を構成する短単位列が複合辞と一致している場合のみ候補とする．
複合辞と一致しているかどうかは，複合辞辞書との文字列マッチングにより自動判定する．
複合辞辞書はBCCWJで認定された複合辞を予め人手で整理することにより用意した．
素性としては，着目している長単位とその前後の長単位，あわせて3長単位に対して，先頭から2短単位と末尾から2短単位の計12短単位の情報を用いる．
長単位が1短単位からなる場合は，先頭から2短単位目の情報は与えられなかったもの(NULL)として扱う．
各短単位に対して，書字形，語彙素読み，語彙素，品詞，活用型，活用形，及び，階層化された素性に対して上位階層で汎化した情報を素性として用いる．
図[REF_fig:suw_luw_org]の「てい」に対して品詞推定モデルを適用する例を図[REF_post_feature]に示す．
「てい」では，前後の長単位をあわせた「られ」「てい」「ます」の3長単位に対し，「られ」「NULL」（「られ」の先頭2短単位），「て」「い」（「てい」の先頭2短単位），「ます」「NULL」（「ます」の先頭2短単位），及び，「NULL」「られ」（「られ」の末尾2短単位），「て」「い」（「てい」の末尾2短単位），「NULL」「ます」（「ます」の末尾2短単位）の各短単位の情報を素性として用いる．
図[REF_post_feature]では，最尤の品詞として助動詞を出力している．
活用型推定モデル，及び，活用形推定モデルは，推定するカテゴリが品詞ではなくそれぞれ活用型，活用形となる点，及び，動的素性を用いる点を除いて品詞推定モデルと同様である．
動的素性としては，活用型推定モデルでは着目している長単位の品詞（自動解析時は品詞推定モデルにより自動推定した品詞）を，活用形推定モデルでは着目している長単位の品詞と活用型（自動解析時は品詞推定モデル，活用型推定モデルによりそれぞれ自動推定した品詞と活用型）を用いる．
[REF_additional_annotation]節で示したBCCWJにのみ付与されている以下の情報をチャンキングモデルの素性として利用する．
語種情報
短単位の語種が和語，漢語，外来語，混種語，固有名，記号のいずれであるかを素性として利用する．
囲み情報
BCCWJでは丸付き数字で長単位境界が区切れるため，囲み情報は長単位境界を判定するための大きな手がかりとなる．
そのため，短単位に囲み情報が付与されているか否かを素性として利用する．
本節では，コーパスの相違点に限らず，既存の手法にも適用できる改良について述べる．
[REF_chunking_model]節で示した4つのラベルを以下のように再定義した．
変更点を下線で示す．
単独で長単位を構成する短単位で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
複数短単位で構成される長単位の末尾の短単位で，かつ，その品詞，活用型，活用形が長単位のものと一致する．
複数短単位で構成される長単位の先頭の短単位．
もしくは，単独で長単位を構成する短単位で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
複数短単位で構成される長単位の先頭でも末尾でもない短単位．
もしくは，複数短単位
で構成される長単位の末尾の短単位で，かつ，その品詞，活用型，活用形のいずれかが長単位のものと一致しない．
単独の短単位から構成される長単位に対しては，短単位の品詞，活用型，活用形が長単位のものと一致する場合には「Ba」，一致しない場合には「B」が付与される．
一方，複数短単位から構成される長単位に対しては，先頭の短単位には「B」，先頭でも末尾でもない短単位には「I」，末尾の短単位にはその品詞，活用型，活用形が長単位のものと一致する場合には「Ia」，一致しない場合には「I」が付与される．
この定義を利用すると，図[REF_fig:suw_luw_org]の例では，「Ba」が付与されている「日本」には「B」，「Ia」が付与されている「国際」には「I」のラベルが付与されることになる．
本改良は，長単位の品詞，活用型，活用形は，長単位を構成する短単位のうち，末尾の短単位の品詞，活用型，活用形と一致することが多く，それ以外の位置にある短単位と一致する場合は偶然であることが多いという観察に基づく．
「Ba」，「Ia」のラベルが付与される短単位を長単位を構成する末尾の短単位のみに限定することにより，チャンキングモデルの精度が向上し，全体の性能が向上することが期待できる．
提案手法を用いることにより，CSJやBCCWJとは異なる言語単位や品詞体系のコーパスに対しても長単位を付与することが可能である．
より多くの研究者に対して，品詞体系の異なるコーパスや他分野のコーパスへの長単位情報付与を容易にするためには，長単位解析の学習・解析機能を備えたツールが利用可能になっていることが重要であると考える．
[REF_luw_analysis]章で説明した提案手法を実装することにより，長単位解析ツールComainuを作成した．
モデルの学習にはBCCWJのコアデータ（45,342文，828,133長単位，1,047,069短単位）を用いた．
本ツールは，平文または短単位列を入力すると，長単位を付与した短単位列を出力することができる．
平文が入力された場合，MeCabとUniDicにより形態素解析を行った後に長単位解析を行う．
長単位解析のチャンキングモデルにはSVMとCRFのいずれかを用いることができる．
また，平文や短単位列の直接入力だけでなくファイル入力にも対応しており，解析結果をファイルに保存することも可能である．
図[REF_comainu_sample]にComainuによる長単位解析の解析例を示す．
図[REF_comainu_sample]の例では，平文を入力とし，CRFによるチャンキングモデルとSVMによる品詞，活用型，活用形推定モデルを用いて長単位解析を実行し，長単位が付与された短単位列を出力している．
出力の2〜8列目はそれぞれ短単位の書字形，発音系，語彙素読み，語彙素，品詞，活用型，活用形を表し，出力の9〜14列目はそれぞれ長単位の品詞，活用型，活用形，語彙素読み，語彙素，書字形を表す．
長単位解析ツールComainuはオープンソースとしている．
これにより，長単位のアノテーションが容易になることが期待される．
