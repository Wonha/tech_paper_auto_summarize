この節では，実装したtext-to-presentationシステムについて説明する．
このシステムでは，ユーザは自然言語でクエリを入力すると，クエリに関するプレゼンテーションを閲覧することができる．
本稿では，テキスト集合として，阪神淡路大震災教訓資料集を用いた．
この資料集はHTMLで書かれており，HTMLタグを手がかりとして400テキストに自動分割することによりテキスト集合とした．
各テキストにはタイトルが付与されており，スライドのタイトルとして利用した．
テキストの平均文数は3.7，一文あたりの平均文字数は50であった．
システムはまず，Kiyotaらの手法を用いて，ユーザからのクエリと最も類似したテキストを検索する[CITE]．
その後，書き言葉を話し言葉に変換して音声合成に入力し，同時に，本稿で述べた手法で生成したスライドをユーザに提示する．
図[REF_fig:screenshot]に示すように，本システムはWebブラウザ上で動作する．
テキストから複数のスライドが生成された場合は音声合成と同期してスライドの表示を切り換える．
「ボランティアの役割」「火災の原因にはどのようなものがありますか」などといったユーザからの30クエリから検索されたテキストからスライドを生成し，談話構造解析と生成されたスライドの評価を行なった．
書き言葉からの話し言葉への変換とテキスト検索の評価に関しては，それぞれ[CITE]，[CITE]に譲る．
入力テキストと自動生成されたスライドのサイズを比較した平均圧縮率は0.797であった．
談話構造解析の精度を表[REF_tab:evaluation]に示す．
評価は，節または文の接続先と結束関係が正しいかで行なった．
談話構造解析の主な誤り原因を以下に示す．
以下の例では1文目の「震災」と2文目の「地震」の関係が捉えられず，2文目で初期化されてしまっている．
\ex. \a. \Underline{震災}直後には，神戸市によって神戸市外語大のホームページに被害写真が掲載され，海外に被害の大きさを知らせた．
\b.パソコン通信ニフティサーブでは「\Underline{地震}情報コーナー」が開設され，ボランティア情報，安否情報，行政情報など各種の情報提供に用いられた．
この問題には，国語辞典やシソーラスを用いて表現のずれを認識することにより対処することができると考えられる．
また，本稿で扱ったテキストは書き言葉のため，語が省略されているために語連鎖が捉えられない例はそれほどなかったが，以下のような例では，「延焼速度」には「火災の」が省略されており，この関係が捉えられていないため，二文間の関係を主題連鎖と解析することができず，初期化されてしまった．
\ex. \a.このうち焼損面積10,000平方メートル以上の火災は，特に神戸市長田区などで集中的に発生した．
\b. \Underline{延焼速度は}おおむね20〜40 m/h程度で，過去の都市大火事例等と比較して極めて遅かった．
この問題には省略・照応解析を行なうことで対処する予定である．
名詞と句/節などが対比の関係にある時に，対比関係を検出できないことがあった．
以下の例では，「震災直後に」と「震災から1週間程度を経ると」の対比関係を検出できなかった．
\ex. \a. \Underline{震災直後に}被災者が必要としたのは，地震の規模や発生場所，被害状況などの被害情報，家族や友人・知人の消息に関する安否情報などだった．
\b. \Underline{震災から1週間程度を経ると}，長期的な生活に関わる情報として，住宅やり災証明を始めとする各種申請などの情報も求められた．
また，以下の例では，「当初の」，「時間とともに」の対比関係が検出できなかった．
\ex.ボランティアの\Underline{当初の}役割は，医療，食糧・物資配給，高齢者等の安否確認，避難所運営等だったが，\Underline{時間とともに}，物資配分，引っ越し・修理，高齢者・障害者のケアなどへと変化していった．
この問題には，「時間とともに」や「震災から1週間程度を経ると」が時間に関する表現であることを認識するためのルールを用意した上で，節/文の類似度を計算することで対処することができると考えられる．
また，本稿で対象とした地震ドメインのテキストにはシソーラスにない語が含まれており，語の類似度を正しく計算できないことがあった．
それが原因となり，文/節の類似度を正しく計算できないことがあった．
この問題には地震ドメインにおけるシソーラスを人手で用意するか，コーパスから自動構築することにより対処できると考えられる．
次に，自動生成したスライドの評価を行なった．
評価の基準は，生成されたスライドがユーザの理解を妨げるものとなっていないかどうかとし，スライドのインデント，主題の抽出，文簡約などが適切であるかどうかをもとに評価を行なった．
生成した30スライドについて筆者らが評価したところ，15枚については自然であり，12枚は少し不自然なところが含まれており，3つは全体的に不自然であるという結果であった．
出力例を図[REF_fig:slide_example1]と図[REF_fig:slide_example2]に示す．
図[REF_fig:slide_example1]の例では，「断水」，「停電」，「都市ガスの供給停止」の対比関係が正しく解析され，また，「明かりに不自由しながらの診察・治療が行われ」と「手動の人工呼吸器を押し続ける姿も見られた」の並列関係で項目を分割することにより，見やすいスライドとなっている．
また，2文目の「医療用水のほか」の簡約や，「(治療)が行なわれ」の整形などが行なわれている．
[t]
[MATH]
また，図[REF_fig:slide_example2]の例では，1文目の主題「代替バス利用者」が抽出され，「当初」，「バスレーン設置後」，「3月末」の対比関係が正しく解析されている．
しかし，2文目では，「代替バス」と「バスレーンの設置後」が対比していると間違って解析されており，正しくは，「当初」と「バスレーンの設置後」が対比関係にある．
この対比関係を正しく解析できるようにした上でさらにこのスライドをよくするには，2文目からは「利用時間」という主題を取り出し，1文目の「代替バス利用者」と対比させるのが望ましいが，これはかなり難しい処理であるといえる．
[t]
[MATH]
自動生成されたスライドで不自然な部分のほとんどは，談話構造解析誤りによるインデントのずれによるものであった．
[REF_sec:output_slide]章で説明したスライド生成のヒューリスティックルールによる大きな誤りはなく，また，主題部・非主題部の抽出や非主題部の簡約にも大きな誤りは見受けられなかった．
現在の文簡約は構文解析結果を基に行なう比較的シンプルなモデルであるが，十分機能しているといえる．
しかし，以下のように固有表現にかかる連体節などは削除した方がよりよいスライドになると考えられるので，今後は固有表現抽出を行ない，このような簡約を行なう予定である．
\ex. \Underline{大阪と神戸を結ぶ}ＪＲ神戸線，阪急電鉄神戸線，阪神電鉄本線の3線の不通により，一日45万人，ラッシュ時最大1時間12万人の足が奪われた．
\ex. \Underline{兵庫県下随一の3次救急医療機関である}神戸市立中央市民病院は，市街地と島を結ぶ神戸大橋の不通により震災直後の救急患者の受け入れがあまりできなかった．
たとえ自動スライドにインデントのずれや抽出したテキストが不自然であるといった誤りが少しあったとしても，入力テキストを音声合成と自動スライドのマルチモーダルに変換することは，ユーザに入力テキストをそのまま提示するよりもはるかによいことが実験により示された．
特に，テキストに大きな並列や対比関係がある場合は，入力テキストよりも見やすいスライドを生成できることが確認された．
この節では，実装したtext-to-presentationシステムについて説明する．
このシステムでは，ユーザは自然言語でクエリを入力すると，クエリに関するプレゼンテーションを閲覧することができる．
本稿では，テキスト集合として，阪神淡路大震災教訓資料集を用いた．
この資料集はHTMLで書かれており，HTMLタグを手がかりとして400テキストに自動分割することによりテキスト集合とした．
各テキストにはタイトルが付与されており，スライドのタイトルとして利用した．
テキストの平均文数は3.7，一文あたりの平均文字数は50であった．
システムはまず，Kiyotaらの手法を用いて，ユーザからのクエリと最も類似したテキストを検索する[CITE]．
その後，書き言葉を話し言葉に変換して音声合成に入力し，同時に，本稿で述べた手法で生成したスライドをユーザに提示する．
図[REF_fig:screenshot]に示すように，本システムはWebブラウザ上で動作する．
テキストから複数のスライドが生成された場合は音声合成と同期してスライドの表示を切り換える．
「ボランティアの役割」「火災の原因にはどのようなものがありますか」などといったユーザからの30クエリから検索されたテキストからスライドを生成し，談話構造解析と生成されたスライドの評価を行なった．
書き言葉からの話し言葉への変換とテキスト検索の評価に関しては，それぞれ[CITE]，[CITE]に譲る．
入力テキストと自動生成されたスライドのサイズを比較した平均圧縮率は0.797であった．
談話構造解析の精度を表[REF_tab:evaluation]に示す．
評価は，節または文の接続先と結束関係が正しいかで行なった．
談話構造解析の主な誤り原因を以下に示す．
以下の例では1文目の「震災」と2文目の「地震」の関係が捉えられず，2文目で初期化されてしまっている．
\ex. \a. \Underline{震災}直後には，神戸市によって神戸市外語大のホームページに被害写真が掲載され，海外に被害の大きさを知らせた．
\b.パソコン通信ニフティサーブでは「\Underline{地震}情報コーナー」が開設され，ボランティア情報，安否情報，行政情報など各種の情報提供に用いられた．
この問題には，国語辞典やシソーラスを用いて表現のずれを認識することにより対処することができると考えられる．
また，本稿で扱ったテキストは書き言葉のため，語が省略されているために語連鎖が捉えられない例はそれほどなかったが，以下のような例では，「延焼速度」には「火災の」が省略されており，この関係が捉えられていないため，二文間の関係を主題連鎖と解析することができず，初期化されてしまった．
\ex. \a.このうち焼損面積10,000平方メートル以上の火災は，特に神戸市長田区などで集中的に発生した．
\b. \Underline{延焼速度は}おおむね20〜40 m/h程度で，過去の都市大火事例等と比較して極めて遅かった．
この問題には省略・照応解析を行なうことで対処する予定である．
名詞と句/節などが対比の関係にある時に，対比関係を検出できないことがあった．
以下の例では，「震災直後に」と「震災から1週間程度を経ると」の対比関係を検出できなかった．
\ex. \a. \Underline{震災直後に}被災者が必要としたのは，地震の規模や発生場所，被害状況などの被害情報，家族や友人・知人の消息に関する安否情報などだった．
\b. \Underline{震災から1週間程度を経ると}，長期的な生活に関わる情報として，住宅やり災証明を始めとする各種申請などの情報も求められた．
また，以下の例では，「当初の」，「時間とともに」の対比関係が検出できなかった．
\ex.ボランティアの\Underline{当初の}役割は，医療，食糧・物資配給，高齢者等の安否確認，避難所運営等だったが，\Underline{時間とともに}，物資配分，引っ越し・修理，高齢者・障害者のケアなどへと変化していった．
この問題には，「時間とともに」や「震災から1週間程度を経ると」が時間に関する表現であることを認識するためのルールを用意した上で，節/文の類似度を計算することで対処することができると考えられる．
また，本稿で対象とした地震ドメインのテキストにはシソーラスにない語が含まれており，語の類似度を正しく計算できないことがあった．
それが原因となり，文/節の類似度を正しく計算できないことがあった．
この問題には地震ドメインにおけるシソーラスを人手で用意するか，コーパスから自動構築することにより対処できると考えられる．
次に，自動生成したスライドの評価を行なった．
評価の基準は，生成されたスライドがユーザの理解を妨げるものとなっていないかどうかとし，スライドのインデント，主題の抽出，文簡約などが適切であるかどうかをもとに評価を行なった．
生成した30スライドについて筆者らが評価したところ，15枚については自然であり，12枚は少し不自然なところが含まれており，3つは全体的に不自然であるという結果であった．
出力例を図[REF_fig:slide_example1]と図[REF_fig:slide_example2]に示す．
図[REF_fig:slide_example1]の例では，「断水」，「停電」，「都市ガスの供給停止」の対比関係が正しく解析され，また，「明かりに不自由しながらの診察・治療が行われ」と「手動の人工呼吸器を押し続ける姿も見られた」の並列関係で項目を分割することにより，見やすいスライドとなっている．
また，2文目の「医療用水のほか」の簡約や，「(治療)が行なわれ」の整形などが行なわれている．
[t]
[MATH]
また，図[REF_fig:slide_example2]の例では，1文目の主題「代替バス利用者」が抽出され，「当初」，「バスレーン設置後」，「3月末」の対比関係が正しく解析されている．
しかし，2文目では，「代替バス」と「バスレーンの設置後」が対比していると間違って解析されており，正しくは，「当初」と「バスレーンの設置後」が対比関係にある．
この対比関係を正しく解析できるようにした上でさらにこのスライドをよくするには，2文目からは「利用時間」という主題を取り出し，1文目の「代替バス利用者」と対比させるのが望ましいが，これはかなり難しい処理であるといえる．
[t]
[MATH]
自動生成されたスライドで不自然な部分のほとんどは，談話構造解析誤りによるインデントのずれによるものであった．
[REF_sec:output_slide]章で説明したスライド生成のヒューリスティックルールによる大きな誤りはなく，また，主題部・非主題部の抽出や非主題部の簡約にも大きな誤りは見受けられなかった．
現在の文簡約は構文解析結果を基に行なう比較的シンプルなモデルであるが，十分機能しているといえる．
しかし，以下のように固有表現にかかる連体節などは削除した方がよりよいスライドになると考えられるので，今後は固有表現抽出を行ない，このような簡約を行なう予定である．
\ex. \Underline{大阪と神戸を結ぶ}ＪＲ神戸線，阪急電鉄神戸線，阪神電鉄本線の3線の不通により，一日45万人，ラッシュ時最大1時間12万人の足が奪われた．
\ex. \Underline{兵庫県下随一の3次救急医療機関である}神戸市立中央市民病院は，市街地と島を結ぶ神戸大橋の不通により震災直後の救急患者の受け入れがあまりできなかった．
たとえ自動スライドにインデントのずれや抽出したテキストが不自然であるといった誤りが少しあったとしても，入力テキストを音声合成と自動スライドのマルチモーダルに変換することは，ユーザに入力テキストをそのまま提示するよりもはるかによいことが実験により示された．
特に，テキストに大きな並列や対比関係がある場合は，入力テキストよりも見やすいスライドを生成できることが確認された．
