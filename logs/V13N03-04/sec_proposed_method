この章では，テキストの談話構造を解析する手法を述べる．
まず，談話構造のモデルを説明し，次に談話構造を解析する手順について説明する．
談話構造を図[REF_fig:discourse_structure]に示すようなものにモデル化した．
図において，矢印，ラベルはそれぞれ，文(S)または節(C)の接続，結束関係を意味する．
このモデルでは，初期状態として初期節点を設けており，文が初期節点に接続する時の結束関係を``初期化''とし，この文から新しい話題が始まることを意味する．
節と文を談話構造の基本単位とし，以下にあげる二種の結束関係を考える．
どのような結束関係を考えるかは研究者によって異なるが，スライドを自動生成するためにはこれらで十分であると考えた．
一文内における節間の関係(4種類)
並列，対比，順接，逆接
二文間の関係(11種類)
並列，対比，理由，条件，主題連鎖，焦点主題連鎖，詳細化，理由，原因結果，例提示，質問応答
次節から，談話構造解析について述べる．
解析の手順は[CITE]に基づいている．
解析は入力文一文ずつ行ない，談話構造を逐次的に構築する．
まず，入力文を節に分割し，節間の関係を解析する．
次に，すでに入力した文の中で，入力文と最も関連する文とその間の結束関係を様々な手がかりをもとに決定する．
図[REF_fig:discourse_structure]の例は，1文目から順番に談話構造を解析していき，4文目までの構造が決定され，5文目の解析を行なっている様子を示しており，様々な文・結束関係の確信度を計算した結果，最も高い確信度を得た4文目と詳細化の関係で接続すると解析されている．
まず，入力文をJUMANで形態素解析，KNPで構文・格解析を行なう．
その後，[REF_subsec:dpnd_in_s]節で述べる対比関係の抽出，[REF_subsec:relation_two_sentences]節で述べる主題・焦点の抽出，[REF_sec:topic_extract]章で述べる主題部・非主題部の抽出のために，あらかじめ，主題となりうる文節に主題属性を付与しておく．
以下にあげるようなパターンを満たす文節に主題属性を付与する．
パターンは形態素を単位に記述し，入力文の形態素解析結果と照合する．
延焼速度\Underline{は}，.
..
インナーシティ\Underline{では}，.
..
出火原因の判明した火災\Underline{において}，.
..
3線の不通\Underline{により}，.
..
また，以下のパターンの場合は〜の部分に主題属性を付与する．
…{する/した}{の/とき}は〜{だ/になる}
以下の例では，「安否情報など」に主題属性を付与する．
\ex.震災直後に被災者が必要と\Underline{したのは}，家族や友人・知人の消息に関する安否情報などだった．
なお，ここで付与した主題属性を利用して，[REF_subsec:dpnd_in_s]節や[REF_subsec:relation_two_sentences]節で対比・並列関係の解析を行なうが，関係を解析した結果，新たに主題属性が付与される場合がある．
談話構造において，何をその基本単位とするかは研究者によって様々な定義がなされてきた．
[CITE]では文，[CITE]では節，[CITE]では独自に定義された単位(clause-like unit)が談話構造の基本単位として採用されている．
本研究では，スライドに配置する箇条書きが適切な長さとなるように，節に分割する基準を，南[CITE]の従属節の分類に応じて以下のように設定した．
なお，節は談話構造解析の基本単位であると同時に，[REF_sec:topic_extract]章で説明する主題部・非主題部の抽出の基本単位でもある．
(例:〜が，〜けれども) :必ず分割する
(例:〜て，〜し) :前後の文節列が類似している場合，または，節の文字数が閾[4]値以上の場合に分割する
(例:〜ながら，〜つつ) :分割しない
レベルBにおける節の分割において利用している文節列の類似度は，KNPで並列構造を検出するために計算している任意の2つの文節列の類似度を用いる．
任意の2つの文節列の類似度計算は，まず，あらゆる2文節の類似度を語の一致，品詞の一致，シソーラス[CITE]による類似度などにより計算し，その上で，DPマッチングでそれらの文節間の類似度を組み合わせることにより行なわれる[CITE]．
[REF_ex:koube-level]の例では，「達したが」のレベルがCなので節に分割し，[REF_ex:hyakunin-level]の例では「減り」のレベルがBで，前後の文節列が類似しているので節に分割する．
[REF_ex:shinsai-level]の例では，前後の文節列が類似していないので，「なく」で分割せず，「迫られて」もレベルがAなので分割を行なわない．
\ex. [神戸市には，他都市，業界等からの仮設トイレ支援が約3,000基に\Underline{達したが，} [MATH]] [受入れのための仮置き場の確保が大きな課題となった．
]
\ex. [100人に1基行き渡った段階で設置についての苦情はかなり\Underline{減り，}[MATH]] [75人に1基達成できた段階では苦情が殆どなくなった．
]
\ex. [震災時の環境保全については事前の具体的な対応策等が\Underline{なく，}[MATH]必要に\Underline{迫られて}[MATH]進めざるを得なかった．
]
入力文を節に分割した後，一文内の節間の結束関係を求める．
まず，各節の親の節を構文解析結果に基づいて決定する．
すなわち，各節の親を，節の最終文節の係り先の文節を含む節とする．
次に，節間の結束関係を以下の基準で決定する．
二節が類似している場合
並列
対比
類似していない場合
順接(〜て，(連用形))
逆接(〜が，〜けれども)
まず，二節が類似していない場合，結束関係を順接または逆接とし，順接であるか逆接であるかは節末の形態素列のパターンで認識する．
二節が類似している場合，結束関係を対比または並列とする．
一般に並列の関係の場合，人または物がある二つの属性を持ち，対比の関係の場合，二つの異なる人または物が類似した属性を持つ．
従って，二つの節において，主題属性が付与された二文節が，二節の類似度を計算する際のDPマッチングのパス上で対応関係にあり，かつ，それらの類似度が閾値以上である場合，結束関係を対比とし，そうでない場合を並列とする．
以下の例では，二節が類似しており，主題属性が付与された「当初は」と「3月末までは」が類似しているので，対比の関係とする．
\ex. [代替バス利用者は，\Underline{当初は}1日あたり3〜5万人であったが，] [\Underline{3月末までは}1日約20万人が利用した．
]
また，どちらか一方の節の文節に主題属性が付与されており，もう一方の節の文節には主題属性が付与されていない場合でも，類似度が高い場合は対比関係とする．
以下の例では，二節が類似しており，主題属性が付与された，「(75人に1基達成できた)段階では」と主題属性のついていない「(100人に1基行き渡った)段階で」が類似しているので，結束関係を対比とし，「(100人に1基行き渡った)段階で」に主題属性を付与する．
\ex. [100人に1基行き渡った\Underline{段階で}設置についての苦情はかなり減り，] [75人に1基達成できた段階では苦情が殆どなくなった．
]
以下の例では，主題属性の付与された「パソコン通信ニフティサーブでは」とDPマッチングで対応付けられた「ボランティア情報」との間の類似度が閾値以下なので，結束関係を並列とする．
\ex. [\Underline{パソコン通信ニフティサーブでは}「地震情報コーナー」が開設され，] [ボランティア情報，安否情報，行政情報など各種の情報提供に用いられた．
]
二文間の関係は，種々の表層的手がかりをもとに，各入力文に対して，関係をもつ以前の文(接続文)とその間の結束関係を逐次的に求める．
新しい話題が導入された後に古くなった話題に接続することはないという仮定をおき，入力文は談話構造の一番最後の子供の文にのみ接続可能と考える．
図[REF_fig:discourse_structure]では，文5は初期節点，文3，文4に接続可能となり，文1，文2との接続を許さない．
そして，さまざまな接続可能文との間のさまざまな結束関係を考慮し，(1)手がかり表現，(2)語連鎖，(3)二文の類似度の3つの観点から確信度を計算し，最終的に最も高い確信度を得た関係を採用する．
以下，これらの3つの観点について順に詳しく述べる．
手がかり表現
種々の結束関係を示す，接続詞などの表層的な手がかり表現を認識し，その結束関係への確信度を得るために，表[REF_tab:rule]に示すようなルールを用意した．
表[REF_tab:rule]において，接続可能文パターン，入力文パターンは，それぞれに対する表層表現，文間の結束関係[4]([ ]で括られたもの)などのパターン，適用範囲とはどれだけ離れた文との関係まで考えるかである．
適用範囲において，「1」は接続可能文と入力文が隣接している場合のみルールが適用されることを，「*」はルールの適用に制限がないことをそれぞれ意味する．
ルールが一致した場合には，指定された結束関係欄の関係に対して，確信度欄の点数が与えられる．
この確信度は経験的に決定した．
語連鎖の検出
一般に文は主題を示す部分(主題部)とそれ以外の部分(非主題部)に分けることができ，主題を[REF_subsec:topic_feature]節で付与した主題属性のついている文節から名詞をとり出したもの，焦点を非主題部の名詞とする．
そして，二文間で，主題と主題，焦点と主題に語の連鎖(同一の語/句の出現)がある時は，それぞれ，主題連鎖，焦点主題連鎖の結束関係に確信度を与える．
語連鎖は，完全一致と部分一致を考え，完全一致の場合は確信度15点を，部分一致の場合は確信度10点を与える．
二文間の類似度
二文が並列または対比の関係にある場合，それらはある種の類似性を持つと仮定することができる．
二文間の類似度は，一文内の節の係り受け関係の所で述べた，任意の文節列間の類似度計算の方法で計算することができる．
そして，一文内の対比/並列の関係の検出と同じように，二文における主題が類似している場合は対比の関係に，類似していない場合は並列の関係に確信度を与える．
以下の例では，二文が類似しており，主題属性が付与されていない文[REF_ex:23]の「1月23日から」と，主題属性が付与されている文[REF_ex:28]の「1月28日から」に高い類似が認められるので，対比の関係に確信度を与え，「1月23日から」に主題属性を付与する．
\ex. \a.国道2号線が開通した\Underline{1月23日から，}大阪〜神戸間の代替バス輸送が実施された．
\b. \Underline{1月28日からは，}国道2号，43号線に代替バス優先レーンが設置され，効率的・円滑な運行が確保された．
この章では，入力テキストから，スライドに表示するテキストを抽出する手法を説明する．
[REF_subsec:relation_two_sentences]節で述べたように，文は主題部と非主題部から成る．
入力テキストから文を抽出してそのままスライドに配置するのではなく，主題部と非主題部を分けてスライドに配置することにより，スライドを見やすいものとする．
また，非主題部は一般に長いことが多いので，非主題部の簡約を行なうことにより，スライドを見やすくする．
主題部と非主題部の抽出は，[REF_subsec:divideintonodes]節で分割した節を基本単位として行なう．
一連の解析の様子を図[REF_fig:topic_extract]に示す．
[REF_subsec:topic_feature]節で付与した主題属性をもとに，主題部の抽出を行なう．
主題属性が付与された文節から構文木を子の方向にたどって句を抽出し，それを主題部とし，残りの部分を非主題部とする．
以下の例では，「延焼速度」が主題部として抽出され，「おおむね20〜40 m/h程度で，」が非主題部となる．
\ex. \Underline{延焼速度は}おおむね20〜40 m/h程度で，
節に主題属性が付与された文節が複数存在する場合は，そのうち一番前にあるもののみを抽出する．
以下の例では，「震災初日の被災地内では」と「視聴は」に主題属性が付与されているが，一番前の「震災初日の被災地内では」を主題部として抽出し，残りを非主題部とする．
\ex.震災初日の被災地内では停電などによりテレビの視聴\Underline{は}ほとんどできず，
ただし，主題属性のついているもので，対比関係にあると解析されたものは必ず抽出する．
以下の例では，前の節と後の節が対比の関係にあり，「神戸市では」に主題属性に主題属性が付与されており，主題属性の付与された「当初は」と「1月22日には」が対比の関係にあると解析されている．
このような場合，前の節からは，「神戸市では」と「当初は」の両方を主題として抽出する．
\ex. [\Underline{神戸市では}，\Underline{当初は}仮設トイレ300基程度で足りると考えていたが，] [\Underline{1月22日には}「仮設トイレ対策本部」を設置し対応することとなった．
]
スライドを見やすいものとするためには，できるだけ入力テキストの情報を保持した上で，テキストを簡約する必要がある．
本研究では，(1)構文解析結果に基づく不要な語あるいは語句の削除，(2)節末の用言の整形により，非主題部の簡約を行なう．
構文解析結果から不要部分の削除
構文解析結果から以下の不要な語句の削除を行なう．
接続詞
副詞
レベル:Aの節
副詞句
例) \Underline{バッテリー切れによる利用不能のほか}，救援・復旧関係者による被災地外から大量持ち込みによる輻輳の発生で利用できなくなった．
同格:節末の用言の子の文節に「〜など」があれば削除する．
例) \Underline{農林水産省，国土庁など}国の各機関
節末の用言の整形
次のようなルールにより節末の用言の整形を行なう．
サ変名詞+する/された[MATH]サ変名詞
例)実施された[MATH]実施
サ変名詞+が行われた[MATH]サ変名詞
例)輸送が行われた[MATH]輸送
名詞+判定詞[MATH]名詞
例)無被害であった[MATH]無被害
ナ形容詞/ナノ形容詞[MATH]活用語尾を削除
例)軽微であった[MATH]軽微
ただし，節末の用言に否定表現を含む場合は，否定表現を削除してしまわないように，否定表現より後の部分の整形を行なう．
節末の用言が表[REF_significant_words]にあげるもので，かつ，指定された格を持つ場合，重要表現とみなし，次節で説明するスライドの出力の際に，この節の非主題部の強調表示を行なう．
以下の例では，格解析の結果，「ことも」がガ格と解釈され，「指摘された」がガ格を持つことになるので，スライドの生成の際に強調表示を行なう．
\ex.大規模な供給施設が液状化地域に設置されていなかった\Underline{ことも}指摘された．
図[REF_fig:slide_output]に示すように，[REF_sec:ds_analysis]章で解析した談話構造に基づいて，[REF_sec:topic_extract]章で抽出した主題部，非主題部を次にあげるルールでスライドに配置する(図において，T，Nはそれぞれ主題部，非主題部を表す)．
メタデータなどで，入力テキストにタイトルがある場合，そのままスライドのタイトルとする．
タイトルがない場合は，入力文の最初の主題部をスライドのタイトルとする．
文の先頭から順番に，各節において，主題部があれば出力し，インデントを一つ下げて次の行に，非主題部を出力する．
主題部がなければ，非主題部だけを出力する．
以下の例のように，節に主題が二つある場合は，一つ目の主題部を出力し，インデントを一つ下げて次の行に二つ目の主題部を出力し，さらにインデントを一つ下げて次の行に非主題部を出力する．
\ex. \Underline{神戸市では}，\Underline{当初は}仮設トイレ300基程度で足りると考えていたが，
[MATH]
また，[REF_subsec:emphasize]節の処理により，非主題部が重要表現とみなされている場合は，強調表示を行なう．
節のインデントのレベルを親との結束関係に応じて以下のように設定する．
初期化:インデントレベルを0にする．
並列/対比:同じにする．
主題連鎖:主題部が親と同じ場合は，インデントを下げずに非主題部だけを出力する．
主題部が異なっている場合は，インデントを下げて，主題部と非主題部を出力する．
その他:親に対してインデントを一つ下げて出力する．
出力される箇条書きの行数が閾値以上となる場合，各スライドの行数が閾値以下になるように分割し，複数のスライドを生成する．
また，多くの研究者が指摘しているように，一般に談話構造の根に近い方が文の重要度が高いと考えられるので，談話構造は要約生成のための手がかりとなりうる[CITE]．
従って，根に近い文から抽出したテキストをスライドに出力し，談話構造木のある深さ以上の文から抽出したテキストはスライドに出力しないといった処理を行なうことにより，スライドに表示するテキストの量を制御することができる．
しかし，自動生成したスライドを音声合成とともにユーザに提示する場合，音声に対応するテキストが全くないとユーザが違和感を感じてしまうので，上記の処理を行なわなかった．
この章では，テキストの談話構造を解析する手法を述べる．
まず，談話構造のモデルを説明し，次に談話構造を解析する手順について説明する．
談話構造を図[REF_fig:discourse_structure]に示すようなものにモデル化した．
図において，矢印，ラベルはそれぞれ，文(S)または節(C)の接続，結束関係を意味する．
このモデルでは，初期状態として初期節点を設けており，文が初期節点に接続する時の結束関係を``初期化''とし，この文から新しい話題が始まることを意味する．
節と文を談話構造の基本単位とし，以下にあげる二種の結束関係を考える．
どのような結束関係を考えるかは研究者によって異なるが，スライドを自動生成するためにはこれらで十分であると考えた．
一文内における節間の関係(4種類)
並列，対比，順接，逆接
二文間の関係(11種類)
並列，対比，理由，条件，主題連鎖，焦点主題連鎖，詳細化，理由，原因結果，例提示，質問応答
次節から，談話構造解析について述べる．
解析の手順は[CITE]に基づいている．
解析は入力文一文ずつ行ない，談話構造を逐次的に構築する．
まず，入力文を節に分割し，節間の関係を解析する．
次に，すでに入力した文の中で，入力文と最も関連する文とその間の結束関係を様々な手がかりをもとに決定する．
図[REF_fig:discourse_structure]の例は，1文目から順番に談話構造を解析していき，4文目までの構造が決定され，5文目の解析を行なっている様子を示しており，様々な文・結束関係の確信度を計算した結果，最も高い確信度を得た4文目と詳細化の関係で接続すると解析されている．
まず，入力文をJUMANで形態素解析，KNPで構文・格解析を行なう．
その後，[REF_subsec:dpnd_in_s]節で述べる対比関係の抽出，[REF_subsec:relation_two_sentences]節で述べる主題・焦点の抽出，[REF_sec:topic_extract]章で述べる主題部・非主題部の抽出のために，あらかじめ，主題となりうる文節に主題属性を付与しておく．
以下にあげるようなパターンを満たす文節に主題属性を付与する．
パターンは形態素を単位に記述し，入力文の形態素解析結果と照合する．
延焼速度\Underline{は}，.
..
インナーシティ\Underline{では}，.
..
出火原因の判明した火災\Underline{において}，.
..
3線の不通\Underline{により}，.
..
また，以下のパターンの場合は〜の部分に主題属性を付与する．
…{する/した}{の/とき}は〜{だ/になる}
以下の例では，「安否情報など」に主題属性を付与する．
\ex.震災直後に被災者が必要と\Underline{したのは}，家族や友人・知人の消息に関する安否情報などだった．
なお，ここで付与した主題属性を利用して，[REF_subsec:dpnd_in_s]節や[REF_subsec:relation_two_sentences]節で対比・並列関係の解析を行なうが，関係を解析した結果，新たに主題属性が付与される場合がある．
談話構造において，何をその基本単位とするかは研究者によって様々な定義がなされてきた．
[CITE]では文，[CITE]では節，[CITE]では独自に定義された単位(clause-like unit)が談話構造の基本単位として採用されている．
本研究では，スライドに配置する箇条書きが適切な長さとなるように，節に分割する基準を，南[CITE]の従属節の分類に応じて以下のように設定した．
なお，節は談話構造解析の基本単位であると同時に，[REF_sec:topic_extract]章で説明する主題部・非主題部の抽出の基本単位でもある．
(例:〜が，〜けれども) :必ず分割する
(例:〜て，〜し) :前後の文節列が類似している場合，または，節の文字数が閾[4]値以上の場合に分割する
(例:〜ながら，〜つつ) :分割しない
レベルBにおける節の分割において利用している文節列の類似度は，KNPで並列構造を検出するために計算している任意の2つの文節列の類似度を用いる．
任意の2つの文節列の類似度計算は，まず，あらゆる2文節の類似度を語の一致，品詞の一致，シソーラス[CITE]による類似度などにより計算し，その上で，DPマッチングでそれらの文節間の類似度を組み合わせることにより行なわれる[CITE]．
[REF_ex:koube-level]の例では，「達したが」のレベルがCなので節に分割し，[REF_ex:hyakunin-level]の例では「減り」のレベルがBで，前後の文節列が類似しているので節に分割する．
[REF_ex:shinsai-level]の例では，前後の文節列が類似していないので，「なく」で分割せず，「迫られて」もレベルがAなので分割を行なわない．
\ex. [神戸市には，他都市，業界等からの仮設トイレ支援が約3,000基に\Underline{達したが，} [MATH]] [受入れのための仮置き場の確保が大きな課題となった．
]
\ex. [100人に1基行き渡った段階で設置についての苦情はかなり\Underline{減り，}[MATH]] [75人に1基達成できた段階では苦情が殆どなくなった．
]
\ex. [震災時の環境保全については事前の具体的な対応策等が\Underline{なく，}[MATH]必要に\Underline{迫られて}[MATH]進めざるを得なかった．
]
入力文を節に分割した後，一文内の節間の結束関係を求める．
まず，各節の親の節を構文解析結果に基づいて決定する．
すなわち，各節の親を，節の最終文節の係り先の文節を含む節とする．
次に，節間の結束関係を以下の基準で決定する．
二節が類似している場合
並列
対比
類似していない場合
順接(〜て，(連用形))
逆接(〜が，〜けれども)
まず，二節が類似していない場合，結束関係を順接または逆接とし，順接であるか逆接であるかは節末の形態素列のパターンで認識する．
二節が類似している場合，結束関係を対比または並列とする．
一般に並列の関係の場合，人または物がある二つの属性を持ち，対比の関係の場合，二つの異なる人または物が類似した属性を持つ．
従って，二つの節において，主題属性が付与された二文節が，二節の類似度を計算する際のDPマッチングのパス上で対応関係にあり，かつ，それらの類似度が閾値以上である場合，結束関係を対比とし，そうでない場合を並列とする．
以下の例では，二節が類似しており，主題属性が付与された「当初は」と「3月末までは」が類似しているので，対比の関係とする．
\ex. [代替バス利用者は，\Underline{当初は}1日あたり3〜5万人であったが，] [\Underline{3月末までは}1日約20万人が利用した．
]
また，どちらか一方の節の文節に主題属性が付与されており，もう一方の節の文節には主題属性が付与されていない場合でも，類似度が高い場合は対比関係とする．
以下の例では，二節が類似しており，主題属性が付与された，「(75人に1基達成できた)段階では」と主題属性のついていない「(100人に1基行き渡った)段階で」が類似しているので，結束関係を対比とし，「(100人に1基行き渡った)段階で」に主題属性を付与する．
\ex. [100人に1基行き渡った\Underline{段階で}設置についての苦情はかなり減り，] [75人に1基達成できた段階では苦情が殆どなくなった．
]
以下の例では，主題属性の付与された「パソコン通信ニフティサーブでは」とDPマッチングで対応付けられた「ボランティア情報」との間の類似度が閾値以下なので，結束関係を並列とする．
\ex. [\Underline{パソコン通信ニフティサーブでは}「地震情報コーナー」が開設され，] [ボランティア情報，安否情報，行政情報など各種の情報提供に用いられた．
]
二文間の関係は，種々の表層的手がかりをもとに，各入力文に対して，関係をもつ以前の文(接続文)とその間の結束関係を逐次的に求める．
新しい話題が導入された後に古くなった話題に接続することはないという仮定をおき，入力文は談話構造の一番最後の子供の文にのみ接続可能と考える．
図[REF_fig:discourse_structure]では，文5は初期節点，文3，文4に接続可能となり，文1，文2との接続を許さない．
そして，さまざまな接続可能文との間のさまざまな結束関係を考慮し，(1)手がかり表現，(2)語連鎖，(3)二文の類似度の3つの観点から確信度を計算し，最終的に最も高い確信度を得た関係を採用する．
以下，これらの3つの観点について順に詳しく述べる．
手がかり表現
種々の結束関係を示す，接続詞などの表層的な手がかり表現を認識し，その結束関係への確信度を得るために，表[REF_tab:rule]に示すようなルールを用意した．
表[REF_tab:rule]において，接続可能文パターン，入力文パターンは，それぞれに対する表層表現，文間の結束関係[4]([ ]で括られたもの)などのパターン，適用範囲とはどれだけ離れた文との関係まで考えるかである．
適用範囲において，「1」は接続可能文と入力文が隣接している場合のみルールが適用されることを，「*」はルールの適用に制限がないことをそれぞれ意味する．
ルールが一致した場合には，指定された結束関係欄の関係に対して，確信度欄の点数が与えられる．
この確信度は経験的に決定した．
語連鎖の検出
一般に文は主題を示す部分(主題部)とそれ以外の部分(非主題部)に分けることができ，主題を[REF_subsec:topic_feature]節で付与した主題属性のついている文節から名詞をとり出したもの，焦点を非主題部の名詞とする．
そして，二文間で，主題と主題，焦点と主題に語の連鎖(同一の語/句の出現)がある時は，それぞれ，主題連鎖，焦点主題連鎖の結束関係に確信度を与える．
語連鎖は，完全一致と部分一致を考え，完全一致の場合は確信度15点を，部分一致の場合は確信度10点を与える．
二文間の類似度
二文が並列または対比の関係にある場合，それらはある種の類似性を持つと仮定することができる．
二文間の類似度は，一文内の節の係り受け関係の所で述べた，任意の文節列間の類似度計算の方法で計算することができる．
そして，一文内の対比/並列の関係の検出と同じように，二文における主題が類似している場合は対比の関係に，類似していない場合は並列の関係に確信度を与える．
以下の例では，二文が類似しており，主題属性が付与されていない文[REF_ex:23]の「1月23日から」と，主題属性が付与されている文[REF_ex:28]の「1月28日から」に高い類似が認められるので，対比の関係に確信度を与え，「1月23日から」に主題属性を付与する．
\ex. \a.国道2号線が開通した\Underline{1月23日から，}大阪〜神戸間の代替バス輸送が実施された．
\b. \Underline{1月28日からは，}国道2号，43号線に代替バス優先レーンが設置され，効率的・円滑な運行が確保された．
この章では，入力テキストから，スライドに表示するテキストを抽出する手法を説明する．
[REF_subsec:relation_two_sentences]節で述べたように，文は主題部と非主題部から成る．
入力テキストから文を抽出してそのままスライドに配置するのではなく，主題部と非主題部を分けてスライドに配置することにより，スライドを見やすいものとする．
また，非主題部は一般に長いことが多いので，非主題部の簡約を行なうことにより，スライドを見やすくする．
主題部と非主題部の抽出は，[REF_subsec:divideintonodes]節で分割した節を基本単位として行なう．
一連の解析の様子を図[REF_fig:topic_extract]に示す．
[REF_subsec:topic_feature]節で付与した主題属性をもとに，主題部の抽出を行なう．
主題属性が付与された文節から構文木を子の方向にたどって句を抽出し，それを主題部とし，残りの部分を非主題部とする．
以下の例では，「延焼速度」が主題部として抽出され，「おおむね20〜40 m/h程度で，」が非主題部となる．
\ex. \Underline{延焼速度は}おおむね20〜40 m/h程度で，
節に主題属性が付与された文節が複数存在する場合は，そのうち一番前にあるもののみを抽出する．
以下の例では，「震災初日の被災地内では」と「視聴は」に主題属性が付与されているが，一番前の「震災初日の被災地内では」を主題部として抽出し，残りを非主題部とする．
\ex.震災初日の被災地内では停電などによりテレビの視聴\Underline{は}ほとんどできず，
ただし，主題属性のついているもので，対比関係にあると解析されたものは必ず抽出する．
以下の例では，前の節と後の節が対比の関係にあり，「神戸市では」に主題属性に主題属性が付与されており，主題属性の付与された「当初は」と「1月22日には」が対比の関係にあると解析されている．
このような場合，前の節からは，「神戸市では」と「当初は」の両方を主題として抽出する．
\ex. [\Underline{神戸市では}，\Underline{当初は}仮設トイレ300基程度で足りると考えていたが，] [\Underline{1月22日には}「仮設トイレ対策本部」を設置し対応することとなった．
]
スライドを見やすいものとするためには，できるだけ入力テキストの情報を保持した上で，テキストを簡約する必要がある．
本研究では，(1)構文解析結果に基づく不要な語あるいは語句の削除，(2)節末の用言の整形により，非主題部の簡約を行なう．
構文解析結果から不要部分の削除
構文解析結果から以下の不要な語句の削除を行なう．
接続詞
副詞
レベル:Aの節
副詞句
例) \Underline{バッテリー切れによる利用不能のほか}，救援・復旧関係者による被災地外から大量持ち込みによる輻輳の発生で利用できなくなった．
同格:節末の用言の子の文節に「〜など」があれば削除する．
例) \Underline{農林水産省，国土庁など}国の各機関
節末の用言の整形
次のようなルールにより節末の用言の整形を行なう．
サ変名詞+する/された[MATH]サ変名詞
例)実施された[MATH]実施
サ変名詞+が行われた[MATH]サ変名詞
例)輸送が行われた[MATH]輸送
名詞+判定詞[MATH]名詞
例)無被害であった[MATH]無被害
ナ形容詞/ナノ形容詞[MATH]活用語尾を削除
例)軽微であった[MATH]軽微
ただし，節末の用言に否定表現を含む場合は，否定表現を削除してしまわないように，否定表現より後の部分の整形を行なう．
節末の用言が表[REF_significant_words]にあげるもので，かつ，指定された格を持つ場合，重要表現とみなし，次節で説明するスライドの出力の際に，この節の非主題部の強調表示を行なう．
以下の例では，格解析の結果，「ことも」がガ格と解釈され，「指摘された」がガ格を持つことになるので，スライドの生成の際に強調表示を行なう．
\ex.大規模な供給施設が液状化地域に設置されていなかった\Underline{ことも}指摘された．
図[REF_fig:slide_output]に示すように，[REF_sec:ds_analysis]章で解析した談話構造に基づいて，[REF_sec:topic_extract]章で抽出した主題部，非主題部を次にあげるルールでスライドに配置する(図において，T，Nはそれぞれ主題部，非主題部を表す)．
メタデータなどで，入力テキストにタイトルがある場合，そのままスライドのタイトルとする．
タイトルがない場合は，入力文の最初の主題部をスライドのタイトルとする．
文の先頭から順番に，各節において，主題部があれば出力し，インデントを一つ下げて次の行に，非主題部を出力する．
主題部がなければ，非主題部だけを出力する．
以下の例のように，節に主題が二つある場合は，一つ目の主題部を出力し，インデントを一つ下げて次の行に二つ目の主題部を出力し，さらにインデントを一つ下げて次の行に非主題部を出力する．
\ex. \Underline{神戸市では}，\Underline{当初は}仮設トイレ300基程度で足りると考えていたが，
[MATH]
また，[REF_subsec:emphasize]節の処理により，非主題部が重要表現とみなされている場合は，強調表示を行なう．
節のインデントのレベルを親との結束関係に応じて以下のように設定する．
初期化:インデントレベルを0にする．
並列/対比:同じにする．
主題連鎖:主題部が親と同じ場合は，インデントを下げずに非主題部だけを出力する．
主題部が異なっている場合は，インデントを下げて，主題部と非主題部を出力する．
その他:親に対してインデントを一つ下げて出力する．
出力される箇条書きの行数が閾値以上となる場合，各スライドの行数が閾値以下になるように分割し，複数のスライドを生成する．
また，多くの研究者が指摘しているように，一般に談話構造の根に近い方が文の重要度が高いと考えられるので，談話構造は要約生成のための手がかりとなりうる[CITE]．
従って，根に近い文から抽出したテキストをスライドに出力し，談話構造木のある深さ以上の文から抽出したテキストはスライドに出力しないといった処理を行なうことにより，スライドに表示するテキストの量を制御することができる．
しかし，自動生成したスライドを音声合成とともにユーザに提示する場合，音声に対応するテキストが全くないとユーザが違和感を感じてしまうので，上記の処理を行なわなかった．
