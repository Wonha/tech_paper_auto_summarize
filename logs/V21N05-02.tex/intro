\section{はじめに}

本論文では，語義曖昧性解消(Word Sense Disambiguation, WSD)の領域適応に対して，
共変量シフト下の学習を試みる．
共変量シフト下の学習では確率密度比を重みとした重み付き学習を行うが，
WSD のタスクでは算出される確率密度比が小さくなる傾向がある．
ここではソース領域のコーパスとターゲット領域のコーパスとを合わせたコーパスを
ソース領域のコーパスと見なすことで，この問題に対処する．
なお本手法はターゲット領域のデータにラベル付けしないため，教師なし領域適応手法に分類される．

WSD は文中の多義語の語義を識別するタスクである．通常，あるコーパス$S$から
対象単語の用例を取り出し，その用例中の対象単語の語義を付与した訓練データを作成し，
そこから SVM 等の分類器を学習することで WSD を解決する．
ここで学習した分類器を適用する用例がコーパス$S$とは異なるコーパス$T$内のものである場合，
学習した分類器の精度が悪い場合がある．これが領域適応の問題であり，
自然言語処理では WSD 以外にも様々なタスクで問題となるため，近年，活発に研究されている\cite{da-book,mori,kamishima}．

今，対象単語$w$の用例を${\bm x}$，$w$の語義の集合を$C$とする．
${\bm x}$内の$w$の語義が$c \in C$である確率を$P(c|{\bm x})$とおくと，
WSD は$\arg \max_{c \in C} P(c|{\bm x})$を求めることで解決できる．
領域適応では，コーパス$S$（ソース領域）から得られた訓練データを用いて，
$P(c|{\bm x})$を推定するので，得られるのは$S$上の条件付き分布$P_S (c|{\bm x})$であるが，
識別の対象はコーパス$T$（ターゲット領域）内のデータであるため必要と
されるのは$T$上の条件付き分布$P_T (c|{\bm x})$である．
このため領域適応の問題は$P_S (c|{\bm x}) \ne P_T (c|{\bm x})$から生じているように見えるが，
用例${\bm x}$がどのような領域で現れたとしても，その用例${\bm x}$内の対象単語$w$の
語義が変化するとは考えづらい．
このため$P_S (c|{\bm x}) = P_T (c|{\bm x})$と考えられる．
$P_S (c|{\bm x}) = P_T (c|{\bm x})$が成立しているなら，$P_T (c|{\bm x})$の代わりに
$P_S (c|{\bm x})$を用いて識別すればよいと思われるが，この場合，識別の精度が悪いことが多い．
これは$P_S ({\bm x}) \ne P_T ({\bm x})$から生じている．
$P_S (c|{\bm x}) = P_T (c|{\bm x})$かつ$P_S ({\bm x}) \ne P_T ({\bm x})$という仮定は
共変量シフトと呼ばれる\cite{sugiyama-book}．
自然言語処理の多くの領域適応のタスクは共変量シフトが成立していると考えられる\cite{da-book}．

ソース領域のコーパス$S$から得られる訓練データを$D = \{ ({\bm x_i},c_i) \}_{i=1}^N$とおく．
一般に共変量シフト下の学習では確率密度比$w({\bm x}) = P_T({\bm x})/P_S({\bm x})$を重みとした
以下の重み付き対数尤度を最大にするパラメータ${\bm \theta}$を求めることで，
$P_T (c|{\bm x})$ を構築する．
\[
\sum_{i=1}^{N} w({\bm x_i}) \log P_T (c_i|{\bm x_i};{\bm \theta})
\]

共変量シフト下の学習の要は確率密度比$w({\bm x})$の算出であるが，その方法は大きく2つに分類できる．
1つは$P_T({\bm x})$と$P_S({\bm x})$をそれぞれ求め，その比を求めることで
$w({\bm x})$を求める方法である．もう1つは$w({\bm x})$を直接モデル化する方法である\cite{sugiyama-2010}．
ただしどちらの方法をとっても，WSD の領域適応に対しては，求められる値が低くなる傾向がある．
この問題に対しては，確率密度比を$p$乗($0 < p < 1$)したり\cite{sugiyama-2006-09-05}，
相対確率密度比\cite{yamada2011relative}を使うなど，
求めた確率密度比を上方に修正する手法が存在する
\footnote{これらの手法は正確には確率密度比を 1 に近づける手法であるが，
多くの場合，確率密度比は 1 以下の値であるため，
ここではこれらの手法も確率密度比を上方に修正する手法と呼ぶことにする．}．
本論文では$P_T({\bm x})$と$P_S({\bm x})$をそれぞれ求める手法を用いる際に，
ターゲット領域のコーパスとソース領域のコーパスを合わせたコーパスを，
新たにソース領域のコーパス$S$と見な
して確率密度比を求めることを提案する．
提案手法は必ずしも確率密度比を上方に修正する訳ではないが，
多くの場合，この処理により$P_S({\bm x})$の値が減少し，結果的に$w({\bm x})$の値が増加する．

なお，本論文で利用する手法は，ターゲット領域のラベル付きデータを利用しないために，
教師なし領域適応手法に属する．当然，ターゲット領域のラベル付きデータを利用する
教師付き領域適応手法を用いる方が，WSD の識別精度は高くなる．
しかし本論文では教師なし領域適応手法を扱う．理由は3つある．
1 つ目は，教師なし領域適応手法はラベル付けするコストがないという大きな長所があるからである．
2 つ目は，共変量シフト下の学習はターゲット領域の
ラベル付きデータを利用しない設定になっているからである．
3 つ目は， WSD の領域適応の場合，対象単語毎に領域間距離が異なり，
コーパスの領域が異なっていても，領域適応の問題が生じていないケースも多いからである．
領域適応の問題が生じている，いないの問題を考察していくには，
ターゲット領域のラベル付きデータを利用しない教師なし領域適応手法の方が適している．

実験では現代日本語書き言葉均衡コーパス (Balanced Corpus of Contemporary Written Japanese, 
BCCWJ \cite{bccwj}) における3つの領域 OC（Yahoo! 知恵袋），PB（書籍）及び PN（新聞）
を利用する．SemEval-2 の日本語 WSD タスク\cite{semeval-2010}ではこれらのコーパスの一部に語義タグを付けた
データを公開しており，そのデータを利用する．
すべての領域である程度の頻度が存在する多義語 16単語を対象にして，WSD の領域適応の実験を行う．
領域適応としては OC→PB，PB→PN，PN→OC，OC→PN，PN→PB，PB→OC の計 6通りが存在する．
結果 $16 \times 6 = 96$通りのWSD の領域適応の問題に対して実験を行った．
その結果，提案手法による重み付けの効果を確認できた．

また，従来手法はベースラインよりも低い値となったが，
これは多くの WSD の教師なし領域適応では負の転移が生じていない，
言い換えれば実際には領域適応の問題になっていないことから生じていると考えられる．
考察では負の転移と重み付けとの関連，また
負の転移と関連の深い Misleading データの存在と重み付けとの関連を
中心に議論した．


