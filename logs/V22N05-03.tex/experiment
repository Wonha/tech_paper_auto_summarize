\section{実験}

\subsection{実験設定}

\subsubsection{データ}

\begin{table}[b]
\caption{10個のラベルと各ラベルの入力（説明文書）の数とそれらの全ラベルに占める割合}
\label{tab:dist}
\input{01table02.txt}
\vspace{-0.5\Cvs}
\end{table}
\begin{table}[b]
\caption{学習用データセット}
\label{tab:data}
\input{01table03.txt}
\end{table}


学習と評価には10個のラベルとそれらの入力（説明文書）のペアから構成されるデータを用いた．
表~\ref{tab:dist}はラベル名と各ラベルの入力（説明文書）の数とそれらの全ラベルに占める割合を示す\footnote{自動収集データにおいて各ラベルのデータ数に多少のバラつきがあるが，ある程度のバランスが取れている．}．
ただし，学習データは，手動収集データをベースとし，そのベースとなるデータに異なる数の自動収集データと疑似データを加えることにより13個のデータセット（表~\ref{tab:data}）を作成して用いた．表中のm300はベースとなるデータセットで手動で収集した300個のデータである．また，たとえばa2400は2,400個の自動収集データとm300で構成されたデータセット，p2400は2,400個の疑似データとm300から構成されたデータセット，そしてa2400p2400は2,400個の自動収集データ，2,400個の疑似データ，そしてm300から構成されたデータセットである．
また，評価には学習データと異なる100個のデータを用いた． 個々の説明文書は2.4節で述べた方法で，2 ラベル間で重複する単語を除外する場合と 3 ラベル以上で共通する単語を除外する場合においてそれぞれ182と223次元の特徴ベクトルに変換される．


\subsubsection{パラメータのチューニング}

\begin{table}[b]
\caption{グリッドサーチに用いるパラメータ}
\label{tab:gs}
\input{01table04.txt}
\end{table}

各種の機械学習の各学習データセットにおける最適なパラメータは，それぞれの学習データセットに対しグリッドサーチと5-fold交差検証を行って決定した．グリッドサーチに用いるパラメータの詳細は表~\ref{tab:gs}にまとめている．たとえば，DBNの入力が182次元の場合の構造（隠れ層）の欄に152-121-91がある．これは，そのDBNは182-{\bf 152-121-91}-10という構造を持つ，ということを表している．ただし，数字182と10は入力層と出力層のユニット数であり，それぞれ特徴ベクトルの次元数とラベルの数に対応している．また，これら隠れ層のユニット数は恣意的にではなく，前半の 3 つについては線形等間隔に設定している．すなわち，入力層のユニット数 (182) から，ピラミッド的に，最初の隠れ層のユニット数を$182 \times 5/6$ (152)， 次の隠れ層のユニット数を$182 \times 4/6$ (121)， そして， 最後の隠れ層のユニット数を$182 \times 3/6$ (91) のように設定している．一方，後半の 3 つについては，Bengioの\cite{Bengio:12}
の薦め，すなわち，過学習への対処が適切であれば隠れ層のユニット数は基本的に多いほどよい，ネットワーク構造は各層が同じサイズでよい場合が多い（ピラミッドまたは逆ピラミッドである必要はない）に基づき，すべての隠れ層のユニット数を入力層のユニット数の3/2倍であるように設定した．入力層のユニット数が223の場合も同様な考え方に基づいて設定した．

DBNがMLPとSVMよりパラメータが多いため，同じ細かさのグリッドサーチで最適なパラメータを決めてしまうと，パラメータの多いDBNのほうが細かなチューニングができるため有利になる可能性がある．このようなバイアスをなくすために，
MLPとSVMについてそのパラメータグリッドをより細かくし，MLPとSVMの探索すべきパラメータセットの数（つまり，パラメータの組み合わせの数）をDBNのそれと等しいかそれ以上にした．一方，MLPについては，構造，学習率，学習回数がDBNとまったく同じものも比較に用いた．本稿では後者をMLP 1，前者をMLP 2と呼ぶ．その結果，DBNとMLP 2は同じく864通りのパラメータセット，SVM (Linear) とSVM (RBF) は900通りのパラメータセット，また，MLP 1は72通りのパラメータセットを持つことになる．


\subsubsection{ベースライン}

\begin{figure}[b]
\begin{center}
\includegraphics{22-4ia1f5.eps}
\end{center}
\caption{ベースライン手法 (Baseline 1, Baseline 2) およびその正解率算出のアルゴリズム}
\label{fig:baseline}
\end{figure}

MLPとSVMに加え，用例に基づく手法をベースラインとして比較実験に加えた．これは，評価データを学習データの一つひとつと比較し，共通する単語のもっとも多い，または共通する単語数をその評価データの単語数で正規化した値がもっとも大きい学習データのラベルを評価データのラベルとする方法である．ここで両者をそれぞれBaseline 1とBaseline 2と呼ぶ．
図~\ref{fig:baseline}は本手法および本手法による予測結果の正解率算出のアルゴリズムを示す．ただし，カウントに用いる単語は2.4節で述べた(1)〜(4)の手順に従って説明文書から抽出されたものである．


\subsection{実験結果}

\subsubsection{182次元の特徴ベクトルを使用した場合}

図~\ref{fig:prec}は各機械学習において，異なる学習データセットを用いた場合の評価データへの予測精度を示す．ここでの精度は，各パラメータセットの交差検証誤差を昇順（小さい順）に並べたときの上位N個（ただしNは5から30まで可変）のパラメータセットを用いた場合の平均精度である．なお，本論文に用いられている平均精度はすべてマクロ平均で算出したものである．

\begin{figure}[p]
\begin{center}
\includegraphics{22-4ia1f6.eps}
\end{center}
\hangcaption{交差検証誤差の昇順で上位N(5〜30)セットのパラメータを用いた場合の各機械学習の平均精度についての学習データセット間の比較（182次元の特徴ベクトルを用いた場合）}
\label{fig:prec}\end{figure}

図に示しているように，全般的に見れば，学習データセットa2400p2400を用いた場合（逆三角形マークの点線\footnote{点線と破線の違いに注意されたい．}），すなわち手動収集データに自動収集データと疑似データの両方を最も多く加えた場合，DBNとMLPは最高の精度，そしてSVMもほぼ最高の精度を出している\footnote{SVM (RBF)の場合，逆三角形マークの点線は四角形マークの点線と重ねていることに注意されたい．}．また，手動収集データに自動収集データと疑似データの両方を適度に加えた場合（点線）は，手動収集データのみの場合（星マークの太線）に比べ，DBNとMLPとSVM  (RBF)の予測精度はおおむね向上している．しかしSVM (Linear) についてはそのような傾向は見られなかった\footnote{これはSVM  (Linear)が線形分離可能なデータしか取り扱えないことに起因するものと思われる．}．さらに，手動収集データのみを用いた場合と，自動収集データと疑似データのどちらか一方のみを手動収集データに加えた場合について比べると，DBNとSVM (RBF)については自動収集データのみを加えた場合（実線），MLPについては疑似データのみを加えた場合（破線）のほうがそれぞれに精度の向上が見られた．自動収集データのほうが疑似データよりもノイズが多いことから，上記結果はDBNとSVM (RBF)のほうがMLPよりもノイズの多い学習データを有効利用できる可能性が高いことを示している．

図~\ref{fig:cmp}は各機械学習間の評価データへの予測精度の比較を示す．ここでの精度は図~\ref{fig:prec}と同様，各パラメータセットの交差検証誤差を昇順に並べたときの上位N個（ただしNは5から30まで可変）のパラメータセットを用いた場合の平均精度である．学習データセットも図~\ref{fig:prec}のとまったく同じであるがそれらの詳細の明示は省略されている．ただし，各グラフの縦軸の範囲が統一されているため，グラフDBN vs. SVM (RBF)において，SVM (RBF)の精度が0.9未満なもの（計 4 本の線）が表示されていない（なお，すべての結果は図~\ref{fig:prec}には示されている）．この図からはDBNのほう（実線）が他の機械学習（破線）より性能がよいことが一目瞭然にわかる．

\begin{figure}[p]
\begin{center}
\includegraphics{22-4ia1f7.eps}
\end{center}
\hangcaption{交差検証誤差の昇順で上位N(5〜30)セットのパラメータを用いた場合の平均精度についての機械学習間の比較（182次元の特徴ベクトルを用いた場合）}
\label{fig:cmp}
\end{figure}
\begin{table}[p]
\caption{ベースラインの精度}
\label{tab:baseline}
\input{01table05.txt}
\end{table}

表~\ref{tab:baseline}，\ref{tab:rst-top1}，\ref{tab:rst-top5}，\ref{tab:rst-top10}はそれぞれ，各学習データセットを用いた場合の，ベースラインの予測精度，交差検証誤差が最小のパラメータセットを用いた場合の予測精度，交差検証誤差を昇順に並べたときの上位5個，10個のパラメータセットを用いた場合の平均予測精度を示す．
まず，機械学習とは対照的に，ベースライン手法では，ノイズの多い学習データを加えても（つまり，手動収集データに自動収集データのみを加えた場合と，自動収集データと疑似データの両方を加えた場合），予測精度の向上に役立たないばかりか，逆に，これらのデータは予測精度を大きく下げてしまった．
次に，ほとんどの場合において，ベースラインの予測精度は機械学習のそれよりかなり低かった．
また，ほとんどの場合において，DBNがすべての機械学習において最高の予測精度を出している（各学習セットにおいて各機械学習手法中の最高の精度は太字で表されている）．

\begin{table}[t]
\hangcaption{交差検証誤差が最小のパラメータセットを用いたDBN, MLP, SVMの予測精度（182次元の特徴ベクトルを用いた場合）}
\label{tab:rst-top1}
\input{01table06.txt}
\end{table}
\begin{table}[t]
\hangcaption{交差検証誤差を昇順に並べたときの上位5個のパラメータセットを用いたDBN, MLP, SVMの平均予測精度（182次元の特徴ベクトルを用いた場合）}
\label{tab:rst-top5}
\input{01table07.txt}
\end{table}


\subsubsection{223次元の特徴ベクトルを使用した場合}

前節の実験結果はすでに提案手法の予測精度が従来の機械学習手法より高いことを示しただけでなく，
学習データにおけるノイズに対する頑健性もある程度示せたと考える．しかし上記実験では，手動学習データのラベル間の重複単語を除外していたため，疑似データの作成時はそれらをノイズとして加えることができず，提案手法のノイズへの頑健性に疑問が残る．本節の実験は，2 ラベル間の重複単語を残しているため，前節の実験よりも，より適切にノイズの頑健性を確認できると考える．

\begin{table}[t]
\hangcaption{交差検証誤差を昇順に並べたときの上位10個のパラメータセットを用いたDBN, MLP, SVMの平均予測精度（182次元の特徴ベクトルを用いた場合）}
\label{tab:rst-top10}
\input{01table08.txt}
\end{table}

\begin{figure}[p]
\begin{center}
\includegraphics{22-4ia1f8.eps}
\end{center}
\hangcaption{交差検証誤差の昇順で上位N(5〜30)セットのパラメータを用いた場合の各機械学習の平均精度についての学習データセット間の比較（223次元の特徴ベクトルを用いた場合）}
\label{fig:prec-add}
\end{figure}

図~\ref{fig:prec-add}は図~\ref{fig:prec}と同様，各機械学習において，異なる学習データセットを用いた場合の評価データへの予測精度を示す．DBNのグラフにおいて，すべての点線と2本の実線が星マークの太線（つまり手動データ）の上にあること，また，SVM (RBF)においてすべての点線と実線が星マークの太線の上にあることから，前の実験結果と同様，DBNとSVM (RBF)については疑似データを含めたノイズのある学習データの利用が有効であることが確認できる．一方，MLPとSVM (Linear)については，手動データの星マークの太線がほとんど一番上に位置していることから，疑似データを含めたノイズのある学習データの有効性がほとんど見られない．すなわち，MLPとSVM (Linear)のノイズに対する頑健性については，前節の実験結果よりも悪い結果となった（逆にDBNの優位性がより顕著になったとも言える）．なお，182次元の特徴ベクトルを用いた実験結果ではa2400p2400を用いた場合（逆三角形マークの点線），すなわち手動収集データに自動収集データと疑似データの両方を最も多く加えた場合，DBNが最高の精度を出しているのに対し，本実験結果ではDBNはa600p600を用いた場合（正三角形マークの点線）に最高の精度を出している．これは，精度の高いデータに対し，加えてよいノイズのあるデータについては適正の数があるはずで，次元数が増えると個々の特徴ベクトルの本来のノイズの度合いが増強したため，ノイズデータの適正数が減少したと考えることができ，両者の結果は矛盾しないと思われる．


\subsubsection{有意差検定}

\begin{table}[b]
\vspace{-0.5\Cvs}
\hangcaption{交差検証誤差が最小のパラメータセットを用いた場合のDBNと他の手法との性能比較に関する両側符号検定とt検定の結果}
\label{tab:test-top1}
\input{01table09.txt}
\vspace{4pt}\small
数値はp値であり，有意水準10\%で有意に差があるものには*，有意水準5\%で有意に差が
あるものには**，有意水準1\%で有意に差があるものには***を付けている．\par
\end{table}
\begin{table}[b]
\hangcaption{各学習データセットについて，それらにおける交差検証誤差を昇順に並べたときの上位10個のパラメータセットを用いた場合の平均予測精度についてのDBNと他の手法との性能比較に関する両側t検定の結果}
\label{tab:test-top10}
\input{01table10.txt}
\small
数値はp値であり，有意水準10\%で有意に差があるものには*，有意水準5\%で有意に差が
あるものには**，有意水準1\%で有意に差があるものには***を付けている．\par
\end{table}

交差検証誤差が最小のパラメータセットを用いた場合と，交差検証誤差を昇順に並べたときの上位10個のパラメータセットを用いた場合について，DBNと他の手法との性能の有意差検定を行った．
交差検証誤差が最小のパラメータセットを用いた場合，各学習データセットについて単独で検定を行うとデータ数が少なすぎるため，各学習データセットの結果を 1 つにまとめて符号検定とt検定を行った．
一方，交差検証誤差上位10個のパラメータセットを用いた場合は各学習データセットについて単独でt
検定を行った．
検定結果を表~\ref{tab:test-top1}，\ref{tab:test-top10} に示す．
これらの結果から，182次元と223次元の特徴ベクトルのいずれを用いても，多数の場合においてDBNが他の手法より有意に優れていることが確認できる．また，詳細をみると，たとえばa2400p2400の学習データセットについては182次元の特徴ベクトルを，a600p600/a1200p1200の学習データセットについては223次元の特徴ベクトルを用いたほうが有意差が顕著であることがわかり，特徴ベクトルの構成方法について，DBNと他の手法との性能差の観点からどれが一番よいかは一概に断言することができない\footnote{この結果については4.2.2節でも述べたように，ノイズデータについては適正の数があるはずであることと，次元数が増えると個々のベクトルの本来のノイズの度合いが増強する（よってノイズデータの適正数が減る）ことを合わせて考えれば両者の結果は矛盾しないと思われる．}．

\begin{table}[t]
\hangcaption{各学習データセットに対して交差検証誤差が最小のパラメータセットを用いた場合のラベルごとの全学習データセットにおける平均予測精度}
\label{tab:label-prec}
\input{01table11.txt}
\end{table}

最後に，参考として，各手法のラベル（検索語）ごとの予測精度（表~\ref{tab:label-prec}）と，交差検証誤差が最小のパラメータセット（表~\ref{tab:parameter}）を示しておく．表~\ref{tab:label-prec}から，182次元の「PCケース」を除き各ラベルへの予測精度にばらつきが小さいことがわかる．
また，全般的にDBNのほうがほかの手法より各ラベルに対する予測精度がよいことがわかる．さらに，たとえばDBNの予測精度は182次元の場合のほうが10個中の6個のラベルについて223次元の場合に勝っており，182次元と223次元のどちらのほうがよいかが一概に言えないことがわかる．
表~\ref{tab:parameter}には，隠れ層のユニット数が182次元で273，223次元で335が多く出現しており，隠れ層のユニット数は多いほうがよいというBengioの提言と合致している．

\begin{table}[t]
\caption{DBNの各学習データセットに対して交差検証誤差が最小のパラメータセット}
\label{tab:parameter}
\input{01table12.txt}
\end{table}


