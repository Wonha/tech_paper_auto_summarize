誤り訂正実験
\label{sec-experiments}

\subsection{実験設定}
\label{sec-experimental-settings}

\paragraph{訂正対象助詞：}

本稿で誤り訂正の対象とする助詞は，ipadic-2.7.0の最上位品詞が助詞である
ものすべてである．これには，格助詞，係助詞のほか，副助詞，接続助詞，終
助詞，並立助詞なども含まれ，のべ236種類あるが，後述する学習者作文コー
パスに出現しない，もしくは誤りがない助詞は訂正対象にならないため，実際
の訂正対象助詞は38種類である
\footnote{\shortciteA{suzuki-toutanova:2006:COLACL}が対象とした格助詞
10種+係助詞「は」と比べると，本稿では「ヘ」が対象外，「より」は単独で
は出現せず，連語「により」が訂正対象となっている．また，上記論文では，
「に／は」のように，格助詞と「は」の連続も1語扱いで訂正対象としているが，
本稿では連続した置換，挿入，削除操作を用いて訂正している．}．


\paragraph{学習者作文コーパス（実誤りコーパス）：}

実験に使用したコーパスは，\ref{sec-particle-errors}章で述べた2,770文
（104 課題）である．ここから助詞誤りのみを残し，それ以外の部分は日本語修
正文の単語を埋め込んだ文を作成，コーパスとした．つまり，実験に使用した
ペア文は，助詞誤りのみを含んだものである．ただし，助詞の表記が学習者作
文，日本語修正文で一致している場合は誤りとはみなさず，日本語修正文の品
詞を学習者作文にコピーして利用した．誤り総数は，助詞13,534個中1,087箇
所 (8.0\%) である．また，誤り助詞と訂正助詞を対にした異なり数は，132種
類（置換修正95種類，挿入14種類，削除23種類）である．なお，実験に使用し
たすべての文は，MeCab\footnote{http://mecab.sourceforge.net/}（辞書はipadic-2.7.0を使用）
によって形態素解析し，その表記と品詞を単語情報とした．

\paragraph{言語モデル：}

言語モデルは，Wikipediaのコンピュータ関連記事と，CentOS 5の日本語マニュ
アルから，のべ527,151文を取得し，SRILM \shortcite{Stolcke:SRILM2011}で
トライグラムを学習して使用した．バックオフ推定には，Modified
Kneser-Neyディスカウントと補間推定を併用し，
未知ユニグラムを疑似単語 \texttt{<unk>}として残す設定で学習した．

\paragraph{疑似誤りコーパス：}

疑似誤り文は，言語モデル作成用コーパスから，ランダムに10,000文を取得し
て生成した．誤り発生確率は，実誤りコーパス上での相対頻度を倍率1.0とし
て，倍率0.0（つまり誤りなし）〜2.0まで変化させて実験を行った．

\paragraph{評価法：}
評価は，
コーパスを課題単位に分割し，5分割交差検定で行った．評価基準は2
種類使用した．

\begin{enumerate}
\item 正解の単語列とシステム出力の単語列の表記を比較し，誤り訂正
の再現率，適合率，F値を算出した．

\item 本タスクは，訂正すべき助詞数に比べ，訂正不要な助詞が圧倒的に多く，
システムによって訂正不要な助詞を過剰に訂正してしまう懸念がある．そのた
め，訂正によって文の品質が向上した助詞数（訂正が必要な助詞をシステムが
正しく訂正した数）と悪化した助詞数（訂正不要な助詞を過剰に訂正した数）
の差を相対向上数として評価基準とした．この基準では，まったく修正を行わ
なかった場合に$\pm 0$となる．
\end{enumerate}



\subsection{実験結果1: 日本語平文コーパスの利用}

まず，日本語平文コーパスを言語モデル確率として利用することの効果を測る
ため，以下の3手法について精度測定を行った．

\begin{itemize}
\item \textbf{提案手法：}
リンク素性にn-gram二値素性，言語モデル確率を併用した場合．
\item \textbf{n-gram二値素性のみ：}
リンク素性にn-gram二値素性のみを用い，言語モデル確率を使用しない場合．
\item \textbf{言語モデル確率のみ：}
リンク素性に言語モデル確率のみを用い，n-gram二値素性を使用しない場合．
\end{itemize}

実験結果を表\ref{tbl-exp-results}に示す．表中の
\mbox{\dag}は提案手法とn-gram二値素性のみの間で有意差があったもの，
\mbox{\S}は提案手法と言語モデル確率のみの間で有意差があったものを
表す ({$p < 0.05$}) 
\footnote{適合率・再現率には比率の$\chi^2$検定を使用し，
相対向上数には文単位の$t$検定を使用した．}．

\begin{table}[b]
\caption{リンク素性を変えたときの誤り訂正結果}
\label{tbl-exp-results}
\input{02table04.txt}
\end{table}

まず適合率について，使用したリンク素性を比較すると，提案手法とn-gram二
値素性のみが同じ精度で，言語モデル確率のみの適合率が低めとなった．再現
率は，提案方式が他の2つの方法に比べて大幅に向上 (9.9\%，11.2\%→18.9\%) 
し，その結果，F値も高い値を示した．n-gram二値素性のみと言語モデル確率
のみを比較すると，言語モデル確率のみの方が若干再現率が高い．その結果，
F値は提案手法（両者併用），言語モデル確率のみ，n-gram二値素性のみの順
で精度が高くなった．

しかし，相対向上数をみると，言語モデル確率のみは若干悪化しており（つま
り過剰訂正が多い），再現率の向上が，誤り訂正の精度に直結していないこと
がわかる．これは，約92\%の助詞を無訂正にすべきという本タスクの特徴に由
来するもので，安易な再現率向上は過剰訂正を引き起こすことを示している．

提案手法は，相対向上数でも他の2方式に勝っている．ただし，提案手法と
n-gram二値素性のみの間では有意差はなかった．これは，n-gram二値素性は確
実な誤りに集中して訂正する効果があるためで，相対向上数からみると有利に
働いたためと考えられる．提案方式は，n-gram二値素性，言語モデル確率の併
用によって，適合率を保持したまま再現率を向上させており，誤り訂正精度の
向上に有効である．



\subsection{実験結果2: 疑似誤り文によるペア文の拡張}

次に，疑似誤り文の導入効果を測定する．リンク素性を提案方法に限定し，疑
似誤り文の使用方法のみを変えて実験を行う．

図\ref{fig-graph1}は，訓練に用いるコーパスと訓練法を以下の4通りに変え
て，再現率／適合率カーブを測定した結果である．なお，図\ref{fig-graph1}
は，誤り訂正器が出力するスコアが高い方から，ある再現率を達成するための
訂正助詞を取得，適合率を算出したものである．

\begin{figure}[b]
\begin{center}
\includegraphics{19-5ia2f4.eps}
\end{center}
\caption{再現率／適合率カーブ（誤り発生確率は倍率1.0のとき）}
\label{fig-graph1}
\end{figure}

\begin{itemize}
\item \textbf{TRG:} 実誤りコーパスだけを用いて誤り訂正モデルを作成した場合
（ベースライン）．
\item \textbf{SRC:} 疑似誤りコーパスだけを用いて誤り訂正モデルを作成した場合．
\item \textbf{ALL:} 実誤りコーパスに疑似誤りコーパスを単純追加してモデ
ルを作成した場合．
\item \textbf{AUG:} 提案方法．疑似誤りコーパスをソースドメイン，実誤り
コーパスをターゲットドメインとして素性空間拡張法によるドメイン適
応を行った場合．
\end{itemize}

TRGをベースラインと考えると，疑似誤り文のみ(SRC)ではTRGの精度に達して
いない．そのため，疑似誤り文を追加したALLでも適合率は再現率が高いとこ
ろでようやくTRGと同等の適合率である．提案法であるAUGは，再現率が高くな
るに従い，TRGより高い適合率で誤りが訂正できている．再現率18\%では，TRG 
の適合率が50.5\%に対して，AUGの適合率は55.4\% 
となった（ただし，$p = 0.16$で有意差はない）．
なお，再現率18\%でのSRCの適合率は35.6\%で，ランダムに訂正するのに比べ
ると適合率は高い．

図\ref{fig-graph2}は，誤り発生確率毎の各方式の相対向上数をプロットした
ものである．この実験では，誤り発生確率が低い方が全体的に精度がよく，誤
り発生なし（倍率0.0）から0.6まではALL方式もTRGを上回っている．しかし，
SRC は倍率を高くするに従って相対向上数が低下しており，誤り発生確率を適
切に制御しないと，疑似誤り文が効果的に作用しない．一方AUGは，誤り発生
確率を変えても，安定した精度向上を果たした．誤り発生倍率が1.0のときの
相対向上数は，TRGが+28に対してAUGは+59と，有意に向上しており，疑似誤り
文を使用するときは，ドメイン適応を併用することが望ましい．

\begin{figure}[t]
\begin{center}
\includegraphics{19-5ia2f5.eps}
\end{center}
\caption{誤り発生確率（倍率）毎の相対向上数}
\label{fig-graph2}
\end{figure}



\subsection{誤り訂正例}

実験2において，誤り発生倍率1.0のとき，提案方式 (AUG) の適合率は
54.8\% (210/383)，再現率は19.3\% (210/1087)であった．約55\%の適合率は，
45\%程度の修正箇所を再修正しないと正しい文にならないという意味で，実用
上は決して高いとは言えない．助詞の用法には，意味的・文法的に明らかな誤
用と，許容可能なものがあるため，人手評価を行った．

何らかの修正操作を出力したが，正解と異なった部分173箇所に関して，1名
の評価者によって主観評価した．なお，そのうち151箇所は，正解では無修正
だった部分を過剰に修正したものである．評価観点は，システム修正を許容可
能か（正解と比較して，意味的・文法的に異なっていないか）である．結果，
173箇所のうち103箇所は許容可能であった．つまり，許容可能という観点での
適合率は，$(210+103)/383=81.7\%$ となった．

表\ref{tbl-correct-examples}は，システムによる誤り訂正例である．置換，
挿入，削除操作により誤り訂正が成功したもののほか，人手評価によって許容
可能と判断されたものには，係助詞「は」と格助詞「が」の置換 (No.~4) や，
複合名詞が正しい格助詞を補完して分割されたもの (No.~5) があった．許容不
可として残ったものの中には，No.~7のように慣用句を過剰訂正したもの，受動
態をとらえられず，能動態の格助詞に置換したもの (No.~8)，Linuxのfreeコ
マンドの内容を知らないと訂正ができないもの (No.~10) があった．No.~9は
「は」と「が」の置換であるが，「私たち」と「あなた」が呼応する表現であ
るため，許容不可と判断された．本稿で用いた素性は訂正対象助詞の局所文脈
のみであるため，大域的素性を導入しないと正しい訂正は困難なものもある．

\begin{table}[t]
\caption{システムによる誤り訂正例（訂正部分周辺のみ）}
\label{tbl-correct-examples}
\input{02table05.txt}
\end{table}



