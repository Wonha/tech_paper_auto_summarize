    \documentclass[japanese]{jnlp_1.4}
\usepackage{jnlpbbl_1.2}
\usepackage[dvips]{graphicx}
\usepackage{amsmath}
\usepackage{hangcaption_jnlp}
\usepackage{udline}
\setulminsep{1.2ex}{0.2ex}
\let\underline


\usepackage{dcolumn}

\newcommand{\argmax}{}

\renewenvironment{itemize}{}{}

\newcolumntype{d}[1]{D{.}{.}{#1}}



\Volume{17}
\Number{1}
\Month{January}
\Year{2010}

\received{2009}{2}{5}
\revised{2009}{5}{12}
\rerevised{2009}{7}{7}
\accepted{2009}{8}{2}

\setcounter{page}{29}

\jtitle{候補間の表層的差異に着目した地名の所属国推定}
\jauthor{佐野　智久\affiref{keiograd} \and 延澤　志保\affiref{tcu} \and 岡本　紘幸\affiref{keiograd} \and 鈴木　宏哉\affiref{keiograd} \and \\
	松原　正樹\affiref{keiograd} \and 斎藤　博昭\affiref{keiograd}}
\jabstract{
地名等の固有名詞は自然言語処理における未知語処理問題の要因の一つであり，これを自動的に認識する手法が盛んに研究されている．
本稿では，地名の所属国を自動的に推定することで，未知語としてノイズの原因となる可能性のある地名語句に情報を与えることを目的とする．
固有名詞である地名の認識では地名辞書が用いられることが多いが，辞書ベースの手法では，辞書未登録語の問題が避けられない．
不特定多数の外国の地名も含めた所属国の推定の実現のため，本稿では，地名辞書や文脈情報を全く使用せず，地名の表層情報のみを利用して，地名の所属国を自動的に判別する手法を提案する．
地名については，言語的な類似性や地理的要因によって所属国の判別が困難な場合がある．
本稿ではこの点に着目し，所属可能性の低い国の除去による候補の絞込み処理と，所属可能性の高い候補の選択処理との組合せによって，再現率を高く保ったまま適合率の向上を実現した．
}
\jkeywords{エリア推定，所属国推定，言語識別，固有名詞認識，多言語処理\\ 　　　　　}

\etitle{Toponym Resolution Based on \\ Surface Difference among Candidates}
\eauthor{Tomohisa Sano\affiref{keiograd} \and Shiho Hoshi Nobesawa\affiref{tcu} \and Hiroyuki Okamoto\affiref{keiograd} \and Hiroya Susuki\affiref{keiograd} \and Masaki Matsubara\affiref{keiograd} \and Hiroaki Saito\affiref{keiograd}}
\eabstract{
There have been many researches on toponym resolution as an approach to solve the unknown word problem.
In this paper we propose an area candidate estimation method for toponyms, to assign area information to unknown toponyms.
Our aim is to expand the target toponyms to non-restricted domains.
Thus we aim for a simple system avoiding the use of gazeteers and context information.
Our method is based only on surface information to estimate area candidates to where the toponyms may belong.
Toponym resolution can be difficult because of linguistic or geographic reasons.
Focusing on the surface difference among probable countries, we constructed a system containing a reduction phase for a rough examination and a selection phase for a detailed examination among them.
By our effective combination of these two phases, we succeeded in gaining high precision rate maintaing high recall rate.
}
\ekeywords{Toponym Resolution, Language Identification, Proper Noun Recognition, Multilingual Processing}

\headauthor{佐野，延澤，岡本，鈴木，松原，斎藤}
\headtitle{候補間の表層的差異に着目した地名の所属国推定}

\affilabel{keiograd}{慶應義塾大学大学院理工学研究科開放環境科学専攻}{School of Science for Open and Environmental Systems, Graduate School of Science and Technology, Keio University}
\affilabel{tcu}{東京都市大学知識工学部情報科学科}{Department of Computer Science, Faculty of Knowledge Engineering, Tokyo City University}


\begin{document}
\maketitle

\section{地名の持つ表層情報を活用した所属国推定}
\label{sec:area-identification-with-surface-features}

これまでの地名に対するエリア推定における場所との対応付け処理は，(i) 地名辞書，(ii) 文脈情報，(iii) 地理的社会的情報，の三つの要素を組み合わせることによって問題解決を試みるアプローチが主流であった．
このアプローチの問題点は，場所の特定を行うために必要な言語リソースをあらかじめ大量に準備しなければならないことにある．
事前に用意した辞書から得ることができる情報を参照しながら，文書中で地名が出現する前後の文脈を考慮して地名と場所の対応付けが行われるが，複数の場所が候補としてあがる場合が多く，そのときには曖昧性の解消を行うことになる．
機械翻訳等と同様に，このような地名の曖昧性の解消のために必要な詳細な情報を事前に用意しておく必要がある．
また，地理的情報や社会的情報は付加的なものであり，この曖昧性解消に有効な情報を十分に収集することが困難な場合もある．
このようなアプローチにおいては，文脈情報や付加的な情報を使うことが難しい場合には，地名辞書の中にその地名が載っているかどうかが，地名と場所の対応付けの精度を大きく決定づけることになる．
これら三つの要素をなるべく使わずに地名と場所の対応づけを行うことができれば，少ない事前準備で，比較的簡単にエリア推定を実現することが可能となる．

前述のような地名辞書や文脈情報，地理的社会的情報等を使わずに，地名の表層情報のみを用いて所属国を推定するために，Sano らは $n$-gram 情報等の地名の表層に現れる特徴に着目した分類器を用いた推定手法を提案している~\cite{tomohisa07snlp}．
Sano らは，SVM を二値分類器として使用し，ある地名が対象国の地名であるかどうかを判定することで，所属国候補を選び出している．
Sano らの手法は文字単位の統計情報のみを素性とするシンプルな手法であるにもかかわらず，実験の結果として最高で 0.93，最低で 0.69 の F 値を得ていることから，表層的な情報は地名の所属国推定に有用な特徴を有しているものと考えられる．
しかし，地名文字列が所属国を特定するのに十分な情報を有していない場合には，ほとんどの国が候補として残ってしまう場合があった．
これは，正しい所属国が候補から削除されてしまうことを避けるために適合率よりも再現率をより重視していることに起因している．
その結果として，国によっては適合率が 55.09\% と低くなる場合があり，どんな国に対しても高い精度の推定が可能な手法の提案が課題となっていた．
この問題を解決するためには，所属国推定の結果として候補の数が多くならないように，可能性の低い候補を見つけ出して除去する処理が必要となる．
候補に正解を残したまま，候補の数を削減することが可能となれば，適合率を向上させることができる．
そこで，本稿では，Sano らの手法と同様に地名が持つ表層的な情報のみを利用して，所属する可能性の高い候補の推定処理に加え，所属する可能性の低い候補の除去による絞込み処理を行うことで，再現率と適合率の双方の向上を実現する手法を提案する．


\section{所属国推定のための表層情報}
\label{sec:surface-features}

本節では本稿で対象とする国の地名が持つ表層情報の特徴について述べる．
ここでは，対象となる国の地名が含まれるコーパスから得られる情報を明らかにし，そこから読みとることのできる特徴を示し，表層情報を用いた所属国の推定を実現するために必要な手がかりを挙げていく．

地名は一般的に，数単語から成るたかだか十数文字程度の文字列であるため，そこから得られる情報は決して多いとはいえない．
しかし，人間には地名の所属国の推測が可能であることから，地名文字列から得られる表層的な特徴は所属国の推定を可能にする情報を有していると考えることができる．
地名は，人名や組織名と比較して，その所属国に対する帰属性が高い．
これは，地名そのものがその土地や言語，文化に密接に関連するものであるためである．
つまり，ある特定の国に属する地名はある特定の特徴を共有し，それが文字列としての表層にも現れていると考えることができる．
また，地名は文字列であるだけでなく，単語列であると捉えることも可能である．
単語レベルの情報は，文字レベルの情報と比較して，より確度の高い情報をもたらすが，個々の単語の出現頻度が低いという点を考慮する必要がある．
Sano らは，ブロックとよばれる単位の頻度情報を用いてこの点に対処し，単語レベルで起こりやすいデータのスパースネスの問題を解決することで，所属国の推定の精度を向上させることができたと報告している\cite{tomohisa09ieice}．
ブロックとは，一種の語頭や語尾であり，言語的特徴が地名の先頭や末尾に現れやすいという特徴を利用したものである．

本稿では，地名の集合が持つ表層的な特徴を国ごとに抽出し，これを用いて所属国の推定を行う．
表層的な情報のみを用いて所属国を推定する場合に必要な言語リソースは地名コーパスのみである．
地名コーパスとは，国ごとに作成した地名リストを指し，その国に属する地名の集合である．
本稿では，外国語文書中に埋め込まれた地名の所属国推定も想定しているため，字種情報が所属国の推定に影響しないよう，国に依らずラテン文字による記述とする．
文字レベルの特徴は，約 30 種類の文字\footnote{本稿では，表記の揺れを排除するために，ラテン文字の大文字小文字の区別は行わない．その他，空白も文字として扱う．ただし，ウムラウト等のアクセント記号やハイフン等の記号は除去する．したがって，処理の上では計 27 種類の文字を用いる．例えば，``Land Baden-W\"{u}rttemberg'' という地名は ``LAND BADEN WURTTEMBERG'' として扱い，3 単語 22 文字から成るものとする（空白も一文字と数える）．}の並び方によって決定され，統計的な言語モデルを適用することで，特徴を定量的に扱うことができる．
さらに，地名に含まれる文字数も一つの特徴といえる．

本稿の手法は，地名コーパスを単に辞書引きの対象とするのではなく，地名コーパスから国ごとの特徴を抽出して処理を行うことで，地名コーパスに含まれていない地名に対しても所属国の推定を行うことを可能にするものである．
これは，未知語処理の頑健性，柔軟性の向上に貢献するものと考える．
また本稿ではラテン文字を処理対象として実験を行うが，本稿のアプローチは表層的な情報のみを用いているため字種に依存せず適用可能であり，その点で高い汎用性を持っているといえる．
さらに，本稿のアプローチは地名コーパス以外の情報を一切必要としないことから，リソース準備にかかる人的労力や作業期間を大幅に軽減するものである．


\subsection{地名コーパス}
\label{sec:area-name-corpora}

\begin{table}[b]
  \caption{地名コーパスに含まれる地名数，単語数，文字数}
  \label{tab:area-name-corpora}
\input{03table01.txt}
\vspace{-1\baselineskip}
\end{table}

本稿では，ウェブ上で多く使用される言語とそれと類似性の高い言語の地名を中心に 10 ヶ国\footnote{本稿では，比較を行うために台湾もひとつの国として扱い，実験を行った．}（中国，台湾，日本，タイ，ギリシャ，フィンランド，ドイツ，フランス，スペイン，アメリカ）を選択し，所属国推定の対象としている（表~\ref{tab:area-name-corpora}）\kern-0.5zw\footnote{本稿の実験では，アメリカ国家地球空間情報局 (National Geospatial-Intelligence Agency: http://www.nga.mil) が提供する地理空間情報のデータベース GNS (GEOnet Names Server) のデータを使用している．ただし，GNS にはアメリカの地名が含まれていないため，アメリカの地名は，アメリカ地名委員会 (United States Board on Geographic Names: http://geonames.usgs.gov/) が提供する GNIS (Geographic Names Information System) のデータを使用している．GNS は全体としては 550 万件程度の地名データ，GNIS は 200 万件程度の地名データを有している．}．
本稿の実験では 10 の国それぞれに対して，10,000 件ずつの地名データを無作為に抽出したものを地名コーパスとして用いている．
コーパス全体に含まれる計 100,000 個の地名は，それぞれの国のなかではすべて異なるが，国の間での地名には重複するものがあり（表~\ref{tab:duplicated-toponyms}），全体での異なり数は 99,794 である．
地名の重複は，言語的に近いと考えられる，中国と台湾，フランスとスペインの間で他の組合せよりも大きな数値であるが，全体としては 0.2\% 程度である．
アメリカ以外のコーパスにも英語の単語が若干含まれており，例えば ``富士山'' はコーパス中では ``Fuji Mountain'' と記載されている．
このような英語語句の利用は徹底されたものではなく，例えば ``浅間山'' は ``Asama yama'' と記載される等，現地の語句のラテン文字表記と英語を用いた表記とが混在している．


\begin{table}[b]
\vspace{-0.5\baselineskip}
  \caption{国の間における地名の重なり数}
  \label{tab:duplicated-toponyms}
\input{03table02.txt}
\end{table}


\subsection{地名の長さ情報}
\label{sec:name-length-data}

\begin{figure}[b]
 \begin{center}
  \includegraphics{17-1ia3f1.eps}
 \end{center}
  \caption{地名コーパスに含まれる地名の文字数と単語数}
  \label{fig:toponym-word-char-length}
\end{figure}

地名を構成する単語数や文字数は国によって違いがある．
さらに，各単語に含まれる文字数の分布にも違いがある．
図~\ref{fig:toponym-word-char-length} は各地名コーパスに含まれる地名の文字数と単語数の国ごとの差異を表すものである．
一つの地名に含まれる平均単語数は，最も少ない国で 1.1 単語（フィンランド），最も多い国で 2.9 単語（タイ）であり，すべての国での平均単語数は 1.9 単語である．
また，一つの地名に含まれる平均文字数は，最も少ない国で 9.7 文字（フィンランド），最も多い国で 16.5 単語（アメリカ）であり，すべての国での平均文字数は 11.9 文字である．
このように，各国の地名は，地名を構成する単語数，文字数に差異が認められるが，その差異はこれだけで所属国の推定を行うには十分とはいえない．

図~\ref{fig:toponym-word-length-distribution} に国ごとの地名を構成する文字数の分布を示す．
図~\ref{fig:toponym-word-length-distribution} に示されるように，例えば，タイの地名のうち約 68\% の単語は 3 文字もしくは 4 文字で構成されている．
また，フランスやスペインの地名は，2 文字で構成される単語の割合が他の国と比べて高い．
それに対して，フィンランドやドイツの地名のように，9 文字や 10 文字で構成される単語が最も高い割合を示し，これらの国の地名は文字数の多い単語で構成されていることがわかる．

このように，地名を構成する文字数にも，国ごとに特徴がある．
しかし，文字数は同じ国のなかであっても地名間のばらつきがあり，この情報のみで所属国の推定を行うことは困難である．

\begin{figure}[t]
 \begin{center}
  \includegraphics{17-1ia3f2.eps}
 \end{center}
  \caption{地名単語中の文字数の分布}
  \label{fig:toponym-word-length-distribution}
\end{figure}

\subsection{文字出現頻度の情報}
\label{sec:ngram-data}

地名の所属国の推定は，言語識別の一種である．
言語識別処理では，文字の出現頻度の情報が有効であることが知られている~\cite{dunning94,Lins04}．
ここでは，文字の出現頻度情報の地名の所属国の推定での有効性を検証するため，国ごとの $n$-gram 情報の比較を行う．
表~\ref{tab:ngram-data} は地名コーパス中に含まれる地名の文字単位の $n$-gram を取得した結果である．
表中の `\texttt{\_}' は空白文字を表し，ここでは一つの文字として扱っている．
表~\ref{tab:ngram-data} では，unigram，bigram，trigram の上位 5 つを示すとともに，各国について，10\% 以上の頻度を持つ unigram の個数，3\% 以上の頻度を持つ bigram の個数，1\% 以上の頻度を持つ trigram の個数を示している．

\begin{table}[b]
 \caption{地名コーパスの $n$-gram 情報}
 \label{tab:ngram-data}
\input{03table03.txt}
\end{table}

表~\ref{tab:ngram-data} から，中国と台湾の地名から得られる unigram の類似性が非常に高いことがわかる．
この二つの国は unigram と同様に bigram の出現傾向も類似している．
特に，`\texttt{AN}' と `\texttt{NG}' は両国で 5\% 以上の出現頻度を示しており，両国の他の bigram の出現頻度と比べても高い値である．
これは `\texttt{ANG\_}' という文字列が両国に多く出現するためで，trigram についても `\texttt{ANG}' や `\texttt{NG\_}' の値が両方の国で高くなっている．
しかし，両国の $n$-gram の出現状況には差異も見られる．
このことから，各国の特徴的な $n$-gram 情報を活用することで，同じ言語グループに属する地名であっても，それらの所属国を区別することは可能と考えられる．

スペインの bigram 情報の上位は `\texttt{A}' `\texttt{D}' `\texttt{E}' `\texttt{L}' `\texttt{\_}' の 5 種類の文字の組合せのみである（表~\ref{tab:ngram-data}）．
これは，スペインのコーパスに `Montes de Leon' や `Jerez de la Frontera' 等 `\texttt{DE}' や `\texttt{LA}'，`\texttt{DEL}' といった冠詞や前置詞が多く含まれるためである．
この傾向は，フランスの地名にも同様に現れている．
このような冠詞や前置詞は一般に文字数が少なく，2 文字や 3 文字の場合が多い．
この特徴は，図~\ref{fig:toponym-word-length-distribution} のフランスとスペインの地名を構成する単語数の分布にも現れている．

また，表~\ref{tab:ngram-data} から，unigram の比較では日本とギリシャの出現傾向が近いことがわかる．
しかし，bigram で比較すると両国の類似性は高いとはいえない．
これにより，unigram のみによる所属国の推定は難しいことが推測できる．
中国と台湾のように bigram を用いても区別が困難な場合もある．
したがって，特定の統計情報を利用するだけでは所属国の推定には限界があり，これらを適切に組み合わせることが重要であると考えられる．

地名コーパスは一般に言語資源としては小さく，trigram より大きな $n$ での $n$-gram はデータスパースネスの問題が顕著化する．
例えば，ギリシャの場合上位 5 種類の trigram を合計しても全体の出現頻度の 4.57\% しかカバーしておらず，最も高い出現頻度を持つ `\texttt{OS\_}' でもカバー率は 1.23\% である．
上位 5 種類の trigram がカバーする割合が最も高い中国や台湾のコーパスの場合でも，上位 5 種類の trigram の合計でそれぞれ 10.27\%，10.49\% をカバーしているにすぎない．
なお，中国や台湾は特定の $n$-gram が特に高い頻度で出現する傾向が見られ，1\% 以上の割合を占める trigram は中国コーパスには 12 個，台湾コーパスには 11 個含まれている．

$n$-gram モデルの性能を評価する一つの指標として，各国の $n$-gram モデルのそれぞれの地名コーパスに対してのパープレキシティを表~\ref{tab:perplexity} に示す．
各国の $n$-gram モデルは，対応する国のコーパスに対して高い性能を示しており，この $n$-gram モデルが所属国を推定するための情報を有していることが分かる．
このパープレキシティの値は，対応する国に対してだけでなく，中国と台湾やフランスとスペイン等の間でも比較的小さな値となった．
これは，これらの国を区別することが困難であることを示し，$n$-gram のみで所属国を判断することは，所属国の推定の精度向上に限界があることが分かる．

\begin{table}[t]
  \caption{各国の $n$-gram モデルによる各国の地名に対するパープレキシティ}
  \label{tab:perplexity}
\input{03table04.txt}
\end{table}


\section{候補絞込みと候補選択の二段階処理から成る地名の所属国の推定手法}
\label{sec:two-phase-area-identification-method}

地名の所属国の推定では，(i) 同一の地名が複数の国に存在する場合，(ii) 地名文字列に類似した特徴を持つ国が複数ある場合に，地名の所属国候補を一意に絞ることができないことがある．
前者は地名の曖昧性，後者は国の類似性と考えることができる．
どちらの場合でも，該当する複数の国で高い所属確率を持つ地名が存在し，これらの地名に対しては該当する複数の国を候補として出力するのが妥当であり，複数の国を候補として出力することはシステムの精度を落とすものではない．
それに対して，明らかに所属国である可能性が低い国は，出力に含まれるべきではない．
単に複数の候補を出力するだけでは，再現率は得られても適合率は下がり，結果的にシステムの信頼性は落ちる．

本稿では，再現率と適合率の双方の向上を実現するため，二段階の処理で所属国の推定を行う手法を提案する．
本手法の処理の流れを 図~\ref{fig:system-overview} に示す．
本手法は，所属国の候補の絞込みの第一フェーズと，所属国の候補の選択の第二フェーズの，二段階で構成されている．
本システムの入力は地名文字列である．
まず，各地名文字列について，所属国の候補の絞込みフェーズで全 10 ヶ国から 3 ヶ国まで候補を絞り込む．
この段階で，明らかに所属する可能性の低い国が候補から外される．
このフェーズでは，文字単位の $n$-gram 情報をベースとした生成確率を用いて処理を行う．
次に，所属国の候補の選択フェーズでこの 3 ヶ国それぞれに対して所属の可能性を推定し，可能性があると推定されたものを所属国の推定結果として出力する．
このフェーズでは，$n$-gram の他，長さ情報等も用いる．
本システムの出力は，入力地名文字列が所属する可能性のある国であり，推定結果に応じて 0 〜 3 個の国名を出力する．

\begin{figure}[t]
 \begin{center}
  \includegraphics{17-1ia3f3.eps}
 \end{center}
  \caption{提案手法の処理の流れ}
  \label{fig:system-overview}
\end{figure}

\subsection{地名の生成確率を用いた所属国の候補絞込みフェーズ}
\label{sec:automatic-area-identification-with-ngrams}

人間による直感的な地名の所属国の推定が地名を構成する文字の並びを基にしているとすれば，\ref{sec:surface-features}~節で示したような地名に関する統計的な特徴を用いて所属国の推定をすることが可能である．
本節では，地名の表層情報として $n$-gram のみを用いて所属国の候補の絞込みを行うフェーズについて述べる．

ここでは，地名を構成する文字の並びが与えられたときに，その文字列が生成される確率が最も高くなるような統計情報を持つ国を選択することで所属国の候補の絞込みを行う．
$n$ 個の文字で構成される地名 $ T_{1}^{n} = c_{1} \cdots c_{n} $ の国 $A$ における生成確率 $ P_A(T_{1}^{n}) $ を $n$-gram 情報を用いて定義する（式~\ref{eqn:trigram}）．
\begin{equation}
 P_{A}(T_{1}^{n}) = P_{A}(c_{1}) P_{A}(c_{2}|c_{1}) P_{A}(c_{3}|c_{1}c_{2}) \cdots P_{A}(c_{n}|c_{n-2}c_{n-1}) \label{eqn:trigram}
\end{equation}
ここで， $P_{A}(c_{n}|c_{n-2}c_{n-1})$ は国 $A$ において $c_{n-2} c_{n-1}$ の後に $c_{n}$ が出現する確率を表している．
文字単位の $n$-gram 情報は，Modified Kneser-Ney ディスカウンティングを用いて，低次の $n$-gram 情報を補間しながら平滑化を行っている．
このとき，ある地名 $T$ に対して，その生成確率 $P_{A}(T)$ が最大となるような国をその地名が属する国と推測し，それを $\hat{A} = \argmax_{A} P_{A}(T)$ とする．

この定義により $n$-gram 情報のみを用いて $\hat{A}$ を推定した結果を表~\ref{tab:accuracy-trigram} に示す．
所属国の絞込みフェーズの出力の上位 1 位の正解率\footnote{ここでの正解率は，生成確率が最大となった国 $\hat{A}$ と正解が一致した割合を表す．} は平均で 85.96\% であった．
表~\ref{tab:accuracy-trigram} に示されるように，単純な $n$-gram での推定でも，約 86\% と高い正解率を得ることは可能である．
この手法で正解率が最も高い国はタイで 95.37\%，正解率が最も低い国は中国で 72.70\% であった．
中国と台湾の正解率が低いのは，\ref{sec:ngram-data}~節で述べた両国の $n$-gram の類似性によるものと考えられる．

\begin{table}[b]
 \caption{生成確率による所属国の推定の正解率}
 \label{tab:accuracy-trigram}
\input{03table05.txt}
\end{table}

地名の所属国の推定は，もともと同一の地名が複数の国に存在する可能性がある等，所属国名を唯一出力する形式は馴染まない．
唯一の正解を判定するのではなく，所属国の候補を絞り込むことを目的とした場合，上位 $n$ 個を候補として残すことで正解を所属国の候補から不適切に除去されるのを防ぎ，再現率を高めることができる．
図~\ref{fig:ngram-coverage} は，上位三個までを候補として残した場合の正解のカバー率（正解が出力された所属国の候補に含まれた割合）を表している．
図~\ref{fig:ngram-coverage} の Top 1 は上位一個のみ出力した場合のカバー率，Top 2 は上位二個まで出力した場合のカバー率，Top 3 は上位三個まで出力した場合のカバー率を示す．
全体の平均で，上位二個までを候補とした場合，95.22\% をカバーし，上位三個までを候補とした場合には，97.46\% をカバーしている．
上位三個までを選択した場合では，個々の国についても，最低でも 96.03\%，最高で 98.38\% の再現率を達成している．
これにより，このフェーズで所属国の候補を上位三位までに絞り込むことで，98\% 程度の再現率を得ることができることがわかる．

\begin{figure}[t]
 \begin{center}
  \includegraphics{17-1ia3f4.eps}
 \end{center}
  \caption{生成確率による所属国の推定を行った場合の正解のカバー率}
  \label{fig:ngram-coverage}
\end{figure}

出力される所属国の候補の数を増やすことは，適合率を下げるだけでなく，可能性の低い国も候補に残るリスクがあるため，各地名に対して適切な所属国の候補を必要十分な個数だけ出力する必要がある．
上位一つの国名のみを出力した場合でも，平均 86\% 程度の正解率を得ることができるが，各地名に対する出力候補数の妥当性の判断が困難なため，98\% 程度の再現率を得るために，本フェーズではすべての地名に対して三つの所属国の候補を出力する．
本手法では，このフェーズを二段階処理の第一フェーズとし，ここで 3 候補に絞り込んだ上で，第二フェーズである候補選択フェーズで所属国の候補それぞれに対して妥当性の検証を行う（\ref{sec:automatic-area-identification-with-svm}~節）．

ここで，本フェーズによる候補の絞込みの結果が妥当かつ有効であることを示す．
10 ヶ国の組合せは ${}_{10}C_3 = 120$ 通りであるが，図~\ref{fig:ngram-coverage} で示したとおり，正解が絞込み後の 3 候補（120 通り）に含まれる可能性はおよそ 98\% である．
たとえば，中国と台湾が 3 候補に同時に残る場合に着目すると，この組合わせは 8 種類あるが，そのすべての組合せが 120 個中上位 8 位までに出力しており，この二つの国が同時に候補に残る可能性が高い．
同じ東アジア地域である日本が 3 候補のなかに残る場合では，中国，台湾，日本の 3 ヶ国が候補として出力された割合は，正解が中国の場合で 10.67\%（3位），台湾の場合で 11.17\%（3位），日本の場合で 13.71\%（1位）であった．
それに対して，中国，台湾，タイの組合せでは，正解が中国の場合では 25.87\%（1位），台湾の場合で 30.68\%（1位），タイの場合で 12.76\%（1位）の割合であり，中国，台湾，日本の組合せの場合よりも高い．
これは，中国語圏の地名が中国，台湾，タイの 3 ヶ国に絞られる割合が高いことを示している．
また，西ヨーロッパの国であるドイツ，フランス，スペインにアメリカを加えた 4 ヶ国が互いに候補として残る確率が高くなっている．
この 4 ヶ国は同じ言語圏に属するものではないが，歴史的，文化的背景から，他の国と比べて類似した地名が多いものと推測できる．

\begin{figure}[b]
\vspace{-0.5\baselineskip}
 \begin{center}
  \includegraphics{17-1ia3f5.eps}
 \end{center}
  \caption{絞込み結果の分類}
  \label{fig:ngram-output-category}
\end{figure}

ここで，同時に候補に残りやすい中国，台湾，タイの 3 ヶ国をグループ A，ドイツ，フランス，スペイン，アメリカの 4 ヶ国をグループ B，どちらにも含まれていないギリシャ，フィンランド，日本の 3 ヶ国をグループ C として，3 候補に残る国の組合わせに何らかの傾向がないかどうかを調べたものが図~\ref{fig:ngram-output-category} である．
図~\ref{fig:ngram-output-category} では，絞込み候補の組合せを，グループ A の国が二個以上出力された場合（カテゴリ A），グループ B の国が二個以上出力された場合（カテゴリ B），グループ C の国が二個以上出力された場合（カテゴリ C），すべてのグループから 1 ヶ国ずつ出力された場合（カテゴリ D）の 4 つに分けて示している．
「 AAB 」は，グループ A に属する国が二つとグループ B に属する国が一つから成る所属国の候補が絞込み結果として出力された地名の割合を示し，グループ A に属する国が二つ以上であることから，グループ A に偏った出力としてカテゴリ A に入れている．
この実験では各国の地名コーパスに含まれる地名数は同じなので，絞込みが完全に成功した場合には，カテゴリ A には 30\%，カテゴリ B には 40\%，カテゴリ C には 30\% が配分されるはずである．
実際には，カテゴリ A に 26.77\%，カテゴリ B に 46.98\%，カテゴリ C に 18.74\% が配分された．
また，3 グループからそれぞれ 1 ヶ国ずつ候補に残るような場合（カテゴリ D）は全体の 7.51\% だけであり，それ以外は 90\% 以上の割合でどれかのグループに偏った候補が出力されていることになる．
このことから，比較的同時に候補に残りやすい組合せの存在がわかり，本フェーズが所属国の候補の絞込み処理として妥当かつ有効であることがいえる．


\subsection{地名の所属国選択分類器を用いた所属国の候補選択フェーズ}
\label{sec:automatic-area-identification-with-svm}

\ref{sec:automatic-area-identification-with-ngrams}~節の所属国の候補絞込みフェーズでは，文字の出現頻度情報のみを用いて，所属国の候補を 3 個まで絞り込んだ．
本フェーズでは，絞込み処理後の候補を対象に，文字の出現頻度情報と長さ情報を素性として定義し，各国に所属する地名を学習することで，分類器を用いた所属国の選択を行う．
分類器として用いる SVM は二値分類器であり，テストする対象となる地名がその国に属するか属さないかを判定する．
このフェーズは，分類された結果からその地名が属する国の候補を選び出していくアプローチである．

学習に用いる素性は，地名コーパスから得られる表層データ情報（\ref{sec:surface-features}~節）である．
表層データは，大別すると，地名を構成する文字の並びの長さの情報と，文字の並びが出現する確率をベースとした $n$-gram 情報の二種類がある．

地名を構成する文字の並びは，所属国によって特徴が存在する．
素性として用いる長さ情報は，以下の 4 種類である．
\begin{itemize}
 \item[(FL1)] 地名を構成する単語数 
 \item[(FL2)] 地名を構成する文字数 
 \item[(FL3)] $n$ 番目の単語に含まれる文字数 ($1 \le n \le 16$) 
 \item[(FL4)] 地名に含まれる $m$ 文字の単語の数 ($1 \le m \le 32$) 
\end{itemize}
\ref{sec:area-name-corpora} 節で述べたように，地名に含まれる文字数や単語数は国によってばらつきがあり，このばらつきが所属国を推定する手がかりとなり得る (FL1，FL2)．
単に文字数や単語数の情報だけでなく，国ごとに単語そのものの特徴や単語の分布具合の情報も利用することができる．
例えば，フランスの地名では ``la'' という単語が頻繁に出現するが，そのうち約半数が最初の単語として登場する．
このように，単語によっては，その単語が出現する地名内での位置に特徴がある (FL3)．
また，図~\ref{fig:toponym-word-length-distribution} に示したように，タイの地名は他の国の地名と比較して 3 文字および 4 文字で構成される単語の割合が圧倒的に高い等，地名に含まれる単語の文字数も国の特徴となり得る (FL4)．

また，素性として用いる $n$-gram の情報は，以下の 3 種類である．
\begin{itemize}
 \item[(FN1)] 文字単位の unigram 情報 
 \item[(FN2)] 文字単位の bigram 情報 
 \item[(FN3)] 文字単位の trigram 情報 
\end{itemize}
$n$-gram 情報は文字単位であり，空白等の記号も一つの文字としている．
各素性の値 $V$ は国 $A$ のコーパスの $n$-gram の出現確率をベースに計算し，次のように定義する（式~\ref{eqn:feature-value}）．
\begin{equation}
 V_{A}(t,c) = P_{A}(c) \times N(t,c) \label{eqn:feature-value}
\end{equation}
$c$ を長さ $n$ ($1 \le n \le 3$) の文字の並びとした場合，$P_{A}(c)$ は国 $A$ における文字列 $c$ が出現する確率，$N(t,c)$ は地名 $t$ の中で文字列 $c$ が出現した回数を示す．
素性の値は，$n$-gram 情報と対象とする地名に依存しており，ある文字列のその国での出現しやすさと，その地名の中での出現しやすさを示している．
ここでは，地名が所属する国を正例，それ以外の国を負例として，地名コーパスから各国の地名の特徴を学習した SVM を二値分類器として利用し，入力となる地名を対象国として分類するべきかどうかを判断する．

対象となる $p$ 個の国の中から異なる $q$ 個の国を選び出し（${}_{p}C_{q}$ 通り），選ばれた $q$ 個の国に対して所属国であるかどうかをそれぞれの分類器によって判定する．
本フェーズでは，選ばれた $q$ 個の組合せごとに学習対象が異なるため，一つの組合せごとに $q$ 種類の分類器を用意する．
本稿では，全体として 10 ヶ国を対象とし，絞込み処理によって 3 候補の組合せが選び出されるため，全体では 360 種類 (${}_{p}C_{q} \times q = {}_{10}C_{3} \times 3$) の分類器を用いている．

\begin{table}[b]
 \caption{候補選択分類器による所属国の選択結果（中国，台湾，タイ）}
 \label{tab:svm-output-chthtw}
\input{03table06.txt}
\end{table}

表~\ref{tab:svm-output-chthtw} に，グループ A の 3 ヶ国（中国，台湾，タイ）について，この 3 ヶ国を対象に本分類器を用いて所属国の推定を行った結果を示す．
ここでは，この 3 ヶ国の地名コーパスを 5 分割し，クロスバリデーションによる評価を行うことで，地名コーパスに存在しない地名を対象としたオープンテストとして所属国の推定の正解率\footnote{ここでの正解率は，$(pp+nn)/(pp+pn+np+nn)$ で計算する．$pp$ は正解を正しく分類できた回数，$pn$ は不正解を誤って分類した回数，$np$ は正解を誤って分類した回数，$nn$ は不正解を正しく分類した回数を表す．したがって，ここでの正解率は，ある地名に対して正解を正解と推定できたか，不正解を不正解と推定できたかの両方の結果を含んでいる．}を測った．
グループ A に属する 3 ヶ国のみを対象として学習した場合，表~\ref{tab:svm-output-chthtw} に示したとおり，F 値は最低で 0.73，最大で 0.95 となった．
正解が台湾の場合の適合率が 59.87\% と低いが，この場合でも再現率は 93.71\% であり，正解が候補として出力される確率は十分に高い．
表~\ref{tab:svm-output-frgmsp} はグループ B に属する 4 ヶ国を対象として，その中から 3 ヶ国ごとに対して分類器による所属国の選択を行った結果である．
このグループでも，F 値は最低 0.75，再現率は最低で 95.55\% で，正解が候補として出力される可能性は十分高い．
同様に，表~\ref{tab:svm-output-figrja} はグループ C に属する 3 ヶ国を対象として分類器による所属国の選択を行った結果である．
これらの結果から，同じグループに属する国の間での分類であっても，十分な正解率が得られることが示された．
同じグループに属する国は他の国に比べて類似性が高いものであり，これらの間での分類が最も難しい部分となる．
10 ヶ国全体を対象とした学習では，類似性の低いもの同士の間の差異の特徴が強調され，類似性の高いもの同士の間の差異の学習は進み辛いが，本フェーズでは絞込み後の 3 ヶ国間の分類の学習を行うことで，類似性の高い国の間での所属国の選択の精度の向上を実現した．

\begin{table}[b]
 \caption{候補選択分類器による所属国の選択結果（ドイツ，フランス，スペイン，アメリカ）}
 \label{tab:svm-output-frgmsp}
\input{03table07.txt}
\end{table}
\begin{table}[b]
 \caption{候補選択分類器による所属国の選択結果（ギリシャ，フィンランド，日本）}
 \label{tab:svm-output-figrja}
\input{03table08.txt}
\end{table}


ここで，対象国の数による影響を調べるために，10 ヶ国全てを対象として選択分類器を用いた場合の所属国推定の結果を示し，本フェーズの所属国の選択分類器の特徴を述べる．
表~\ref{tab:accuracy-svm} は，クロスバリデーションで 10 ヶ国すべてを対象として所属国の推定を行った結果である．
全ての国の地名に対して 90\% 以上の正解率を示し，全体でも 93.54\% の正解率を示した．
表~\ref{tab:fmeasure-svm} は，この実験の結果について，地名に対する所属国の候補の中に正解が含まれているか否かとの観点で集計したものである．
すべての国について F 値は最低でも 0.7 前後であり，F 値が最大となるタイの地名に関しては 0.93 に達している．
また，全体的に適合率よりも再現率の方が高い値を示している．
低い適合率は不正解を誤って所属国の候補として分類するケースがあることを表している．

所属国の推定タスクを考える場合，最も大きな問題は同じ言語を使用する複数の国の間での判別である．
たとえば，中国や台湾では中国語を使用している．
使用している言語が同一であったり類似性の高いものであったりする場合，異なる国であっても，地名を構成する文字の並びが持つ特徴は類似したものとなる．
また，言語が異なる場合でも，地理的に近い国では，文化的，歴史的背景から，似た地名が複数現れる場合がある．
地名コーパスから得られる特徴が類似している場合，所属国の推定は困難となるが，国によっては複数の公用語や先住民の言語が使われることによって所属国の推定するための特徴を見出せる可能性がある．

\begin{table}[b]
\hfill
\begin{minipage}[t]{150pt}
 \caption{所属国の選択分類器の精度}
 \label{tab:accuracy-svm}
\input{03table09.txt}
\end{minipage}
\hfill
\begin{minipage}[t]{240pt}
  \caption{選択分類器による国ごとの所属国候補選択の結果}
  \label{tab:fmeasure-svm}
\input{03table10.txt}
\end{minipage}
\hfill
\end{table}
\begin{figure}[b]
\begin{minipage}[t]{.48\textwidth}
  \begin{center}
  \includegraphics{17-1ia3f6.eps}
  \end{center}
   \caption{中国が候補として出力された割合}
   \label{fig:classification-ch+tw-ch}
 \end{minipage}
 \hfill
 \begin{minipage}[t]{.48\textwidth}
  \begin{center}
  \includegraphics{17-1ia3f7.eps}
  \end{center}
   \caption{台湾が候補として出力された割合}
   \label{fig:classification-ch+tw-tw}
 \end{minipage}
\end{figure}

図~\ref{fig:classification-ch+tw-ch} と 図~\ref{fig:classification-ch+tw-tw} は，各国について選択分類器を用いて所属国の推定を行った結果として，
中国または台湾が候補となった割合を示す．
図~\ref{fig:classification-ch+tw-ch} と 図~\ref{fig:classification-ch+tw-tw} に示されるように，中国と台湾の地名の所属国の推定では，どちらの地名も，互いを同時に候補に残す場合が多く見られ，逆に，中国と台湾以外の国が候補に残る可能性は低い．

\ref{sec:surface-features} 節で述べたように，中国の地名と台湾の地名では $n$-gram 情報で類似した特徴を持っている（表~\ref{tab:ngram-data}）が，長さの情報に違いが見られる（図~\ref{fig:toponym-word-char-length}）等，差異は存在する．
10 ヶ国での実験結果（表~\ref{tab:fmeasure-svm}）と比較して，中国と台湾のみの地名を用いて学習を行った選択分類器を用いた場合には，再現率を高く保ったままで適合率をあげることができている（表~\ref{tab:ch-tw-9}，表~\ref{tab:ch-tw-2}）．
表~\ref{tab:ch-tw-9} と表~\ref{tab:ch-tw-2} の比較から，生成確率を用いた所属国の候補の絞込みと，選択分類器による精度の向上の組合せによって，再現率と適合率の両方を向上させることがわかる．
10 ヶ国で学習する場合と 2 ヶ国に絞って学習する場合では学習内容が異なり，10 ヶ国での学習の場合では本稿の第一フェーズのような絞込みの意味合いが強いのに対して，類似の 2 ヶ国に絞って学習する場合ではその 2 ヶ国間での差異が強調される．
本稿は，第一フェーズで候補の絞込みを行った上で，第二フェーズとして絞込み後の 3 候補のみを対象として学習した選択分類器を用いて候補選択を行うことで，地名の所属国の推定の精度を向上させるものである．


\subsection{生成確率情報と選択分類器を組み合わせた地名の所属国の推定}
\label{sec:consideration-ngrams+svm}

本稿の提案手法は，\ref{sec:automatic-area-identification-with-ngrams}~節の生成確率を用いた候補絞込み手法を第一フェーズ，\ref{sec:automatic-area-identification-with-svm}~節の選択分類器を用いた所属国の候補選択手法を第二フェーズとした二段階の処理で所属国の推定を行うものである（図~\ref{fig:system-overview}）．

\begin{table}[b]
 \begin{minipage}[t]{.45\textwidth}
  \caption{10ヶ国で学習した場合（表~\ref{tab:fmeasure-svm} 抜粋）}
  \label{tab:ch-tw-9}
\input{03table11.txt}
 \end{minipage}
 
 \hfill
 
 \begin{minipage}[t]{.45\textwidth}
  \caption{2 ヶ国で学習した場合}
  \label{tab:ch-tw-2}
\input{03table12.txt}
 \end{minipage}
\end{table}
\begin{table}[b]
 \caption{各手法を用いた所属国の推定の結果}
 \label{tab:result-trigram+svm}
\input{03table13.txt}
\end{table}


表~\ref{tab:result-trigram+svm} に，\ref{sec:automatic-area-identification-with-ngrams}~節の 生成確率のみを用いた手法，\ref{sec:automatic-area-identification-with-svm}~節の選択分類器のみを用いた手法，その両方を組み合わせた本提案手法のそれぞれについて，所属国の推定を行った結果を示す．
生成確率のみを用いた手法では F 値は 0.49 と低いが，その主因は適合率の低さにある．
生成確率のみを用いた手法は再現率が高く，このことから，本手法でこの手法を処理の第一段階の絞込みフェーズとして用いたことは妥当であるといえる．

生成確率と選択分類器の両方を組み合わせた本手法の F 値は 0.83 であり，選択分類器のみを用いた手法の F 値 0.74 と比べて，向上を示した．
両者の再現率にほとんど違いがないにもかかわらず，適合率は，生成確率と選択分類器を組み合わせることで，61.58\% から 74.08\% へ向上しており，これが F 値の改善に繋がった．

\begin{figure}[b]
\vspace{-0.5\baselineskip}
 \begin{center}
  \includegraphics{17-1ia3f8.eps}
 \end{center}
  \caption{3 手法の適合率および再現率の比較}
  \label{fig:result-trigram+svm}
\end{figure}

選択分類器のみを用いた場合には，生成確率のみの場合と比べ，再現率は若干劣る．
生成確率を用いた手法を絞込みフェーズとして用いた後に選択分類器を選択フェーズとして実行する本手法でも，再現率は選択分類器のみの場合とほぼ同じであり，絞込みフェーズの段階で再現率が 98\% 程度に落ちることを考え合わせると，本手法の所属国の選択フェーズでの正解の脱落は十分少ないことがわかる．

図~\ref{fig:result-trigram+svm} は，各国の所属国の推定結果を表している．
生成確率と選択分類器を組み合わせた本提案手法（図中の黒丸）では，再現率が 95.03\%，適合率が 74.08\% であり，F 値 が 0.83 であった．
生成確率のみの情報を用いた手法（図中の黒三角）では適合率が 32.49\% と低いが，再現率は 97.46\% と高くなっている．
選択分類器のみを用いた手法（図中の黒四角）では，$n$-gram と長さの情報を用いることで適合率を 61.58\% に向上させている．
図~\ref{fig:result-trigram+svm} では，国ごとに比較した場合でも同様の傾向が見られ，どの国に対しても効果を発揮する手法であることが期待できる．
この結果は，正しい国を候補として残しつつも，正しくない国を候補から除去する能力を向上させたことを示している．

これらのことから，複数の所属国の候補をまず可能性の高い所属国の候補のみに絞り込む第一フェーズと，絞込み後の候補のみに対象を絞って選択分類器に掛ける第二フェーズから成る本提案手法は，第一フェーズによる可能性の低い候補の除去と，第二フェーズによる類似している国の間の差異を用いた候補選択とがそれぞれ有効に働き，高い再現率を保ったまま適合率を向上させることができると結論付ける．


\end{document}
