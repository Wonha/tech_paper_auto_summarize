\documentstyle[epsf,jnlpbbl]{jnlp_j_b5}

\setcounter{page}{3}
\setcounter{巻数}{6}
\setcounter{号数}{7}
\setcounter{年}{1999}
\setcounter{月}{10}
\受付{1998}{12}{9}
\再受付{1999}{3}{1}
\再々受付{1999}{5}{25}
\採録{1999}{6}{9}



\title{形態素解析結果から過分割を検出する統計的尺度}
\author{内山 将夫\affiref{shinshu-u}}

\headauthor{内山}
\headtitle{形態素解析結果から過分割を検出する統計的尺度}

\affilabel{shinshu-u}{信州大学工学部電気電子工学科}
{Department of Electrical and Electronic Engineering, Faculty of Engineering, Shinshu University(現在，郵政省通信総合研究所，Communications Research Laboratory, Ministry of Posts and Telecommunications)}

\jabstract{本稿では，形態素解析の結果から過分割(正解が分割していないと
  ころを形態素解析システムが分割している個所)を検出するための統計的尺
  度を提案する．もし，形態素解析の結果から過分割を検出できれば，それを
  利用して形態素解析結果の過分割を訂正する規則を作成できるし，人手修正
  済みのコーパスで除去しきれていない過分割を発見し取り除くこともできる
  ため，そのような尺度は有用である．本稿で提案する尺度は文字列に関する
  尺度であり，文字列が分割される確率と分割されない確率との比に基づいて
  いて，分割されにくい文字列ほど大きな値となる．したがって，この値が大
  きい文字列は過分割されている可能性が高い．本稿の実験では，この尺度を
  使うことにより，規則に基づく形態素解析システムの解析結果から，高精度
  で過分割を検出できた．また，人手で修正されたコーパスに残る過分割も検
  出できた．これらのことは，提案尺度が，形態素解析システムの高精度化に
  役立つこと，及び，コーパス作成・整備の際の補助ツールとして役立つこと
  を示している．}

\jkeywords{コーパス,日本語形態素解析,分割誤り}

\etitle{Statistical Measure for Detecting \\
Over-Segmentations in Results of \\
Japanese Morphological Analysis}
\eauthor{UTIYAMA Masao \affiref{shinshu-u}}

\eabstract{This paper proposes a statistical measure for detecting
  over-segmentations, which are errors in segmentation where a
  morphological analyzer segments places which should not be
  segmented, in results of Japanese morphological analysis.  Such a
  measure is useful because we can use detected over-segmentations for
  creating error correction rules or for removing remaining errors in
  manually debugged corpora.  The measure proposed in this paper is
  based on the ratio of the probability of a whole string to that of
  the string being segmented into two parts.  Therefore, the value of
  the measure is high when a given string is rarely segmented into two
  parts. Consequently, a string rated high by the measure is likely to
  contain over-segmentations.  In the experiments, the measure
  detected over-segmentations in the results of rule-based
  morphological analyzers very precisely and it also detected
  remaining over-segmentations in manually debugged corpora.  These
  results show that the proposed measure is useful for developing high
  quality Japanese morphological analyzers and for
  developing/debugging corpora.}

\ekeywords{corpus, Japanese morphological analysis, segmentation error}

\parindent 1em
\newcommand{\B}{}
\newcommand{\E}{}

\begin{document}

\maketitle

\section{過分割を検出する統計的尺度}
\label{sec:measure}

まず，形態素解析システムの解析結果における分割誤りを分類し，検出対象で
ある過分割を定義づける．次に，過分割を検出する統計的尺度について述べる．

\subsection{形態素解析結果における分割誤り}
\label{sec:error}

分割点という用語を導入し，それを用いて，形態素解析結果における分割誤り
を分類する．

まず，長さ$n$の文字列$S$を，$S=c_1,c_2,...,c_n$とする．このとき，$S$の
$i$番目の分割候補点とは，文字$c_i$と文字$c_{i+1}$の間をいう．また，分
割候補点が分割点であるとは，その分割候補点が形態素境界である場合をいい，
その分割候補点は分割されているという．

たとえば，「$S=休憩室$」とすると，1番目の分割候補点は「休」と「憩」の
間であり，2番目の分割候補点は「憩」と「室」の間である．更に，$S$が「休
憩/室」のように分割されているとすると，2番目の分割候補点は分割点である．

次に，形態素解析結果の分割誤りとは，正解と形態素解析結果とで，分割点が
異なる場合をいう．そして，分割誤りのなかで，過分割とは，正解で分割され
ていない分割候補点をシステムが分割している場合をいう．また，分割不足と
は，正解で分割されている分割候補点をシステムが分割していない場合をいう
\footnote {ここで定義した過分割と分割不足とは，形態素境界(分割点)に注
  目したものであるので，形態素自体に注目した過分割/分割不足の定義とは
  異なる．たとえば，\cite{hisamitsu98}では，分割の誤りを以下の3種類に
  分類している．なお，「正」で示される分割は，当該文字列の正しい分割を
  示し，「誤」で示される分割は，形態素解析システムによる誤った分割を示
  す．
  \begin{description}
  \item[(形態素自体に注目した)過分割]
    \begin{tabular}{ll}
      正: & 今日/の/金/相場/は,...\\
      誤: & 今日/の/金/相/場/は,...\\
    \end{tabular}
  \item[(形態素自体に注目した)分割不足]
    \begin{tabular}{ll}
      正: & ユニックス/ワークステーション\\
      誤: & ユニックスワークステーション\\
    \end{tabular}
  \item[その他の誤り(語境界交差型)]
    \begin{tabular}{ll}
      正: & 病気/が/まん延\\
      誤: & 病気/がまん/延\\
    \end{tabular}
  \end{description}
  この定義では，形態素境界を直接取り扱えないので，本稿での目的には不適
  切である．なお，語境界交差型の分割誤りは，本稿の定義では，過分割と分
  割不足が複合したものとなる．たとえば，上の例では，「が」と「ま」の間
  の分割候補点が分割不足であり，「ん」と「延」の間の分割候補点が過分割
  である．}．

たとえば，「休憩室」の分割の正解が「休憩/室」であるとき，システムが
「休/憩室」と分割したとすると，1番目の分割候補点(「休」と「憩」の間)は
過分割であり，2番目の分割候補点(「憩」と「室」の間)は分割不足である．

なお，形態素解析結果の誤りには，他には品詞付けの誤りがある．これは，形
態素への分割自体は正しいが，品詞が間違った場合である．この誤りの検出に
ついては，分割不足と同様に，本稿では考察しない．

\subsection{過分割の検出尺度の定義}
\label{sec:detecting-method}

ここで定義する尺度は，文字列に関する尺度であり，与えられた文字列が分割
される場合と分割されない場合とで確率を比較し，分割されない確率が高いほ
ど大きな値をとる尺度である．そのため，この尺度の値が大きいような分割を
されている文字列は，誤った分割(過分割)をされている可能性が高い．

より厳密には，与えられた文字列を$S =
a_1,a_2,\ldots,a_k,b_1,b_2,\ldots,b_l$とし，$S$の二つの部分文字列(形態
素\footnote{(\ref{eq:L})式では，形態素の文字列のみを考慮し，品詞は考慮
  しない．なぜなら，そうすることで，計算が単純になり，かつ，確率推定に
  おけるスパースネスを避けることができるからである．})を
$A=a_1,\ldots,a_k$と$B=b_1,\ldots,b_l$とするとき，
\begin{equation}
  \label{eq:L}
  L(A,B) = \log \frac{\Pr(\B,a_1,\ldots,a_k,b_1,\ldots,b_l,\E)}{\Pr(\B,a_1,\ldots,a_k,\E)\Pr(\B,b_1,\ldots, b_l,\E)}
\end{equation}
は，以下で述べるように，文字列$S$の形態素$A$と$B$への切れにくさを表現
している．ただし，$\B$と$\E$は，それぞ
れ，形態素の前後に付ける区切り記号であり，$\Pr(\cdots)$は，文字列の生
起確率である．すなわち，$\Pr(\B,c_1,\ldots,c_k,\E)$については，$c_{0}=\B, c_{k+1}=\E$とすれば，
\begin{eqnarray}
  \label{eq:n}
  \lefteqn{\Pr(\B, c_1,\ldots, c_k, \E)}\nonumber \\
  & = & \Pr(\B)\prod_{i=1}^{k+1}\Pr(c_i|c_0,\ldots,c_{i-1}) \nonumber \\
  & \simeq & \Pr(\B)\prod_{i=1}^{k+1}\Pr(c_i|c_{i-n+1},\ldots,c_{i-1})
\end{eqnarray}
である．ただし，適当な$n$により，$\Pr(c_i|c_0,\ldots,c_{i-1})$を
$\Pr(c_i|c_{i-n+1},\ldots,c_{i-1})$で近似する．

(\ref{eq:L})式で定義した尺度$L(A,B)$は，文字列$S=AB$の形態素$A$と$B$へ
の切れにくさを表している．すなわち，$L(A,B)$が大きいときには，$S$は$A$
と$B$には分割されがたい．なぜなら，$L$の分子は，$S$が一つの形態素とし
て(区切り記号が途中に入らずに)生起する確率であるのに対して，分母は，
$S$が二つの形態素に分れて独立に生起する確率であるから，$L$が大きいほど，
$S$が一つの形態素として生起する比が大きいからである．そのため，$L$が大
きいほど分割が誤っている可能性が高い．すなわち，$a_k$と$b_1$の間の分割
は過分割である可能性が高い．

たとえば，\ref{sec:experiments}章の実験によると，「$S=休憩室$」のとき，
「$A=休$」，「$B=憩室$」とすると，$\log \Pr(\B,休,憩,室, \E)=-24.3$，
$\log \Pr(\B,休,\E)=-12.9$， $\log \Pr(\B,憩,室, \E)=-29.4$であるので，
$L(休,憩室) =-24.3+12.9+29.4=18.0$となる．一方，「$A=休憩$」，「$B=室$」
とすると，$\log \Pr(\B,休,憩,\E)=-13.7$，$\log \Pr(\B,室, \E)=-10.4$で
あるので，$L(休憩,室) =-24.3+13.7+10.4=-0.20$となる．二つを比較すると，
$L(休,憩室) >L(休憩,室) $であるので，尺度$L$によると，「休憩室」につい
ては，「休/憩室」という分割の方が「休憩/室」という分割よりも起り難い．
すなわち，過分割である可能性が高い．これは我々の言語感覚と一致する．

\subsubsection*{尺度$L$の適用範囲}

尺度$L$が効果的に検出できるような過分割は，脚注2に示した分割誤りのうち
で，形態素自体に注目した過分割である．それに対して，語境界交差型におけ
る過分割の検出への尺度$L$の有効性は，形態素自体に注目した過分割に対す
るものよりも低いと予想される\footnote{このことは査読者に指摘していただ
  いた．}．なぜなら，問題にしている分割点が語境界交差型の分割誤りの場
合，たとえば，「が/まん延」を「がまん/延」と間違えている場合には，$L
(がまん,延)$を計算するのだが，このとき，$\Pr(\B, が, ま, ん, 延, \E)$
が高い確率値を示し，$\Pr(\B，が, ま, ん, \E)\Pr(\B, 延 \E)$が低い確率
値を示すことは必ずしも期待できないからである．なぜなら，コーパス中で
「$\B{}がまん延\E$」が頻出し，「$\B{}がまん\E$」や「$\B{}延\E$」が出現
しないということは保証できないからである．

ただし，実際上は，(\ref{eq:n})式の確率を推定するときには，$n=2$や$n=3$
により近似するので，(\ref{eq:L})式の計算に関係するのは，分割点の近傍の
文字だけになり，その結果，語境界交差型の分割誤りと形態素自体に注目した
過分割とで尺度$L$の有効性の違いは小さくなると考えられる．

\subsection{尺度$L$と相互情報量との違い}
\label{sec:rel-to-mi}

本節では，尺度$L$と，よく知られた統計量である相互情報量\cite{Kita96}と
の違いを述べる．

形態素$A$と形態素$B$の相互情報量$MI(A,B)$は，$\Pr(A)$と$\Pr(B)$を形態
素$A$と$B$の生起確率とし，$\Pr(A,B)$を，形態素$A$と形態素$B$が，この順
番で隣接して生起する確率とすると，
\begin{equation}
  \label{eq:mi}
  MI(A,B) = \log \frac{\Pr(A,B)}{\Pr(A)\Pr(B)}
\end{equation}
である．次に，(\ref{eq:mi})式を，(\ref{eq:L})式と同様に，文字の連鎖と
して表すと，
\begin{equation}
  \label{eq:mi-char}
  MI(A,B) = \log \frac{\Pr(\B,a_1,\ldots,a_k,\E,\B,b_1,\ldots,b_l,\E)}{\Pr(\B,a_1,\ldots,a_k,\E)\Pr(\B,b_1,\ldots, b_l,\E)}
\end{equation}
となる．$MI(A,B)$が大きいときには，形態素$A$と$B$が共起する確率は，そ
れぞれが独立に生起する確率よりも大きいといえるので，$MI(A,B)$は，形態
素$A$と形態素$B$との共起関係の強さ(共起強度)を表す尺度として利用できる．

(\ref{eq:L})式で表される尺度$L$と，(\ref{eq:mi-char})式で表される相互
情報量とが異なることは，$\Pr(\B,a_1,\ldots,a_k,b_1,\ldots,b_l,\E) \ne
\Pr(\B,a_1,\ldots,a_k,\E,\B,b_1,\ldots,b_l,\E)$であることから分る．また，
定性的にいっても，$\Pr(\B,a_1,\ldots,a_k,b_1,\ldots,b_l,\E)$は，
\ref{sec:detecting-method}節で述べたように，$S=AB$が一つの形態素として
生起する確率であるのに対して，$\Pr(\B,a_1,\ldots,a_k,\E,\B,b_1,\ldots,b_l,\E)$は，形態素$A$と形態素$B$と
が二つの形態素として隣接して生起する確率であるので，これら二つの確率は
異なる．

定性的な違いを要約すると，尺度$L$は，形態素$S=AB$が形態素$A$と形態素
$B$に分割されるときの分割の困難さを表すが，相互情報量は，形態素$A$と形
態素$B$が隣接して生起するときの生起の容易さを表すと言える．これらは関
連していることは確かであるが，基本的には異なる．

なお，\ref{sec:experiments}章では，実験の一つとして，尺度$L$と相互情報
量を含む五つの尺度について，過分割の検出精度を比較する．

\section{考察と今後の課題}
\label{sec:discussion}

\subsubsection*{確率推定法と尺度$L$}

本稿の実験では，(\ref{eq:n})式の確率を推定するために，
\ref{sec:overview}節に述べたような$n$の値と確率推定法を用いたが，確率
推定の方法には，最尤推定やバックオフスムージングの他にも様々な方法があ
り，さらに，バックオフスムージングについても様々な discounting の方法
があるので，これらを適用した場合の尺度$L$の過分割検出精度について網羅
的に調べることを今後の課題としたい．

本稿でこのことを網羅的に調べなかった理由は，本稿での主要な目的は，
\ref{sec:introduction}章で述べたように，従来の研究で人手で発見されるこ
とが前提となっていた過分割を，尺度$L$を用いることにより半自動的に抽出
できることを示すことにあったので，そのことを示すためには，なんらかの
(代表的な)確率推定法を利用した場合について示すだけで十分であったからで
ある．すなわち，確率推定法の優劣(尺度$L$と併用したときの過分割検出精度
の良否)を調べることは副次的な事柄であったからである．

なお，予備実験として，京大コーパスを利用し，
\begin{itemize}
\item n=2，または，n=3
\item Witten-Bell discounting によるバックオフスムージング，または，最尤推定
\end{itemize}
から作られる四つの組合せのそれぞれについて(\ref{eq:n})式の確率を推定し，
尺度$L$による分割点調査率を調べた結果は，教師あり学習と教師なし学習の
双方について，$n=2$に最尤推定を組み合わせたものと$n=3$にバックオフスムー
ジングを組み合わせたものとがほぼ等しく良く(教師なし学習では前者が若干
良く，教師あり学習では後者が若干良い)，その他の組み合わせ($n=3$と最尤
推定および$n=2$とバックオフスムージング)は，この二つよりも劣っていた．
このような結果の原因としては，$n$や確率推定法の違いの他に，訓練データ
のサイズが約1万文と比較的少ないことが影響していると考えられる．

\subsubsection*{確率に基づく形態素解析システムへの適用}

確率に基づいた形態素解析システム(あるいは単語分割システム)には，文字の
連鎖確率に基づいたシステム\cite{yamamoto97,oda98}と単語や品詞の連鎖確
率に基づいたシステム\cite[など]{nagata94,itoh97,mori98}がある．

\cite{yamamoto97,oda98}では，本稿とは実現手法は異なるが，形態素境界の
情報を文字に取り込むことにより，文字列により形態素列を表現している．そ
して，入力文に対して，(形態素境界情報を含む)文字の連鎖確率が最大になる
ような解を求めることにより，最適な形態素列を得ている．一方，\cite[など]
{nagata94,itoh97,mori98}では，単語や品詞n-gramに基づいて形態素解析をし
ており，文字情報を直接用いているのは未知語モデルに限定されている．

これらの形態素解析システムの解析結果からも尺度$L$が過分割を検出できる
かを調べることは今後の課題であるが，\cite{yamamoto97,oda98}と\cite[な
ど] {nagata94,itoh97,mori98}を比べた場合，前者は，文字の連鎖確率を直接
用いて形態素列への分割を行なっている点が，尺度$L$と極めて類似している
ため，前者に尺度$L$を適用した場合の過分割検出精度は，(文字レベルでの分
割の最適化を行なっていない)後者に適用した場合と比較して劣ることが予想
される．しかし，\cite[など] {nagata94,itoh97,mori98}の品詞や単語の
n-gramに基づくシステムに尺度$L$を適用した場合についても，規則に基づく
形態素解析システムに比較すれば，最適な形態素列を求めるときに，可能な分
割を相互に比較し最高確率のものを出すという形で，尺度$L$に用いた情報が
既に用いられているとも言えるため，尺度$L$の有効性は低いと予想される．

\subsubsection*{分割不足の検出}

筆者は，予備実験として，実験1,2と同様の確率推定法で，JUMANにより解析さ
れた京大コーパスB全体を訓練およびテストコーパスとして，教師なし学習で
の確率推定値を用い，尺度$L$により分割不足の検出を試みた．つまり，尺度
$L$の値が小さい位置が形態素として結合されている場合について，それが実
際に分割不足かを確かめた．

その結果は，分割不足の再現率が10％の時点で，既に適合率が4％であり，実
験2における，再現率が10％のときの適合率が47％と比べて非常に劣っていた．

その理由の一つは，形態素解析システム中の形態素に比較的長い単位が多く，
かつ，分割不足として抽出されたものの多くが，その長い単位の形態素を短い
単位に分割しようとしているためである．たとえば，分割不足として抽出され
たものの上位には，'/'が候補位置とすると，「穴を/あけた」「目を/見張る」
「あっという/間」などがある．

このような場合と，明確に間違いである分割不足とを区別することは尺度$L$
には不可能なので，尺度$L$により分割不足を検出するのは，過分割の場合ほ
どには上手くいかない．

\appendix
\input{tab2-short_2.tex}

\bibliographystyle{jnlpbbl} 
\bibliography{v06n7_01}


\begin{biography}
\biotitle{略歴}
\bioauthor{内山 将夫}{
筑波大学第三学群情報学類卒業(1992).
筑波大学大学院工学研究科博士課程修了(1997).
信州大学工学部電気電子工学科助手(1997)．
郵政省通信総合研究所非常勤職員(1999).
博士(工学).
}

\bioreceived{受付}
\biorevised{再受付}
\biorerevised{再々受付}
\bioaccepted{採録}
\end{biography}

\end{document}
