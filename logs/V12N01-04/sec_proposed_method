我々は，Sinclairらの対話構造モデル[CITE]を拡張し，チャット対話に適用した．
表[REF_tbl:chat]のチャット対話例にこのモデルを適用した結果を図[REF_fig:chat_layeredstructure2relateness]に示す．
Sinclairらは対話構造を，複数の階層から構成される対話のやりとりの構造としてモデル化している．
まず，対話中の発言を相互行為上の機能(真偽を確かめる質問や確認など)によって定義される単位であるアクトと見なす．
次に，同一話者による複数のアクトを，質問や応答などの対話の局所構造の中での機能を表現するムーブにまとめる．
さらに，異なる話者によるムーブの間の関係(例えば，話者Aの質問に対する話者Bの応答)を考え，こうした関係にある複数のムーブのまとまりをエクスチェンジとする．
Sinclairらのモデルは，対話の発言間の関係を捉える道具立てとしてチャット対話の構造解析にも有用であると考えられる．
しかし，チャット対話にこのモデルをそのまま適用することは2つの理由で難しい．
1つ目の理由は，処理の基本単位の違いである．
Sinclairらの対話構造モデルでは，区切り送信によって生じた表[REF_tbl:chat]の31のような未完結な発言を想定しておらず，そうした発言の扱いが明らかでない．
2つ目の理由は，ムーブ間の応答関係の交差の問題である．
チャット対話では，表1の対話例の発言24と26のように，応答関係にあるムーブ同士が必ずしも隣接しない．
Sinclairらのモデルはこの例のようにムーブ間の応答関係が交差する可能性を想定していない．
我々は，Sinclairらのモデルを以下のように拡張する．
区切り送信は発言権を相手に渡さないために起こるとされている[CITE]．
我々は，このような発言を発言権の保持を意図するアクトと見なし，モデルの基本単位を区切り送信によって区切られた個々の発言に変更する．
また，ムーブ間の応答関係が交差する現象を表現できるよう，交差を許すモデルに拡張する．
これらの拡張により，チャット対話特有の現象を含めて対話構造を表現することができるようになり，対話構造解析アルゴリズムの議論が可能になる．
また，Sinclairらのモデルは，どのような発言(アクト)同士が継続関係をなしてムーブを構成するか，あるいはどのようなムーブ同士が応答関係をなしてエクスチェンジを構成するかに関する具体的な規定が示されておらず，この点も問題である．
4節に詳述するように，本論文で提案する解析手法には，教師データとして対話構造を付与した信頼性の高いコーパスが必要である．
このため，対話構造モデルをチャット対話データに適用するための具体的な指針が必要である．
以下2.1節及び2.2節では，発言間の継続関係およびムーブ間の応答関係を新しく規定し，指針を示す．
この結果，3節で述べるように，タグ付け作業者間の判断のゆれが少ない，信頼性の高い注釈つきコーパスを構築することができた．
ムーブを構成する同一話者による発言(アクト)間の関係を継続関係と呼ぶ．
表[REF_tbl:chat]の例で言うと，発言31から33までの同一話者による一連の発言のまとまりがムーブであり，発言31と32の関係及び32と33の関係をそれぞれ継続関係と言う．
一方，発言28と30は同一話者による発言であるが，それぞれ異なるムーブの構成素であり，この発言間には継続関係はないと考える．
上で論じたように，本モデルでは区切り送信で区切られた発言を基本単位に変更したので，どのような発言同士が継続関係をなしてムーブを構成するかを新しく規定する必要がある．
以下，継続関係にある発言(例えば発言27と28)において，前の発言(例えば発言27)を先行発言，後の発言(例えば発言28)を後続発言と呼ぶ．
継続関係の定義は，人間が判断しやすいもので，かつ同定の自動化も容易なものでなければならない．
本論文では新たに，統語的手がかりに基づいて，継続関係を助詞類型，接続詞類型，特殊表記型，名詞類型，倒置型，挿入節型の6つの型に分けて定義する．
以下に示す継続関係の例では，統語的手がかりに下線をひく．
[MATH]
先行発言(a)の末尾表現が格助詞または接続助詞，読点であるといった局所的な情報から，先行発言(a)の一部が後続発言(b)の一部に係ると判断できる場合を助詞類型を呼ぶ．
\eenumsentence{
Aさん：Bさんは
Aさん：技術がないからダメ．
}
\eenumsentence{
Aさん：一生懸命やってるのですが、
Aさん：報われません}
[MATH]
先行発言(a)の末尾表現が発言のはじまりを示す合図表現または接続詞，フィラー，感動詞，接続表現であるといった局所的な情報から，先行発言(a)の一部が後続発言(b)の一部に係ると判断できる場合を接続詞類型と呼ぶ．
\eenumsentence{
Aさん：あのー、で
Aさん：Xって会社名、聞いたことある？}
[MATH]
先行発言(a)の末尾表現が終助詞または助動詞などの文末表現であり，後続発言(b)の先頭表現がエモーティコンや引用記号を使った引用表現であるといった局所的な情報から，先行発言(a)の一部が後続発言(b)の一部に係ると判断できる場合を特殊表記型と呼ぶ．
\eenumsentence{
Aさん：で，実際やめたけどね
Aさん：（笑）}
[MATH]
先行発言(a)の末尾の形態素が名詞であり，名詞が数詞又は名詞の後に助詞が省略されていると判断でき先行発言(a)の一部が後続発言(b)の一部に係ると判断できる場合を名詞型と呼ぶ．
下の例では，先行発言(a)の名詞「S選手」の後に助詞が省略されていると判断できる．
\eenumsentence{
Aさん：S選手
Aさん：エースですよ}
[MATH]
後続発言(b)の一部が先行発言(a)の一部に係ると判断できる場合を倒置型と呼ぶ．
\eenumsentence{
Aさん：エースですよ
Aさん：マンチェスターでも}
[MATH]
後続発言(b)が先行発言(a)に対しての言い換えや言い直し等の挿入節と判断できる場合を挿入節型と呼ぶ．
下の例では，発言(a)から(c)にかけての同一話者による一連の発言が同一ムーブである．
挿入型に限り，発言(a)と(b)及び発言(a)と(c)がそれぞれ継続関係にあるとする．
つまり，継続関係が枝分かれすることになる．
発言(b)と(c)の間には何ら統語的関係は認められないので，枝分かれ構造を仮定するのは自然である．
また，厳密には挿入節とは言えないが，自分の発言に対する付加的発言，いわゆる自己レスも挿入型とする．
自己レスは，例えば下の例の発言(a)と(b)のように，挿入型と同様の出現形態と判断できるからである．
\eenumsentence{
Aさん：勘違いしていると思いますが
Aさん：変な文章だな(´Д｀;)
Aさん：北の某大学は俺にとっちゃアントラーズみたいなもんです}
エクスチェンジを構成する異なる話者によるムーブ間の関係を応答関係と呼ぶ．
表[REF_tbl:chat]の例で言うと，発言31から33までのムーブAとそれと異なる話者による発言34からなるムーブBが応答関係にある．
一方，発言30からなるムーブCとムーブAは発話者は異なるが，応答関係にはなく，異なるエクスチェンジに属する．
本論文では，エクスチェンジの一般形[CITE]にしたがってムーブの機能を働きかけ，応答，補足，応答/働きかけの4つに分類し，ムーブ間の応答関係を規定する．
エクスチェンジの構成規則は以下のように一般化されている[CITE]．
*は0回以上の繰り返しを表す．
[MATH]
この構成規則から，応答関係にあるムーブの機能の組合せとしては，[働きかけ]→[応答]，[応答]→[補足]，[補足]→[補足]の3通りが可能である．
さらに我々は以下に述べるように，各ムーブを構成する発言の種類に基づいて，ムーブ間の応答関係をより詳細に制限する．
まず，発言をアクトと呼ばれる下位分類に分類する．
アクトの分類方法についてはすでにいくつかの提案がある．
本研究では発話行為タグ[CITE]を参考に表[REF_tbl:acts]に示す20種類のアクトを定義した．
ただし，アクトが区切り送信によって複数の発言に分割されている場合は，それら複数の発言をまとめたものにアクトを与える．
次に，どのようなムーブ同士が応答関係を構成し得るかに関する制約をムーブに含まれるアクトに基づいて表[REF_tbl:crp]のように与える．
例(8)は，発言(a)と(b)からなるムーブAと発言(c)と(d)からなるムーブBとの応答関係である．
発言(a)と(b)のアクトは区切り送信によって複数の発言に分割された真偽情報要求アクトである．
一方，発言(c)は否定・拒否アクト，発言(d)は情報伝達アクトであり，ムーブBは2つのアクトからなる．
表[REF_tbl:crp]から，真偽情報要求アクトを含むムーブと応答関係を構成し得るのは，肯定アクトあるいは否定・拒否アクト，不明な応答アクトを含むムーブである．
\eenumsentence{
Aさん：ベロンって[真偽情報要求]
Aさん：まだラツィオにいるんだっけ？[(区切り送信)]
Bさん：いや[否定・拒否]
Bさん：彼はマンチェスターにいます。
[情報伝達] }
入力対話に対し，対話の先頭の発言から最末の発言にかけて順番に解析する．
提案した対話構造の階層モデルに従い，まず継続関係の同定を入力対話全てに対して試み，発言をムーブにまとめあげる．
その後，ムーブ間の応答関係を同定し，ムーブをエクスチェンジにまとめあげる．
本手法では，ムーブ間の応答関係を同定する際には，ムーブを構成する全ての発言を素性の抽出対象とするため，ボトムアップに対話構造を解析する手法を用いた．
入力対話に対し，対話の先頭の発言から最末の発言までを走査しながら，その位置での発言(以下，対象発言と呼ぶ)ごとに次のステップに従って処理を進める．
ステップ1：継続先発言候補の抽出
継続関係にある発言が対象発言に隣接しているとは限らないため，対象発言から[MATH]発言前までの対象発言と同一話者の発言とのペアを全て抽出する．
一つの対象発言に対する[MATH]個の異なる先行発言とのペアの集合を候補ペア集合とする．
ステップ2：継続先発言の決定
分類器は，表[REF_tbl:features]に示す素性集合を利用して，候補ペア集合に含まれるすべてのペアに対して継続関係があるか否かを分類する．
複数のペアが関係ありと分類された場合は，分類器の出力するスコア(確信度)の一番高いペアに一意に決定する．
候補のペア全てが関係なしと分類された場合，対象発言には継続関係にある先行発言が存在しないとする．
つまり，対象発言はムーブを構成する先頭の発言と同定される．
表[REF_tbl:features]については4.3節で詳述する．
表[REF_tbl:chat]の対話を例に継続関係の同定手順を図[REF_fig:identify_relateness3]に示す．
図は対象発言が28，先行発言の参照数[MATH]が4の場合を表している．
まず，対象発言と同一話者による発言である24と27の発言とのペアを候補ペアとして抽出し，分類する．
分類後，発言24と28及び27と28のペアと複数のペアが関係ありと分類されるが，スコアを比較した結果，27と28のペアが継続関係となる．
入力対話に対し，対話の先頭のムーブから最末のムーブまでを走査しながら，その位置でのムーブ(以下，対象ムーブと呼ぶ)ごとに次のステップに従って処理が進む．
ステップ1：応答先ムーブ候補の抽出
応答関係にあるムーブが対象ムーブに隣接しているとは限らないため，対象ムーブから[MATH]ムーブ前までの対象ムーブと異なる話者のムーブとのペアをすべて抽出する．
一つの対象ムーブに対する[MATH]個の異なる先行ムーブとのペアの集合を，候補ペア集合とする．
ステップ2：応答先ムーブの決定
分類器は，表[REF_tbl:features]に示す素性集合を利用して，候補ペア集合に含まれるすべてのペアに対して応答関係があるか否かを分類する．
複数のペアが関係ありと分類された場合は，分類器が出力するスコア(確信度)の一番高いペアに一意に決定する．
候補のペア全てが関係なしと分類された場合，対象ムーブには応答関係にある先行ムーブが存在しないとする．
つまり，対象ムーブがエクスチェンジを構成する先頭のムーブと同定される．
表[REF_tbl:chat]の対話を例に応答関係の同定手順を図[REF_fig:identify_OTOrelateness]に示す．
図は対象ムーブが34(この事例では，発言34のみがムーブを構成する発言)，先行発言の参照数[MATH]が7の場合を表している．
対象ムーブと異なる話者によるムーブ(27，30，31の発言が各ムーブを構成する発言の中で，先頭の発言)のペアを候補ペアとして抽出し，分類する．
結果，31と34の発言を含むムーブのペアが応答関係となる．
本手法では，素性として複数の発言の形態素情報の2つ組の組合せを全て考えるため，素性の異なりは数万となり分類器への入力ベクトルは高次元になる．
そこで，分類器には，素性集合の冗長性に対して比較的頑健な性質を持つサポートベクタマシン[CITE]を利用した．
スコア(確信度)としては分離平面からの距離を用いた．
訓練時には，継続関係及び応答関係の同定処理のステップ1と同じ処理を行ない獲得した各ペアから表[REF_tbl:features]に示す素性集合を抽出し，各訓練事例とする．
素性集合は継続関係及び応答関係で異なる．
表[REF_tbl:features]に示す素性について説明する．
表中及び文中の略表記はそれぞれ，CRRuは対象発言．
CRRmは対象ムーブ．
PREuは先行発言．
PREmは先行ムーブ．
NANu_sは対象発言と先行発言の間にある対象発言に最寄りの同一話者の発言．
NANm_sは対象ムーブと先行ムーブの間にある対象ムーブに最寄り同一話者のムーブ．
NANm_dは対象ムーブと先行ムーブの間にある最寄りの対象ムーブと異なる話者のムーブ．
NBNu_sは対象発言の発言時間から1分以内に発言された最寄りの対象発言と同一話者の発言．
を表す．
発言に含まれる形態素情報：crr_o，pre_o，nan_o，nbn_o
発言CRRu，NBNu_sの先頭の一形態素情報と発言CRRu，PREu，NANu_sの末尾の一形態素情報をそれぞれ素性とする．
形態素の異なりの数だけ素性がある．
発言の末尾の表層表現：lw
発言CRRu，PREuの末尾の表層表現が句点または読点，クエスチョンマークであるか否かの2値を素性とする．
発言間の発言時刻の差：time
CRRuとPREu間の発言時刻の差が2分以上離れているか否かの2値を素性とする．
発言間の結束度：coh
本研究で言う結束度は，発言同士のムーブ単位へのまとまりやすさを表す．
CRRuとPREu間及びCRRuとNBNu_s間の結束度を計り，どちらのペアの結束度が強いかの2値を素性とする．
強さが同じであった場合は，CRRuとPREu間の結束度が強いとする．
結束度の強さは，個々のペアの[MATH]の共起確率[MATH]の大きさで計る．
共起確率の求め方の詳細については付録を参照されたい．
ムーブに含まれるアクト：crr_a，pre_a，nans_a，nand_a
素性の抽出対象となる各発言が表[REF_tbl:acts]に示したアクトを含むか否かを表すバイナリベクタ．
アクトは，あらかじめ定義した表層表現パタンとの対応を示すテーブルを用いて推定し，20種のアクトラベルを用いて表現する．
このテーブルは，作成したコーパスの837事例を観察し，ムーブに含まれるアクトとムーブの表層表現を元に作成した．
このテーブルをアクト辞書と呼び，内容の一部を表[REF_tbl:dic1]に示す．
実験に用いたアクト辞書は，108個の表層表現パタンを持つ．
複数のアクトラベルが記述されているものは，行為の多義があることを示す．
[tbt]
{|c|l|l|l|} \hline &抽出対象& \multicolumn{2}{|l|}{CRRu，PREu，NANu_s，NBNu_s }
\cline{2-2}\cline{3-3}\cline{4-4}継続&素性&単体&発言CRRuの先頭と末尾の形態素情報：crr_o
&&&発言PREuの末尾の形態素情報：pre_o
&&&発言NANu_sの先頭と末尾の形態素情報：nan_o
&&&発言NBNu_sの先頭の形態素情報：nbn_o
&&&発言CRRu，PREuの末尾の表層表現：lw
\cline{3-4} & &二項間&発言間の結束度：coh
&&&CRRu，PREu間の発言時刻の差：time
\hline &抽出対象& \multicolumn{2}{|l|}{CRRm，PREm，NANm_s，NANm_d }
\cline{2-2}\cline{3-3}\cline{4-4}応答&素性&単体&ムーブCRRmに含まれるアクト：crr_a
&&&ムーブPREmに含まれるアクト：pre_a
&&&ムーブNANm_sに含まれるアクト：nans_a
&&&ムーブNANm_dに含まれるアクト：nand_a
&&&ムーブCRRm，PREmの末尾の表層表現：lw
\cline{3-4} & &二項間& CRRm，PREm間の名詞または動詞，形容詞いずれかの一致：match
&&&CRRm，PREm間の発言時刻の差：time
\hline
ムーブの末尾の表層表現：lw
ムーブCRRm，PREmを構成する発言の中で一番最後の発言の末尾の表層表現がクエスチョンマークであるか否かの2値を素性とする．
ムーブ間の名詞または動詞，形容詞いずれかの一致：match
ムーブCRRm，PREmに含まれる名詞，動詞または形容詞のいずれかが一致するか否かの2値を素性とする．
ムーブ間の発言時刻の差：time
ムーブCRRm，PREmを構成する先頭の発言の発言時刻の差が5分以上離れているか否かの2値を素性とする．
