本研究では，教師付き機械学習を利用し，チャット対話の対話構造解析を行なう．
そのために，訓練データとして対話構造を付与したコーパスが必要になる．
しかし，これまでの研究では主に人手で作った規則を用いて解析する手法をとっていたため，訓練データとして使える大規模な対話構造付きコーパスは存在しない．
そこで我々は，対話構造を付与したコーパスを作成した．
本研究で使用するコーパスは，IRC(Internet Relay Chat)で公開されているチャット対話データを独自に収集し，それを元に作成したものである．
使用したチャットシステムは，CHOCOAである．
CHOCOAでは，分単位の受信時刻，送信者名，送信内容の3つ組が一度に送受信できる．
本研究では，これを入力対話の基本単位とした．
対話参加者の入退出の通知などチャットシステム自体が通知する発言は分析対象から除外した．
収集した対話データは，2人対話34対話(5769発言中システム発言を除外した5180発言)と3人対話35対話(7439発言中システム発言を除外した6725発言)の合計69対話(13208発言中システム発言を除外した11905発言)である．
発言者の異なりは27名であり，多くの話題は進路，サッカー，テレビゲームについてである．
収録期間は約4カ月である．
全発言に占める関係先を持つ発言数は表[REF_tbl:relrate4.1]の通りである．
2節で提示した対話構造モデルをチャット対話データに付与したコーパスの一部を表[REF_tbl:exp4.1]に示す．
コーパスの各項目について説明する．
発言IDは各発言固有のIDである．
関係先は，発言と関係を持つ発言のIDである．
関係先の発言が複数考えられる場合(例えば，発言45，46，47のように，2つの質問発言に対して1発言で答えるもの)は両方の発言を関係先とする．
関係名は，継続関係，応答関係のいずれかであり，関係先を持たない場合は空欄にする．
継続型は2.1節の継続関係のタイプ，アクトは2.2節の表[REF_tbl:acts]で示したアクトを表す．
発言31，32，33のように，区切り送信によって一つのアクトが複数の発言に分割されたと考えられる場合は，先頭の発言(例えば，発言31)にアクトを付与する．
受信時刻は発言を受信した時間，送信者は発言者名，送信内容は発言内容を指す．
コーパスの信頼性をタグ(関係先ID及び関係名)の一致率で評価した．
評価尺度としてκ値(Kappa Statistics)を採用した．
コーパスから取り出した3人対話837発言について2人の作業者がそれぞれタグを付与し，κ値を求めた結果は\boldmath{[MATH]}であった．
この結果から，2節で論じた継続関係，応答関係の基準によって，比較的信頼性の高い注釈付きコーパスが構築できたと言える．
得られたデータは提案手法の評価対象としても信頼に足るものであると判断した．
実験には，本研究で作成したチャット対話コーパス(2節で述べた対話構造モデル及び指針作成，アクト辞書作成で分析対象とした837事例を除いた計11028事例)を用いた．
事前にすべての発言に対して茶筌[CITE]を利用し形態素解析を行なった．
結果の妥当性・再現性を高めるために5分割交差検定を行なった．
素性の組合せも同定規則として採り入れるため，分類器(サポートベクタマシン)のカーネル関数として2次の多項式カーネルを用いた．
参照する先行発言数は解析時及び訓練時共に，継続関係で7，応答関係で8発言とした．
これはコーパスにある発言から最も遠い関係先までの発言数である．
解析時に対象発言からいくつ先の発言までとのペアを考えるかという参照先数のパラメタ最適化の問題があるが，今回は扱わなかった．
本手法及びベースラインの手法による対話構造の解析精度について調査した．
2.1節及び2.2節で詳述した継続型や，ムーブに含まれるアクトまでは同定しない．
この分類は，3節で詳述したコーパス作成の指針，4.3節で詳述したアクト辞書の作成時，および実験結果の分析作業で利用した．
ベースラインの手法では，入力対話の先頭から最末の発言までを走査しながら，(ステップ1)対象発言と対象発言に最寄りの同一話者による先行発言が継続関係にあるとみなし，(ステップ2)正しい継続関係先を与えた状態で，対象ムーブとそれに最寄りの異なる話者の先行ムーブが応答関係にあるとみなし，対話構造を解析する．
継続関係と応答関係の同定実験の結果は，精度及び再現率，F値で評価した．
対話構造全体の解析結果は一致率で評価した．
関係先が複数ある発言では，いずれかひとつと一致した場合を正解とした．
本手法とベースラインの手法による対話構造の解析結果を比較することにより，本手法の有効性を評価した．
対話構造全体の解析結果を表[REF_tbl:tree5.1]に示す．
BL2p及びBL3pは2人対話及び3人対話データにベースラインの手法を適用した結果，提案2p及び提案3pは2人対話及び3人対話データに本手法を適用した結果である．
一致率は，2人対話及び3人対話それぞれにおいて，本手法がベースラインの手法を上回っている．
継続関係及び応答関係の同定結果を表[REF_tbl:result2]に示す．
継続関係にある発言の多くは隣接しているため，BL2p，BL3pの再現率は高い．
しかし，互いに隣接する発言でも実際には継続関係を持たない場合もあるため，精度は低い．
これに対し本手法では，継続関係を持たない発言間の関係も同定しているため，精度も高くなっている．
応答関係の同定における再現率は，継続関係のものと比べて低い．
5.4節で詳述するように，特に情報伝達や真偽情報要求，未知情報要求アクトを含むムーブとの応答関係同定の失敗が再現率を大きく下げる原因となっている．
しかしながら，精度については，BL2p，BL3pに比べ本手法が大きく上回った．
アクト辞書を用いてムーブに含まれるアクトを推定することで，適切な応答関係を同定できたと言える．
アクト辞書によるアクト推定を行なわなかった場合の精度，再現率，F値はそれぞれ2人対話で0.633，0.169，0.266，3人対話で0.690，0.117，0.200であった．
ここで，2人対話と3人対話それぞれの同定精度がほぼ同程度であったことは興味深い．
この理由としては，3人対話において2人の情報交換が支配的であったことが関係していると考えられる．
このような現象は音声対話においても報告されている[CITE]．
以上の結果から，本タスクは単純な方法で解けるほど簡単な問題ではないが，アルゴリズムを工夫すれば自動化の実現性が十分にある問題であることが分かる．
こうした問題に取り組みその実現可能性を実証した例は我々の知る限り過去にない．
継続関係の同定における継続型毎の再現率を表[REF_tbl:cont_2_inve5.2]に示す．
今回の実験では，継続型までは同定していないため，精度，及びF値を求めることはできなかった．
表[REF_tbl:cont_2_inve5.2]に示すとおり，特殊表記型と倒置型，挿入型の再現率が他の型に比べて低い．
このうち，倒置型と挿入型の誤りは頻度も少なくなく，無視できない．
[MATH]
187件のうち，約3割を再現できなかった．
このうち12件は，事例(9)のように，[MATH]の3つ組(4.3節「発言間の結束度」の項を参照)だけでは発言間の結束度を判断しにくい場合であった．
このため，発言bと発言cが継続関係にあるという間違った判断をした事例も多く観察された．
これは，共起確率モデルに取り入れる事例を拡張することで改善できると考えられる．
[MATH]の3つ組だけではなく，[MATH]といった[MATH]等の共起確率も考慮する．
また，助詞「は」の二重使用はペナルティを与えるといった文法上の制約を取り入れることも考えられる．
\eenumsentence{
Aさん：ポジションチェンジなんですよね
Aさん：向こうのオーバーラップは［関係先：(a)，関係名：継続（倒置型）］
Aさん：攻めきれない時はどうするんだろ}
[MATH]
87件のうち，約3割を再現できなかった．
このうち11件は，事例(10)のように，表層表現からは判断しにくい場合であった．
文末表現(例えば，「〜ですか？」や「〜か」)をもつ発言間には継続関係がない場合が本コーパス中には多い．
このため，訓練事例中に正例と負例が混在し，関係同定に教師あり学習器を利用した本手法ではうまく扱えなかった．
このような事例を扱える素性を考える必要がある．
\eenumsentence{
Aさん：受けた仕事はどうするんですか？
Aさん：まだ受けてなかったか［関係先：(a)，関係名：継続（挿入型）］}
また，事例(11)のような，誤字の修正を意図した発言との同定を誤る場合も少なくなかった．
このような事例では，発言a，b間における文節(例えば，「服にしですが」と「福西ですが」)を同定し，文字列間の類似度を利用することが考えられる．
\eenumsentence{
Aさん：個人的には服にしですが
Aさん：福西ですが［関係先：(a)，関係名：継続（挿入型）］}
応答関係については，再現率，精度とも継続関係に比べて劣っている．
これについては，まずタスク自身の難しさが理由の一つとして考えられる．
3.2節で述べたように，本研究ではコーパスに付与したタグの信頼性を2人の作業者の一致率で評価したが，もう少し詳しく見ると，継続関係のκ値0.825に対し，応答関係のκ値は0.634であり，継続関係と比べると応答関係の同定は人間にとっても難しい作業であることがわかる．
つぎに，ムーブに含まれるアクト毎の応答関係の再現率を表[REF_tbl:res5.2.1]，表[REF_tbl:res5.2.2]に示す．
横軸はデータセットを表し，縦軸はムーブに含まれるアクト毎の応答関係を表す．
縦軸で，ブラケットで囲まれた2つの部分のうち，左の部分は，先行ムーブに含まれるアクトであり，右は後続ムーブに含まれるアクトである．
表[REF_tbl:res5.2.1]のブラケットの中の”[MATH]”は，表[REF_tbl:acts]で示した全てのアクトを意味する．
表[REF_tbl:res5.2.2]は，表[REF_tbl:res5.2.1]のうち事例の多かった情報伝達および真偽情報要求，未知情報要求アクトを先行ムーブに含む場合の再現率をさらに詳しく分析したものである．
ムーブに複数のアクトが含まれる場合は，ムーブを構成する先頭の発言のアクトのみをカウントした．
表[REF_tbl:res5.2.1]，表[REF_tbl:res5.2.2]に示すとおり，全体的な再現率は高くはない．
このうち，情報伝達と真偽情報要求，未知情報要求アクトを先行ムーブに含む応答関係は頻度も少なくなく，無視できない．
[MATH]
情報伝達アクトを先行ムーブに含む応答関係455件のうち，約6割を再現できなかった．
事例の多くは，例(12)のような後続ムーブを構成する発言のアクトがあいづちであるムーブとの応答関係であった．
実験では，4.3節で述べたようにアクト辞書を人手で作成しているため，例(12)のような表記のゆれには対応仕切れない．
文字列毎の一致から類似度を計り，表記の揺れを吸収するといった拡張が必要である．
\eenumsentence{
Aさん：狭いスペースでやらないと駄目なんすよ[情報伝達]
Bさん：なるほろ[関係先：(a)，関係名：応答（あいづち）] }
[MATH]
真偽情報要求アクトを先行ムーブに含む応答関係154件のうち，約5割を再現できなかった．
多くは，肯定・承諾や否定・拒否を明示する表現(「はい」や「いいえ」など)が使われていないムーブであり，アクト辞書だけではアクトを推定できない事例であった．
このため，再現率が低くなったと考える．
例(13)のように，否定・拒否を意図する表現が明示的されていない場合がある．
発言者Aの「オフシーズンはあるのか？」という真偽情報要求に対して，発言者Bは「正月もイベントです」と答えている．
このムーブは，「多くの人が休むであろう正月にもイベントをやるのだから，オフシーズンはない」という否定・拒否を暗示している．
\eenumsentence{
Aさん：オフシーズンってのがあるんですか？[真偽情報要求]
Bさん：正月もイベント参加です[関係先：(a)，関係名：応答（否定・拒否）] }
こうした事例に対応するには，常識的知識と複雑な推論が必要であると考えられる．
表層的な手がかりを使った統計的学習によるアプローチの限界を示すものと言えるかもしれない．
[MATH]
未知情報要求アクトを先行ムーブに含む応答関係102件のうち，約5割を再現できなかった．
しかし我々は，再現率の低さはもっと深刻になると予想していた．
本手法では，アクト辞書を用いて各ムーブに含まれるアクトを推定し素性とすることは可能であるが，未知情報応答発言におけるいわゆる5W1Hを推定することはできない．
にも関わらず，このような再現率及び精度が得られたことは興味深い．
本手法では，例(14)の発言(ムーブ)(b)，(d)間のような未知情報要求アクトを含むムーブと未知情報応答アクトを含むムーブ間の応答関係を同定するための特別な処理は行なっていない(「誰が来たの？」という発言が人の情報を要求していることを推定していない)．
応答関係にあるムーブ同士の近接性や，ムーブ間の動詞が一致していることが同定に役立ったと考えられる．
\eenumsentence{
Aさん：うちの大学は
Bさん：K大から誰が来たの？[未知情報要求]
Aさん：大丈夫らしいです[関係先：(a)，関係名：継続（助詞型）]
Aさん：凄く優秀な助手が来ました[関係先：(b)，関係名：応答（未知情報応答）] }
4.3節で詳述した素性全てを使用して作成した解析器を用いた同定結果と1つの素性を省いた残りの素性を用いた同定結果とを比較し，省いた素性が関係同定にどの程度有効かを考察する．
表[REF_tbl:featureAnalysys_cont]は，解析器作成で使用した素性の組み合わせ毎の継続関係の同定精度，再現率，F値を表している．
素性を削除して精度等が下がる場合は，削除した素性は関係同定に有効であると考えられる．
表中の略表記の意味は4.3節及び表[REF_tbl:features]を参照されたい．
precは精度．
recは再現率．
fはF値を表す．
なお，全ての素性の組み合わせc0は，本手法で使用した素性の組み合わせである．
表[REF_tbl:featureAnalysys_cont]から，全ての素性を用いた組み合わせc0を用いた場合のF値が2人対話，3人対話共に一番高いことがわかる．
また，ほぼ素性crr_o，pre_o，nbn_oの順に関係同定に寄与していることがわかる．
表[REF_tbl:cont-featureByType-2]からは，各素性がどの種類の関係同定に寄与しているかを見ることができる．
なお，3人対話の結果は，2人対話と傾向が似ていたため割愛する．
crr_oは，特殊表記型，倒置型および挿入節型で特に効果がある．
2.1節の事例からもわかるように，対象発言の先頭と末尾の形態素情報といった統語的手がかりが関係同定に有用であったと考えられる．
pre_oは助詞類型，接続詞類型で特に効果がある．
2.1節の事例からもわかるように，先行発言の末尾の形態素情報といった統語的手がかりが関係同定に有用であったと考えられる．
しかし一方で，倒置型の同定には悪影響を及ぼしている．
例(15)，(16)のように，先行発言の末尾の形態素情報が同じ発言でも継続関係を持つ場合と持たない場合が本コーパス中には多い．
このため，訓練事例中に正例と負例が混在し，関係同定に教師あり学習器を利用した本手法ではうまく扱えず，再現率を下げたと考えられる．
\eenumsentence{
Aさん：出来る面子じゃありませんよ
Aさん：バルセロナは[関係先：(a)，関係名：継続（倒置型）] }
\eenumsentence{
Aさん：そうは思いません
Aさん：ベッカムは
Aさん：移籍しますよ[関係先：(b)，関係名：継続（助詞型）] }
nbn_oは倒置型の同定に効果がある．
例(17)のようにNBNu_sの先頭の形態素がムーブの先頭を表す接続詞類と考えられるものであった場合，対象発言と先行発言が継続関係にあるという判断に効果があったと考えられる．
\eenumsentence{
Aさん：ポジションチェンジなんですよね
Aさん：向こうのオーバーラップは[関係先：(a)，関係名：継続（倒置型）]
Aさん：ところで、}
次に，応答関係の場合について述べる．
表[REF_tbl:featureAnalysys_res]は，解析器作成で使用した素性の組み合わせ毎の応答関係の同定精度，再現率，F値を表している．
表中の略表記の意味は4.3節及び表[REF_tbl:features]を参照されたい．
なお，全ての素性の組み合わせr0は，本手法で使用した素性の組み合わせである．
[tbt]
表[REF_tbl:featureAnalysys_res]から，全ての素性を用いた組み合わせr0を用いた場合のF値が3人対話で一番高いが，2人対話では，r6およびr7の素性の組み合わせを用いたF値がr0よりも若干高く，一番高い．
また，素性crr_aおよび素性lwが他の素性に比べて大きく関係同定に寄与していることがわかる．
表[REF_tbl:res-featureByType-2]からは，各素性がどの種類の応答関係同定に寄与しているかを見ることができる．
なお，3人対話の結果は，2人対話と傾向が似ていたため割愛する．
crr_aは，確認アクトおよび情報伝達アクトを含むムーブとの関係同定で特に効果がある．
これは，対象ムーブのアクトを推定することで表[REF_tbl:crp]で示した制約が利用できたためと考えられる．
lwは真偽情報要求アクトおよび未知情報要求アクトを含むムーブとの関係同定で特に効果がある．
これらのアクトを含むムーブの多くは末尾にクエスチョンマークを持つため，末尾の表層表現がクエスチョンマークであるか否かという情報が関係同定に有用であったと考えられる．
