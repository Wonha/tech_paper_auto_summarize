統計的日本語係り受け解析では，二文節間の係りやすさは確率値で表される．
この確率値は係り受け確率モデルから計算される．
この節ではこれまでに依存文法に基づく係り受け解析によく用いられているモデル[CITE]について説明する．
入力文[MATH]が与えられると，[MATH]は[MATH]個の文節[MATH]に一意に分割されると仮定し，[MATH]をそれらの順序付き集合[MATH]で表す．
そして，文全体の係り受け関係[MATH]はそれぞれの文節[MATH]を係り元の文節とする係り受け関係[MATH]の順序付き集合[MATH]で表されると仮定する．
さらに文節の集合[MATH]が決まると，それぞれ文節[MATH]と文節[MATH]に関して観測される素性[MATH]が一意に決まると仮定し，文節の集合[MATH]を素性の集合[MATH]
で表す．
統計的係り受け解析とは，[MATH]が与えられたときに文全体の係り受けが[MATH]となる確率[MATH]が最も高くなるものを全体の係り受け関係とする処理のことである．
つまり，
となるような[MATH]を求めることに相当する．
日本語の係り受けには，主に以下の特徴があるとされている．
係り受けは前方から後方に向いている．
(後方修飾)
係り受け関係は交差しない．
(非交差条件)
係り要素は受け要素を一つだけ持つ．
以降では，これらの特徴を満たすような[MATH]を求めることを考える．
まず，式([REF_eq:d_best])の[MATH]は以下のように変形できる．
この式で各々の係り受けつまり[MATH]が独立であると仮定すると，[MATH]は以下のようにそれぞれの文節に対する係り受けの確率の積で表せる．
ここで，[MATH]を後で定義するように文節[MATH]と文節[MATH]の間の関係を表すフラグとし，[MATH]を文節[MATH]と文節[MATH]との間の関係の集合として，以下のように表す．
ここでは，上述の(i)の特徴を仮定している．
すると，式([REF_eq:p_db2])から以下の式が導ける．
旧モデルでは，[MATH]として文節[MATH]が文節[MATH]に係るか否かの1，0の二値をとると仮定していた．
文節[MATH]と係り受けの関係にある文節が文節[MATH]の次から数えて[MATH]番目の係り先の候補であるとき，上述の(iii)の特徴，つまり係り要素は受け要素を一つだけ持つということを仮定すると，
となる．
よって，式([REF_eq:p_db3])は以下のように変形できる．
[MATH]のとき必ず[MATH]となるので，
となり，式([REF_eq:p_db4])は次のように表せる．
さらに，[MATH]はそれぞれ独立で，文節[MATH]と文節[MATH]との関係[MATH]は[MATH]のみによって決まり，他の[MATH]とは独立であると仮定する．
すると，式([REF_eq:p_db5])は，以下のように変形できる．
式([REF_eq:p_db6])と式([REF_eq:d_best])とから[MATH]が導かれる．
この節では，我々が提案するモデルについて説明する．
旧モデルでは，二つの文節の関係を「係る」か「係らない」かの二カテゴリとして学習し，それらの二文節が係る確率を計算して係り受け確率としていた．
我々のモデルでは，(A)二つの文節(前文節と後文節)間の関係を，「間」か「係る」か「越える」かの三カテゴリとして学習し，(B)着目している二つの文節の係り受け確率を求める際に，その二文節に対しては「係る」確率，二文節の間の文節に対しては前文節がその文節を越えて後文節に係る確率(「越える」の確率)，後文節より文末側の文節に対しては前文節がその文節との間にある後文節に係る確率(「間」の確率)をそれぞれ計算し，それらをすべて掛け合わせた確率値を用いて係り受け確率を求める．
このモデルでは，[MATH]の仮定が旧モデルにおけるものと異なる．
[MATH]としては，「越える」，「係る」，「間」を表す0，1，2の三値をとると仮定する．
この点がこのモデルの特徴の一つである．
文節[MATH]と係り受けの関係にある文節が[MATH]番目の係り先の候補であるとき，[REF_sec:old_model]節の(iii)の特徴，つまり係り要素は受け要素を一つだけ持つということを仮定すると，
となる．
よって，式([REF_eq:p_db3])は以下のように変形できる．
[MATH]の値が決まるのは，[MATH]を満たすような[MATH]に対し[MATH]になる場合か，[MATH]を満たすような[MATH]に対し，[MATH]になる場合か，[MATH]となる[MATH]が決まる場合かのいずれかである．
これらの条件を満たさないように両端から順に係り受け関係[MATH]を確率式の前件部に移していけば，式([REF_eq:p_db7])の最後の項を除くそれぞれの項の確率値は一意には決まらない．
式([REF_eq:p_db7])の最後の項は[MATH]の値がすべて決まると[MATH]が決まるので確率値は1になる．
式([REF_eq:p_db7])のその他の項については，[MATH]の間の独立性，および[MATH]の間の独立性を仮定すると，式([REF_eq:p_db7])は次のように表せる．
[REF_sec:old_model]節の旧モデルにおける仮定と同様に[MATH]はそれぞれ独立で，[MATH]つまり文節[MATH]と文節[MATH]との関係は，[MATH]のみによって決まると仮定する．
すると，式([REF_eq:p_db8])は，以下のように変形できる．
この式の[MATH]を[MATH]とし，旧モデルの式([REF_eq:p_db6])における[MATH]を[MATH] [MATH]とする．
[MATH]では素性[MATH]が用いられているが，[MATH]では用いられておらず，[MATH]では素性[MATH]以外の素性が用いられているが，[MATH]では用いられていない．
したがって，[MATH]と[MATH]は相補的な関係にあるため，この二つを組み合わせる．
すると以下の式が得られる．
本節のモデルはこの式の平方根をとることによって係り受け確率[MATH]を求めるものである．
この[MATH]と式([REF_eq:d_best])とから[MATH]が導かれる．
実際にこのモデルから係り受け確率がどのように求まるかを図[REF_fig:dependency]を用いて説明する．
図[REF_fig:dependency]はある文節[MATH]の係り先の候補が5個あったときにそれぞれの候補に係るとしたときの係り受け確率を計算している様子を表している．
このとき，文節[MATH]とそれぞれの候補との関係がそれぞれ「越える」，「係る」，「間」となる確率として表[REF_table:example]のような値が得られたと仮定している．
{
}例えば，候補3を係り先だと仮定したとき，候補1，候補2は越えて，文節[MATH]と候補4，候補5の間に係る確率は，式([REF_eq:p_db6])の文節[MATH]に関する項を用いて
つまり，
のように計算され，これが最も高い．
各々の係る確率だけを考えた場合にはそれぞれの[MATH]を比較することになり，候補3と候補4の確率がどちらも0.5のため決まらないが，この方法によると，候補3を優先的に係り先とすることになる．
一文全体の確率はそれぞれの文節について求めた係り受け確率の積で表され，その積の値が最も高くなるようにそれぞれの係り受けを決めることになる．
我々は，式([REF_eq:d_best])において[MATH]を最大にする係り受け関係の集合[MATH]を求めるために，文末から文頭に向けて解析することにより，効率良く組み合わせの数を減らしながら一文全体の係り受けを決定する方法を提案している[CITE]．
この方法では解の探索をビームサーチにより行う．
この方法によると決定的に解析を行ってもビーム幅を広くしたときとほとんど同じ精度が得られることが実験により分かっている．
そこで，[MATH]を求めるためにこの方法を採用する．
このとき，上述のモデルに[REF_sec:old_model]節で述べた(ii)の特徴，つまり非交差条件を仮定すると，文節[MATH]の係り先の候補はすでに解析の終わった文節[MATH]から文節[MATH]までの係り受け関係[MATH]に依存して制限されることになる．
つまり，非交差条件のために文節[MATH]の係り先の候補とはなり得ない文節[MATH]に対しては，係る確率は0になり，「越える」か「間」かについては[MATH]の前後の文節のうち非交差条件を満たす文節と文節[MATH]との関係が決まれば一意に決まり確率は1になる．
文節[MATH]の係り受け確率[MATH]は文節[MATH]のすべての係り先の候補につい確率値を足すと1になるように正規化する．
実際にこのモデルから係り受け確率がどのように求まるかを図[REF_fig:dependency2]を用いて説明する．
図[REF_fig:dependency2]は図[REF_fig:dependency]において非交差条件を考慮した場合の係り受け確率の計算の仕方を表している．
ここで，ある文節[MATH]より後方の文節について，破線の矢印で表されるような係り受け関係が決まったものと仮定している．
このとき，候補3と候補4は非交差条件を満たさないために文節[MATH]の係り先の候補とはなり得ない．
また，文節[MATH]とそれぞれの候補との関係としては，図[REF_fig:dependency]と同様に表[REF_table:example]の値が得られたと仮定している．
例えば，候補5を係り先だと仮定したとき，図[REF_fig:dependency2]の一番下の例のように，候補1，候補2に対しては越える確率，候補5に対しては係る確率を用いてそれぞれ掛け合わせ，その平方根をとることにより係り受け確率が得られる．
一文全体の確率はそれぞれの文節について求めた係り受け確率の積で表され，その積の値が最も高くなるように各々の係り受けを決めることになる．
