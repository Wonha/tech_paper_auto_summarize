#!/usr/bin/perl
use warnings;
use strict;

my $path_log = './logs';
opendir my $dh, $path_log or die "Cannot open $path_log: $!";

my $total =0;
my ($intro_cnt, $related_cnt, $proposed_cnt, $experiment_cnt, $conclusion_cnt);

for my $dir_ent (sort readdir $dh) {
	next if (-d $dir_ent); #or $dir_ent eq '.' or $dir_ent eq '..';
	$total++;
	
	my $path_dir = $path_log."/".$dir_ent;
	my @list = qw/intro related_study proposed_method experiment conclusion/;

	for my $cur (@list) {
		
		my $path_target = $path_dir."/".$cur;
		if (-s $path_target) {
			if ($cur eq 'intro') {
				$intro_cnt++;
			} elsif ($cur eq 'related_study') {
				$related_cnt++;
			} elsif ($cur eq 'proposed_method') {
				$proposed_cnt++;
			} elsif ($cur eq 'experiment') {
				$experiment_cnt++;
			} else {
				$conclusion_cnt++;
			}
		}
		if ((-s $path_target) && ($cur eq 'related_study')) {
#=begin VIEW_CONTENTS
			open my $out_fh, '>:encoding(UTF-8)', './monitors/rel_studies_matched_by_keywort_list' or die "Cannot open ./rel_studies_matched_by_keywort_list$!";
			
			open my $fh, '<', $path_target or die "Cannot open $path_target: $!";
			$path_target =~ s/(.*)\/.*/$1\/related_study/;
			print $out_fh "\n************** [$path_target] **************\n";
			while (<$fh>) {
#				print $out_fh $_;
			}
#=cut
	
			

		}

	}
}
print "\n< classification rate >\n";
printf "%-17s".($intro_cnt/$total*100)."\n", "intro: ";
printf "%-17s".($related_cnt/$total*100)."\n", "related study: ";
printf "%-17s".($proposed_cnt/$total*100)."\n", "proposed method: ";
printf "%-17s".($experiment_cnt/$total*100)."\n", "experiment: ";
printf "%-17s".($conclusion_cnt/$total*100)."\n", "conclusion: ";

closedir $dh;

