#!/usr/bin/perl
use warnings;
use strict;
use diagnostics;

my $path_log = './logs';
opendir my $dh, $path_log or die "Cannot open $path_log: $!"; # open ../logs directory

my $total =0;
my ($intro_cnt, $related_cnt, $proposed_cnt, $experiment_cnt, $conclusion_cnt);
my $empty_file_num = 0;

for my $dir_ent (sort readdir $dh) { # get entry for ../logs 
	next if (-d $dir_ent); #or $dir_ent eq '.' or $dir_ent eq '..';
	$total++;
	
	my $path_dir = $path_log."/".$dir_ent; # add ../logs directory's entry
	my @list = qw/intro related_study proposed_method experiment conclusion/;

	for my $cur (@list) {  
		
		my $path_target = $path_dir."/".$cur; # for each classified file 
		if (-s $path_target) { 
			if ($cur eq 'intro') {
				$intro_cnt++;
			} elsif ($cur eq 'related_study') {
				$related_cnt++;
			} elsif ($cur eq 'proposed_method') {
				$proposed_cnt++;
			} elsif ($cur eq 'experiment') {
				$experiment_cnt++;
			} else {
				$conclusion_cnt++;
			}
		}


# check second expression's file name for check if that file is empty.
		if (!(-s $path_target) && ($cur eq 'related_study')) {
#			print "\n************************ [$path_target] is empty ************************\n";
			print "[$path_target] is empty\n";
			$empty_file_num++;

			$path_target =~ s/(.*)\/.*/$1\/log_classify_section/;
			open my $fh, '<', $path_target or die "Cannot open $path_target: $!";
			while (<$fh>) {
#				print;
			}
		}

	}
}
print "num of zero sized related study file: $empty_file_num\n";
print "\n< classification rate >\n";
printf "%-17s".($intro_cnt/$total*100)."\n", "intro: ";
printf "%-17s".($related_cnt/$total*100)."\n", "related study: ";
printf "%-17s".($proposed_cnt/$total*100)."\n", "proposed method: ";
printf "%-17s".($experiment_cnt/$total*100)."\n", "experiment: ";
printf "%-17s".($conclusion_cnt/$total*100)."\n", "conclusion: ";

closedir $dh;

