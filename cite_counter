#!/usr/bin/perl -w
use strict;


for my $num1 (1..22) {
	$num1 = "0".$num1 if $num1 < 10;
	for my $num2 (1..9) {
		$num2 = "0".$num2 if $num2 < 10;
		for my $num3 (1..9) {
			$num3 = "0".$num3 if $num3 < 10;
			my $cur_file = './train_data/V'.$num1.'N'.$num2.'-'.$num3.'.tex';
			
			if (-e $cur_file) {
				open my $fh, '<', $cur_file || die "Cannot open $cur_file: $!";
				my $content = join '', <$fh>;
			
				my (@sec_titles, @sec_contents);
				while ( $content =~ s/
						\\section\{([^\n]+?)\}
						(.*?)
						((?:\\section\{(?:[^\n])\})|(?:\\end\{document\})|(?:\\appendix))
						/$3/sumx ) {
					push @sec_titles, $1;
					push @sec_contents, $2;
				}
				
				print "@sec_titles\n";
				for my $idx (0..$#sec_contents) {
					my $cite_count = ($sec_contents[$idx] =~ s/(\\cite)/$1/g);
#				print "$cite_count\n";	
					if ($cite_count > 7) {
						print "[$cur_file] $sec_titles[$idx] is relative study section.\n";
					}
				}
			}
		}
	}
}
