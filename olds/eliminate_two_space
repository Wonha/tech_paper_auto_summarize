#!/usr/bin/perl
use strict;
use utf8;

use open IO=> ':encoding(utf8)';
binmode STDIN, ':encoding(utf8)';
binmode STDOUT, ':encoding(utf8)';
binmode STDERR, ':encoding(utf8)';

use lib qw(lib);
use MeCab;
use Encode qw(decode);

use Latex2Text ':all';
use CabCommon ':all';

my @latex_files = <@ARGV>;

for my $path_latex (@latex_files) {
	my $log_dir = get_log_dir($path_latex);
	my $target_path = File::Spec->catfile($log_dir, "intro_train");

### eliminate the double space
	my $content = '';
	open my $fh_in, '<', $target_path or die "can't open $target_path: $!";
	while (<$fh_in>) {
		s/(?: )+/ /ug;
		s/\t(?: )+/\t/ug;
		$content .= $_;	
	}
	close $fh_in;

### dump
	unlink $target_path;
	open my $fh_out, '>', $target_path or die "can't open $target_path: $!";
	print $fh_out $content;
	close $fh_out;
}
